<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>RunDeck User Manual | Version 1.2.1</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Alex Honor" />
  <meta name="author" content="Greg Schueler" />
  <meta name="date" content="November 20, 2010" />
  <link rel="stylesheet" href="RunDeck-Guide.css" type="text/css" />
</head>
<body>
<div id="docbody">
<h1 class="title">RunDeck User Manual | Version 1.2.1</h1>
<div id="TOC"
><ul
  ><li
    ><a href="#introduction"
      ><span class="toc-section-number"
	>1</span
	> Introduction</a
      ><ul
      ><li
	><a href="#what-is-this-guide-about"
	  ><span class="toc-section-number"
	    >1.1</span
	    > What is this guide about?</a
	  ></li
	><li
	><a href="#what-is-rundeck"
	  ><span class="toc-section-number"
	    >1.2</span
	    > What is RunDeck?</a
	  ><ul
	  ><li
	    ><a href="#who-makes-the-rundeck-software"
	      ><span class="toc-section-number"
		>1.2.1</span
		> Who makes the RunDeck software?</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#getting-help"
	  ><span class="toc-section-number"
	    >1.3</span
	    > Getting help</a
	  ></li
	><li
	><a href="#rundeck-from-30000-feet"
	  ><span class="toc-section-number"
	    >1.4</span
	    > RunDeck from 30,000 feet</a
	  ><ul
	  ><li
	    ><a href="#rundeck-features"
	      ><span class="toc-section-number"
		>1.4.1</span
		> RunDeck features</a
	      ></li
	    ><li
	    ><a href="#rundeck-in-context"
	      ><span class="toc-section-number"
		>1.4.2</span
		> RunDeck in context</a
	      ></li
	    ><li
	    ><a href="#rundeck-architecture"
	      ><span class="toc-section-number"
		>1.4.3</span
		> RunDeck architecture</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#feedback"
	  ><span class="toc-section-number"
	    >1.5</span
	    > Feedback</a
	  ></li
	><li
	><a href="#whats-next"
	  ><span class="toc-section-number"
	    >1.6</span
	    > What's next?</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#getting-started"
      ><span class="toc-section-number"
	>2</span
	> Getting Started</a
      ><ul
      ><li
	><a href="#rundeck-basics"
	  ><span class="toc-section-number"
	    >2.1</span
	    > RunDeck Basics</a
	  ><ul
	  ><li
	    ><a href="#command-dispatching"
	      ><span class="toc-section-number"
		>2.1.1</span
		> Command dispatching</a
	      ></li
	    ><li
	    ><a href="#resource-model"
	      ><span class="toc-section-number"
		>2.1.2</span
		> Resource model</a
	      ></li
	    ><li
	    ><a href="#authorization"
	      ><span class="toc-section-number"
		>2.1.3</span
		> Authorization</a
	      ></li
	    ><li
	    ><a href="#project"
	      ><span class="toc-section-number"
		>2.1.4</span
		> Project</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#installing-rundeck"
	  ><span class="toc-section-number"
	    >2.2</span
	    > Installing RunDeck</a
	  ><ul
	  ><li
	    ><a href="#system-requirements"
	      ><span class="toc-section-number"
		>2.2.1</span
		> System Requirements</a
	      ><ul
	      ><li
		><a href="#java"
		  ><span class="toc-section-number"
		    >2.2.1.1</span
		    > Java</a
		  ></li
		><li
		><a href="#network-access"
		  ><span class="toc-section-number"
		    >2.2.1.2</span
		    > Network access</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#installing-from-source"
	      ><span class="toc-section-number"
		>2.2.2</span
		> Installing from Source</a
	      ></li
	    ><li
	    ><a href="#installing-with-rpm"
	      ><span class="toc-section-number"
		>2.2.3</span
		> Installing with RPM</a
	      ></li
	    ><li
	    ><a href="#installing-with-launcher"
	      ><span class="toc-section-number"
		>2.2.4</span
		> Installing with Launcher</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#first-time-setup"
	  ><span class="toc-section-number"
	    >2.3</span
	    > First-Time Setup</a
	  ><ul
	  ><li
	    ><a href="#logins"
	      ><span class="toc-section-number"
		>2.3.1</span
		> Logins</a
	      ></li
	    ><li
	    ><a href="#group-membership"
	      ><span class="toc-section-number"
		>2.3.2</span
		> Group membership</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#summary"
	  ><span class="toc-section-number"
	    >2.4</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#rundeck-basics-1"
      ><span class="toc-section-number"
	>3</span
	> RunDeck Basics</a
      ><ul
      ><li
	><a href="#rundeck-interfaces"
	  ><span class="toc-section-number"
	    >3.1</span
	    > RunDeck Interfaces</a
	  ><ul
	  ><li
	    ><a href="#graphical-console"
	      ><span class="toc-section-number"
		>3.1.1</span
		> Graphical Console</a
	      ><ul
	      ><li
		><a href="#navigation"
		  ><span class="toc-section-number"
		    >3.1.1.1</span
		    > Navigation</a
		  ></li
		><li
		><a href="#now-running"
		  ><span class="toc-section-number"
		    >3.1.1.2</span
		    > Now running</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#shell-tools"
	      ><span class="toc-section-number"
		>3.1.2</span
		> Shell Tools</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#project-setup"
	  ><span class="toc-section-number"
	    >3.2</span
	    > Project Setup</a
	  ><ul
	  ><li
	    ><a href="#resource-model-1"
	      ><span class="toc-section-number"
		>3.2.1</span
		> Resource model</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#command-execution"
	  ><span class="toc-section-number"
	    >3.3</span
	    > Command Execution</a
	  ><ul
	  ><li
	    ><a href="#dispatcher-options"
	      ><span class="toc-section-number"
		>3.3.1</span
		> Dispatcher options</a
	      ><ul
	      ><li
		><a href="#filtering-nodes-graphically"
		  ><span class="toc-section-number"
		    >3.3.1.1</span
		    > Filtering nodes graphically</a
		  ></li
		><li
		><a href="#filtering-nodes-in-the-shell"
		  ><span class="toc-section-number"
		    >3.3.1.2</span
		    > Filtering nodes in the shell</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#ad-hoc-commands"
	      ><span class="toc-section-number"
		>3.3.2</span
		> Ad-hoc commands</a
	      ><ul
	      ><li
		><a href="#shell-tool-command-execution"
		  ><span class="toc-section-number"
		    >3.3.2.1</span
		    > Shell tool command execution</a
		  ></li
		><li
		><a href="#graphical-command-shell-execution"
		  ><span class="toc-section-number"
		    >3.3.2.2</span
		    > Graphical command shell execution</a
		  ><ul
		  ><li
		    ><a href="#following-execution-output"
		      ><span class="toc-section-number"
			>3.3.2.2.1</span
			> Following execution output</a
		      ><ul
		      ><li
			><a href="#separate-exeuction-follow-page"
			  ><span class="toc-section-number"
			    >3.3.2.2.1.1</span
			    > Separate exeuction follow page</a
			  ></li
			></ul
		      ></li
		    ></ul
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#controlling-command-execution"
	      ><span class="toc-section-number"
		>3.3.3</span
		> Controlling command execution</a
	      ></li
	    ><li
	    ><a href="#queuing-commands-to-rundeck"
	      ><span class="toc-section-number"
		>3.3.4</span
		> Queuing commands to RunDeck</a
	      ></li
	    ><li
	    ><a href="#tracking-execution"
	      ><span class="toc-section-number"
		>3.3.5</span
		> Tracking execution</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#history"
	  ><span class="toc-section-number"
	    >3.4</span
	    > History</a
	  ><ul
	  ><li
	    ><a href="#filtering-event-history"
	      ><span class="toc-section-number"
		>3.4.1</span
		> Filtering event history</a
	      ></li
	    ><li
	    ><a href="#event-view"
	      ><span class="toc-section-number"
		>3.4.2</span
		> Event view</a
	      ></li
	    ><li
	    ><a href="#rss-link"
	      ><span class="toc-section-number"
		>3.4.3</span
		> RSS link</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#tips-and-tricks"
	  ><span class="toc-section-number"
	    >3.5</span
	    > Tips and Tricks</a
	  ><ul
	  ><li
	    ><a href="#saving-filters"
	      ><span class="toc-section-number"
		>3.5.1</span
		> Saving filters</a
	      ></li
	    ><li
	    ><a href="#auto-completion"
	      ><span class="toc-section-number"
		>3.5.2</span
		> Auto-Completion</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#summary-1"
	  ><span class="toc-section-number"
	    >3.6</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#jobs"
      ><span class="toc-section-number"
	>4</span
	> Jobs</a
      ><ul
      ><li
	><a href="#job-groups"
	  ><span class="toc-section-number"
	    >4.1</span
	    > Job groups</a
	  ></li
	><li
	><a href="#listing-and-filtering-jobs"
	  ><span class="toc-section-number"
	    >4.2</span
	    > Listing and filtering Jobs</a
	  ><ul
	  ><li
	    ><a href="#filtering-jobs"
	      ><span class="toc-section-number"
		>4.2.1</span
		> Filtering Jobs</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#viewing-job-detail"
	  ><span class="toc-section-number"
	    >4.3</span
	    > Viewing Job detail</a
	  ></li
	><li
	><a href="#running-a-job"
	  ><span class="toc-section-number"
	    >4.4</span
	    > Running a Job</a
	  ><ul
	  ><li
	    ><a href="#choose-execution-options"
	      ><span class="toc-section-number"
		>4.4.1</span
		> Choose execution options</a
	      ></li
	    ><li
	    ><a href="#following-running-jobs"
	      ><span class="toc-section-number"
		>4.4.2</span
		> Following Running Jobs</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#creating-jobs"
	  ><span class="toc-section-number"
	    >4.5</span
	    > Creating Jobs</a
	  ><ul
	  ><li
	    ><a href="#temporary-jobs"
	      ><span class="toc-section-number"
		>4.5.1</span
		> Temporary Jobs</a
	      ></li
	    ><li
	    ><a href="#saved-jobs"
	      ><span class="toc-section-number"
		>4.5.2</span
		> Saved Jobs</a
	      ></li
	    ><li
	    ><a href="#simple-saved-job"
	      ><span class="toc-section-number"
		>4.5.3</span
		> Simple saved job</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#scheduled-jobs"
	  ><span class="toc-section-number"
	    >4.6</span
	    > Scheduled Jobs</a
	  ></li
	><li
	><a href="#job-history"
	  ><span class="toc-section-number"
	    >4.7</span
	    > Job history</a
	  ></li
	><li
	><a href="#killing-jobs"
	  ><span class="toc-section-number"
	    >4.8</span
	    > Killing Jobs</a
	  ></li
	><li
	><a href="#deleting-jobs"
	  ><span class="toc-section-number"
	    >4.9</span
	    > Deleting Jobs</a
	  ></li
	><li
	><a href="#updating-and-copying-jobs"
	  ><span class="toc-section-number"
	    >4.10</span
	    > Updating and copying Jobs</a
	  ></li
	><li
	><a href="#exporting-job-definitions"
	  ><span class="toc-section-number"
	    >4.11</span
	    > Exporting Job definitions</a
	  ></li
	><li
	><a href="#importing-jobs-definitions"
	  ><span class="toc-section-number"
	    >4.12</span
	    > Importing Jobs definitions</a
	  ></li
	><li
	><a href="#summary-2"
	  ><span class="toc-section-number"
	    >4.13</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#job-workflows"
      ><span class="toc-section-number"
	>5</span
	> Job Workflows</a
      ><ul
      ><li
	><a href="#workflow-definition"
	  ><span class="toc-section-number"
	    >5.1</span
	    > Workflow definition</a
	  ></li
	><li
	><a href="#workflow-control-settings"
	  ><span class="toc-section-number"
	    >5.2</span
	    > Workflow control settings</a
	  ></li
	><li
	><a href="#workflow-steps"
	  ><span class="toc-section-number"
	    >5.3</span
	    > Workflow steps</a
	  ><ul
	  ><li
	    ><a href="#command-step"
	      ><span class="toc-section-number"
		>5.3.1</span
		> Command step</a
	      ></li
	    ><li
	    ><a href="#script-step"
	      ><span class="toc-section-number"
		>5.3.2</span
		> Script step</a
	      ></li
	    ><li
	    ><a href="#script-file-step"
	      ><span class="toc-section-number"
		>5.3.3</span
		> Script file step</a
	      ></li
	    ><li
	    ><a href="#job-reference-step"
	      ><span class="toc-section-number"
		>5.3.4</span
		> Job reference step</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#reordering-steps"
	  ><span class="toc-section-number"
	    >5.4</span
	    > Reordering steps</a
	  ></li
	><li
	><a href="#save-the-changes"
	  ><span class="toc-section-number"
	    >5.5</span
	    > Save the changes</a
	  ></li
	><li
	><a href="#summary-3"
	  ><span class="toc-section-number"
	    >5.6</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#job-options"
      ><span class="toc-section-number"
	>6</span
	> Job Options</a
      ><ul
      ><li
	><a href="#prompting-the-user"
	  ><span class="toc-section-number"
	    >6.1</span
	    > Prompting the user</a
	  ></li
	><li
	><a href="#options-editor"
	  ><span class="toc-section-number"
	    >6.2</span
	    > Options editor</a
	  ></li
	><li
	><a href="#defining-an-option"
	  ><span class="toc-section-number"
	    >6.3</span
	    > Defining an option</a
	  ></li
	><li
	><a href="#remote-option-values"
	  ><span class="toc-section-number"
	    >6.4</span
	    > Remote option values</a
	  ></li
	><li
	><a href="#script-usage"
	  ><span class="toc-section-number"
	    >6.5</span
	    > Script usage</a
	  ></li
	><li
	><a href="#calling-a-job-with-options"
	  ><span class="toc-section-number"
	    >6.6</span
	    > Calling a Job with options</a
	  ></li
	><li
	><a href="#summary-4"
	  ><span class="toc-section-number"
	    >6.7</span
	    > Summary</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#rundeck-by-example"
      ><span class="toc-section-number"
	>7</span
	> RunDeck by example</a
      ><ul
      ><li
	><a href="#acme-anvils"
	  ><span class="toc-section-number"
	    >7.1</span
	    > Acme Anvils</a
	  ></li
	><li
	><a href="#rundeck-set-up"
	  ><span class="toc-section-number"
	    >7.2</span
	    > RunDeck set up</a
	  ></li
	><li
	><a href="#tag-classification-and-command-dispatching"
	  ><span class="toc-section-number"
	    >7.3</span
	    > Tag classification and command dispatching</a
	  ></li
	><li
	><a href="#jobs-1"
	  ><span class="toc-section-number"
	    >7.4</span
	    > Jobs</a
	  ><ul
	  ><li
	    ><a href="#job-structure"
	      ><span class="toc-section-number"
		>7.4.1</span
		> Job structure</a
	      ></li
	    ><li
	    ><a href="#job-grouping"
	      ><span class="toc-section-number"
		>7.4.2</span
		> Job grouping</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#job-option"
	  ><span class="toc-section-number"
	    >7.5</span
	    > Job option</a
	  ><ul
	  ><li
	    ><a href="#allowed-values"
	      ><span class="toc-section-number"
		>7.5.1</span
		> Allowed values</a
	      ></li
	    ><li
	    ><a href="#script-access-to-option-data"
	      ><span class="toc-section-number"
		>7.5.2</span
		> Script access to option data</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#job-workflow-composition"
	  ><span class="toc-section-number"
	    >7.6</span
	    > Job workflow composition</a
	  ></li
	><li
	><a href="#running-the-job"
	  ><span class="toc-section-number"
	    >7.7</span
	    > Running the job</a
	  ></li
	><li
	><a href="#job-access-control"
	  ><span class="toc-section-number"
	    >7.8</span
	    > Job access control</a
	  ></li
	><li
	><a href="#resource-model-provider-examples"
	  ><span class="toc-section-number"
	    >7.9</span
	    > Resource model provider examples</a
	  ></li
	><li
	><a href="#resource-editor-examples"
	  ><span class="toc-section-number"
	    >7.10</span
	    > Resource editor examples</a
	  ></li
	><li
	><a href="#option-model-provider-examples"
	  ><span class="toc-section-number"
	    >7.11</span
	    > Option model provider examples</a
	  ></li
	></ul
      ></li
    ><li
    ><a href="#administration"
      ><span class="toc-section-number"
	>8</span
	> Administration</a
      ><ul
      ><li
	><a href="#startup-and-shutdown"
	  ><span class="toc-section-number"
	    >8.1</span
	    > Startup and shutdown</a
	  ><ul
	  ><li
	    ><a href="#rpm"
	      ><span class="toc-section-number"
		>8.1.1</span
		> RPM</a
	      ><ul
	      ><li
		><a href="#setting-java_home"
		  ><span class="toc-section-number"
		    >8.1.1.1</span
		    > Setting JAVA_HOME</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#launcher"
	      ><span class="toc-section-number"
		>8.1.2</span
		> Launcher</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#configuration"
	  ><span class="toc-section-number"
	    >8.2</span
	    > Configuration</a
	  ><ul
	  ><li
	    ><a href="#configuration-layout"
	      ><span class="toc-section-number"
		>8.2.1</span
		> Configuration layout</a
	      ><ul
	      ><li
		><a href="#rpm-layout"
		  ><span class="toc-section-number"
		    >8.2.1.1</span
		    > RPM layout</a
		  ></li
		><li
		><a href="#launcher-layout"
		  ><span class="toc-section-number"
		    >8.2.1.2</span
		    > Launcher layout</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#configuration-files"
	      ><span class="toc-section-number"
		>8.2.2</span
		> Configuration files</a
	      ><ul
	      ><li
		><a href="#admin.aclpolicy"
		  ><span class="toc-section-number"
		    >8.2.2.1</span
		    > admin.aclpolicy</a
		  ></li
		><li
		><a href="#framework.properties"
		  ><span class="toc-section-number"
		    >8.2.2.2</span
		    > framework.properties</a
		  ></li
		><li
		><a href="#log4j.properties"
		  ><span class="toc-section-number"
		    >8.2.2.3</span
		    > log4j.properties</a
		  ></li
		><li
		><a href="#profile"
		  ><span class="toc-section-number"
		    >8.2.2.4</span
		    > profile</a
		  ></li
		><li
		><a href="#project.properties"
		  ><span class="toc-section-number"
		    >8.2.2.5</span
		    > project.properties</a
		  ></li
		><li
		><a href="#jaas-loginmodule.conf"
		  ><span class="toc-section-number"
		    >8.2.2.6</span
		    > jaas-loginmodule.conf</a
		  ></li
		><li
		><a href="#realm.properties"
		  ><span class="toc-section-number"
		    >8.2.2.7</span
		    > realm.properties</a
		  ></li
		><li
		><a href="#rundeck-config.properties"
		  ><span class="toc-section-number"
		    >8.2.2.8</span
		    > rundeck-config.properties</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#logs"
	  ><span class="toc-section-number"
	    >8.3</span
	    > Logs</a
	  ></li
	><li
	><a href="#backup-and-recovery"
	  ><span class="toc-section-number"
	    >8.4</span
	    > Backup and recovery</a
	  ></li
	><li
	><a href="#ssh"
	  ><span class="toc-section-number"
	    >8.5</span
	    > SSH</a
	  ><ul
	  ><li
	    ><a href="#ssh-configuration-requirements"
	      ><span class="toc-section-number"
		>8.5.1</span
		> SSH configuration requirements</a
	      ></li
	    ><li
	    ><a href="#ssh-key-generation"
	      ><span class="toc-section-number"
		>8.5.2</span
		> SSH key generation</a
	      ></li
	    ><li
	    ><a href="#configuring-remote-machine-for-ssh"
	      ><span class="toc-section-number"
		>8.5.3</span
		> Configuring remote machine for SSH</a
	      ><ul
	      ><li
		><a href="#passing-environment-variables-through-remote-command"
		  ><span class="toc-section-number"
		    >8.5.3.1</span
		    > Passing environment variables through remote command</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#managing-logins"
	  ><span class="toc-section-number"
	    >8.6</span
	    > Managing logins</a
	  ><ul
	  ><li
	    ><a href="#realm.properties-1"
	      ><span class="toc-section-number"
		>8.6.1</span
		> realm.properties</a
	      ></li
	    ><li
	    ><a href="#ldap-and-active-directory"
	      ><span class="toc-section-number"
		>8.6.2</span
		> LDAP and Active Directory</a
	      ><ul
	      ><li
		><a href="#communicating-over-secure-ldap-ldaps:"
		  ><span class="toc-section-number"
		    >8.6.2.1</span
		    > Communicating over secure ldap (ldaps://)</a
		  ></li
		><li
		><a href="#redundant-connection-options"
		  ><span class="toc-section-number"
		    >8.6.2.2</span
		    > Redundant Connection Options</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#authorization-1"
	  ><span class="toc-section-number"
	    >8.7</span
	    > Authorization</a
	  ><ul
	  ><li
	    ><a href="#access-control-policy"
	      ><span class="toc-section-number"
		>8.7.1</span
		> Access control policy</a
	      ></li
	    ><li
	    ><a href="#access-control-policy-actions"
	      ><span class="toc-section-number"
		>8.7.2</span
		> Access control policy actions</a
	      ><ul
	      ><li
		><a href="#access-control-policy-actions-example"
		  ><span class="toc-section-number"
		    >8.7.2.1</span
		    > Access control policy actions example</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#role-mapping"
	      ><span class="toc-section-number"
		>8.7.3</span
		> Role mapping</a
	      ></li
	    ><li
	    ><a href="#troubleshooting-access-control-policy"
	      ><span class="toc-section-number"
		>8.7.4</span
		> Troubleshooting access control policy</a
	      ></li
	    ><li
	    ><a href="#authorization-caveats"
	      ><span class="toc-section-number"
		>8.7.5</span
		> Authorization caveats</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#configuring-rundeck-for-ssl"
	  ><span class="toc-section-number"
	    >8.8</span
	    > Configuring Rundeck for SSL</a
	  ><ul
	  ><li
	    ><a href="#securing-passwords"
	      ><span class="toc-section-number"
		>8.8.1</span
		> Securing passwords</a
	      ></li
	    ><li
	    ><a href="#troubleshooting-keystore"
	      ><span class="toc-section-number"
		>8.8.2</span
		> Troubleshooting keystore</a
	      ></li
	    ><li
	    ><a href="#optional-pem-export"
	      ><span class="toc-section-number"
		>8.8.3</span
		> Optional PEM export</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#customizing-rundeck-gui"
	  ><span class="toc-section-number"
	    >8.9</span
	    > Customizing RunDeck GUI</a
	  ></li
	><li
	><a href="#customizing-configuration-for-scale"
	  ><span class="toc-section-number"
	    >8.10</span
	    > Customizing configuration for scale</a
	  ><ul
	  ><li
	    ><a href="#file-descriptors"
	      ><span class="toc-section-number"
		>8.10.1</span
		> File descriptors</a
	      ></li
	    ><li
	    ><a href="#java-heap-size"
	      ><span class="toc-section-number"
		>8.10.2</span
		> Java heap size</a
	      ></li
	    ><li
	    ><a href="#quartz-job-threadcount"
	      ><span class="toc-section-number"
		>8.10.3</span
		> Quartz job threadCount</a
	      ></li
	    ><li
	    ><a href="#jmx-instrumentation"
	      ><span class="toc-section-number"
		>8.10.4</span
		> JMX instrumentation</a
	      ></li
	    ></ul
	  ></li
	></ul
      ></li
    ><li
    ><a href="#integration-with-external-data-providers"
      ><span class="toc-section-number"
	>9</span
	> Integration with External Data Providers</a
      ><ul
      ><li
	><a href="#resource-model-provider"
	  ><span class="toc-section-number"
	    >9.1</span
	    > Resource Model Provider</a
	  ><ul
	  ><li
	    ><a href="#requirements"
	      ><span class="toc-section-number"
		>9.1.1</span
		> Requirements</a
	      ></li
	    ><li
	    ><a href="#configuration-1"
	      ><span class="toc-section-number"
		>9.1.2</span
		> Configuration</a
	      ></li
	    ><li
	    ><a href="#implementations-and-examples"
	      ><span class="toc-section-number"
		>9.1.3</span
		> Implementations and Examples</a
	      ><ul
	      ><li
		><a href="#simple-vcs-resource-model-provider"
		  ><span class="toc-section-number"
		    >9.1.3.1</span
		    > Simple VCS resource model provider</a
		  ></li
		><li
		><a href="#amazon-ec2-nodes"
		  ><span class="toc-section-number"
		    >9.1.3.2</span
		    > Amazon EC2 Nodes</a
		  ></li
		><li
		><a href="#third-party-resource-model-providers"
		  ><span class="toc-section-number"
		    >9.1.3.3</span
		    > Third party resource model providers</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#option-model-provider"
	  ><span class="toc-section-number"
	    >9.2</span
	    > Option model provider</a
	  ><ul
	  ><li
	    ><a href="#requirements-1"
	      ><span class="toc-section-number"
		>9.2.1</span
		> Requirements</a
	      ></li
	    ><li
	    ><a href="#configuration-2"
	      ><span class="toc-section-number"
		>9.2.2</span
		> Configuration</a
	      ></li
	    ><li
	    ><a href="#json-format"
	      ><span class="toc-section-number"
		>9.2.3</span
		> JSON format</a
	      ></li
	    ><li
	    ><a href="#variable-expansion-in-remote-urls"
	      ><span class="toc-section-number"
		>9.2.4</span
		> Variable expansion in remote URLs</a
	      ></li
	    ><li
	    ><a href="#remote-request-failures"
	      ><span class="toc-section-number"
		>9.2.5</span
		> Remote request failures</a
	      ></li
	    ><li
	    ><a href="#implementations-and-examples-1"
	      ><span class="toc-section-number"
		>9.2.6</span
		> Implementations and Examples</a
	      ><ul
	      ><li
		><a href="#hudson-artifacts-option-provider"
		  ><span class="toc-section-number"
		    >9.2.6.1</span
		    > Hudson artifacts option provider</a
		  ></li
		><li
		><a href="#yum-repoquery-option-model-provider"
		  ><span class="toc-section-number"
		    >9.2.6.2</span
		    > Yum repoquery option model provider</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#resource-editor"
	  ><span class="toc-section-number"
	    >9.3</span
	    > Resource Editor</a
	  ><ul
	  ><li
	    ><a href="#definition"
	      ><span class="toc-section-number"
		>9.3.1</span
		> Definition</a
	      ></li
	    ><li
	    ><a href="#using-properties"
	      ><span class="toc-section-number"
		>9.3.2</span
		> Using properties</a
	      ></li
	    ><li
	    ><a href="#using-remoteurl"
	      ><span class="toc-section-number"
		>9.3.3</span
		> Using remoteUrl</a
	      ><ul
	      ><li
		><a href="#streamlining-the-interface"
		  ><span class="toc-section-number"
		    >9.3.3.1</span
		    > Streamlining the interface</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#examples"
	      ><span class="toc-section-number"
		>9.3.4</span
		> Examples</a
	      ><ul
	      ><li
		><a href="#simple-site-integration"
		  ><span class="toc-section-number"
		    >9.3.4.1</span
		    > Simple site integration</a
		  ></li
		></ul
	      ></li
	    ></ul
	  ></li
	></ul
      ></li
    ><li
    ><a href="#rundeck-api"
      ><span class="toc-section-number"
	>10</span
	> RunDeck API</a
      ><ul
      ><li
	><a href="#urls"
	  ><span class="toc-section-number"
	    >10.1</span
	    > URLs</a
	  ></li
	><li
	><a href="#xml"
	  ><span class="toc-section-number"
	    >10.2</span
	    > XML</a
	  ></li
	><li
	><a href="#authentication"
	  ><span class="toc-section-number"
	    >10.3</span
	    > Authentication</a
	  ></li
	><li
	><a href="#api-version-number"
	  ><span class="toc-section-number"
	    >10.4</span
	    > API Version Number</a
	  ></li
	><li
	><a href="#response-format"
	  ><span class="toc-section-number"
	    >10.5</span
	    > Response Format</a
	  ><ul
	  ><li
	    ><a href="#item-lists"
	      ><span class="toc-section-number"
		>10.5.1</span
		> Item Lists</a
	      ></li
	    ></ul
	  ></li
	><li
	><a href="#api-contents"
	  ><span class="toc-section-number"
	    >10.6</span
	    > API Contents</a
	  ><ul
	  ><li
	    ><a href="#system-info"
	      ><span class="toc-section-number"
		>10.6.1</span
		> System Info</a
	      ></li
	    ><li
	    ><a href="#listing-jobs"
	      ><span class="toc-section-number"
		>10.6.2</span
		> Listing Jobs</a
	      ></li
	    ><li
	    ><a href="#running-a-job-1"
	      ><span class="toc-section-number"
		>10.6.3</span
		> Running a Job</a
	      ></li
	    ><li
	    ><a href="#exporting-jobs"
	      ><span class="toc-section-number"
		>10.6.4</span
		> Exporting Jobs</a
	      ></li
	    ><li
	    ><a href="#importing-jobs"
	      ><span class="toc-section-number"
		>10.6.5</span
		> Importing Jobs</a
	      ></li
	    ><li
	    ><a href="#getting-a-job-definition"
	      ><span class="toc-section-number"
		>10.6.6</span
		> Getting a Job Definition</a
	      ></li
	    ><li
	    ><a href="#deleting-a-job-definition"
	      ><span class="toc-section-number"
		>10.6.7</span
		> Deleting a Job Definition</a
	      ></li
	    ><li
	    ><a href="#getting-executions-for-a-job"
	      ><span class="toc-section-number"
		>10.6.8</span
		> Getting Executions for a Job</a
	      ></li
	    ><li
	    ><a href="#listing-running-executions"
	      ><span class="toc-section-number"
		>10.6.9</span
		> Listing Running Executions</a
	      ></li
	    ><li
	    ><a href="#getting-execution-info"
	      ><span class="toc-section-number"
		>10.6.10</span
		> Getting Execution Info</a
	      ></li
	    ><li
	    ><a href="#aborting-executions"
	      ><span class="toc-section-number"
		>10.6.11</span
		> Aborting Executions</a
	      ></li
	    ><li
	    ><a href="#running-adhoc-commands"
	      ><span class="toc-section-number"
		>10.6.12</span
		> Running Adhoc Commands</a
	      ></li
	    ><li
	    ><a href="#running-adhoc-scripts"
	      ><span class="toc-section-number"
		>10.6.13</span
		> Running Adhoc Scripts</a
	      ></li
	    ><li
	    ><a href="#listing-projects"
	      ><span class="toc-section-number"
		>10.6.14</span
		> Listing Projects</a
	      ></li
	    ><li
	    ><a href="#getting-project-info"
	      ><span class="toc-section-number"
		>10.6.15</span
		> Getting Project Info</a
	      ></li
	    ><li
	    ><a href="#listing-history"
	      ><span class="toc-section-number"
		>10.6.16</span
		> Listing History</a
	      ></li
	    ><li
	    ><a href="#creating-history-event-reports"
	      ><span class="toc-section-number"
		>10.6.17</span
		> Creating History Event Reports</a
	      ></li
	    ><li
	    ><a href="#listing-resources"
	      ><span class="toc-section-number"
		>10.6.18</span
		> Listing Resources</a
	      ><ul
	      ><li
		><a href="#using-node-filters"
		  ><span class="toc-section-number"
		    >10.6.18.1</span
		    > Using Node Filters</a
		  ></li
		></ul
	      ></li
	    ><li
	    ><a href="#getting-resource-info"
	      ><span class="toc-section-number"
		>10.6.19</span
		> Getting Resource Info</a
	      ></li
	    ></ul
	  ></li
	></ul
      ></li
    ></ul
  ></div
>
<div id="introduction"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >1</span
      > Introduction</a
    ></h1
  ><div id="what-is-this-guide-about"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.1</span
	> What is this guide about?</a
      ></h2
    ><p
    >Welcome to the RunDeck user guide. This guide was written to help administrators quickly become productive with the RunDeck server and tools.</p
    ></div
  ><div id="what-is-rundeck"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.2</span
	> What is RunDeck?</a
      ></h2
    ><p
    >RunDeck is open source software that helps you automate ad-hoc and routine procedures in data center or cloud environments. RunDeck provides a number of features that will alleviate time-consuming grunt work and make it easy for you to scale up your scripting efforts.</p
    ><p
    >RunDeck allows you to run tasks on any number of nodes from a web-based or command-line interface. RunDeck also includes other features that make it easy to scale up your scripting efforts including: access control, workflow building, scheduling, logging, and integration with external sources for node and option data.</p
    ><p
    >Already itching to install it? Jump ahead to <a href="#installing-rundeck"
      >Installing RunDeck</a
      >.</p
    ><div id="who-makes-the-rundeck-software"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.2.1</span
	  > Who makes the RunDeck software?</a
	></h3
      ><p
      >RunDeck is developed on GitHub as a project called <a href="https://github.com/dtolabs/rundeck"
	>dtolabs/rundeck</a
	>. Many ideas for RunDeck come from <a href="http://www.dtosolutions.com"
	>DTO Solutions</a
	> consultants working in the field, however all are welcome to join the project and contribute.</p
      ><p
      >RunDeck is free software and is public under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html"
	>Apache Software License</a
	>.</p
      ></div
    ></div
  ><div id="getting-help"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.3</span
	> Getting help</a
      ></h2
    ><ul
    ><li
      >Mailing list: <a href="http://groups.google.com/group/rundeck-discuss"
	>http://groups.google.com/group/rundeck-discuss</a
	><br
	 /></li
      ><li
      >IRC: irc://irc.freenode.net/rundeck</li
      ><li
      >Unix manual pages: RunDeck installation includes a set of Unix manual pages describing the shell tools. <code>man -k rundeck</code></li
      ></ul
    ></div
  ><div id="rundeck-from-30000-feet"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.4</span
	> RunDeck from 30,000 feet</a
      ></h2
    ><div id="rundeck-features"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.4.1</span
	  > RunDeck features</a
	></h3
      ><ul
      ><li
	>distributed command execution via SSH</li
	><li
	>multi-step workflows</li
	><li
	>job definition and on demand or scheduled runs</li
	><li
	>graphical console for command and job execution</li
	><li
	>role-based access control policy with support for LDAP/ActiveDirectory</li
	><li
	>history and auditing logs</li
	><li
	>open integration to external host inventory tools</li
	><li
	>command line interface</li
	></ul
      ></div
    ><div id="rundeck-in-context"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.4.2</span
	  > RunDeck in context</a
	></h3
      ><p
      >RunDeck is meant to compliment the tools you already use (including frameworks like Puppet, Chef, and Rightscale) and is geared towards helping you automate actions across them. If you currently manage your servers by running commands from the terminal or through scripts that SSH commands in a loop, RunDeck is a more user friendly alternative. Instead of managing node lists in a spreadsheet or wiki page and then having to transcribe the list to where you execute commands, RunDeck acts as a command and control portal that lets you execute commands using features like node filtering and parallel execution.</p
      ><p
      >RunDeck also works well for managing virtual servers, be they from a cloud provider or from locally hosted virtualization software. The node abstraction enabled by the RunDeck command dispatcher helps you cope with managing dynamic environments.</p
      ><p
      >Many automation tasks cross the boundaries of tool sets. For example, deploying software or maintaining an application often involves using tools up and down the management tool chain. RunDeck has a simple to use interface to create multi-step workflows that might call a package mangager, configuration mangement tool, system utilities, or your own scripts. RunDeck is really meant to help glue tools together and in return enable a push button interface you can hand off to others.</p
      ></div
    ><div id="rundeck-architecture"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >1.4.3</span
	  > RunDeck architecture</a
	></h3
      ><p
      >RunDeck is a server application you host on a system you designate a central administrative control point. Internally, RunDeck stores job definitions and execution history in a relational database. Output from command and job executions is saved on disk.</p
      ><p
      >RunDeck distributed command execution is performed using SSH. SSH connections are made using key-based authentication. RunDeck server configuration includes settings to define the outbound user allowed by the remote hosts. Remote machines are not required to make SSH connections back to the server.</p
      ><div class="figure"
      ><img src="figures/fig0001.png" alt="RunDeck architecture"
	 /><p class="caption"
	>RunDeck architecture</p
	></div
      ><p
      >The RunDeck application itself is a Java-based webapp that runs in its own embedded servlet container. The application provides both graphical interface and network interfaces used by the RunDeck shell tools.</p
      ><p
      >Access to the RunDeck application requires a login and password. The default RunDeck installation uses a flat file user directory containing a set of default logins. Logins are defined in terms of a username and password as well as one or more user groups. An alternative configuration to the flat file user directory, is LDAP (e.g., ActiveDirectory). Users must also be authorized to perform actions like command and job execution. This is controlled by an access control facility that reads policy files defined by the RunDeck administrator. Privilege is granted if a user's group membership meets the requirements of the policy.</p
      ><p
      >Two installation methods are supported:</p
      ><ul
      ><li
	><p
	  >RPM: The RPM is intended for managed installation and provides robust tools that integrate with your environment, man pages, shell tool set in your path, init.d startup and shutdown</p
	  ></li
	><li
	><p
	  >Launcher: The launcher is intended for quick setup, to get you running right away. Perfect for bootstrapping a project or trying a new feature.</p
	  ></li
	></ul
      ></div
    ></div
  ><div id="feedback"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.5</span
	> Feedback</a
      ></h2
    ><p
    >If you find problems with RunDeck, or if you have questions, remarks, or ideas about it, please send an email to the RunDeck mailing list, <script type="text/javascript"
      >
<!--
h='&#x67;&#114;&#x6f;&#x75;&#112;&#x73;&#46;&#x67;&#x6f;&#x6f;&#x67;&#108;&#x65;&#46;&#x63;&#x6f;&#x6d;';a='&#64;';n='&#114;&#x75;&#110;&#100;&#x65;&#x63;&#x6b;&#x2d;&#100;&#x69;&#x73;&#x63;&#x75;&#x73;&#x73;';e=n+a+h;
document.write('<a h'+'ref'+'="ma'+'ilto'+':'+e+'">'+'<code>'+e+'</code>'+'<\/'+'a'+'>');
// -->
</script
      ><noscript
      >&#114;&#x75;&#110;&#100;&#x65;&#x63;&#x6b;&#x2d;&#100;&#x69;&#x73;&#x63;&#x75;&#x73;&#x73;&#32;&#x61;&#116;&#32;&#x67;&#114;&#x6f;&#x75;&#112;&#x73;&#32;&#100;&#x6f;&#116;&#32;&#x67;&#x6f;&#x6f;&#x67;&#108;&#x65;&#32;&#100;&#x6f;&#116;&#32;&#x63;&#x6f;&#x6d;</noscript
      >.</p
    ></div
  ><div id="whats-next"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>1.6</span
	> What's next?</a
      ></h2
    ><p
    >The remainder of the guide will give you a quick conceptual overview, and take you through installation and setup. After you are set up, you will learn about the distributed command dispatcher and how to use it to run ad-hoc commands. From there, you will learn about Jobs, defining multi-step procedures with Job workflows and how to parameterize them with options.</p
    ></div
  ></div
><div id="getting-started"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >2</span
      > Getting Started</a
    ></h1
  ><p
  >This chapter helps new users getting started with RunDeck. We will begin by explaining the basics, covering essential RunDeck concepts and terminology and then move on to installation and finally, setup. At the end of this chapter you should understand what RunDeck is, how you should use it and you should be all setup to do so.</p
  ><div id="rundeck-basics"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.1</span
	> RunDeck Basics</a
      ></h2
    ><p
    >Several fundamental concepts underly and drive the development of the RunDeck system. If you are a new user, knowing about them will help you use and integrate RunDeck into your environment.</p
    ><div id="command-dispatching"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.1</span
	  > Command dispatching</a
	></h3
      ><p
      >RunDeck supports a notion called <em
	>command dispatching</em
	> wherein a user specifies dispatch critera along with an action (called a command) and this specification is used to perform a distributed execution.</p
      ><p
      >The <em
	>command dispatcher</em
	> is an internal mechanism that looks up node resources meeting specified filtering criteria and then performs the distributed command execution. The command executes in a data context that contains information about the Node resource. Besides node filtering, dispatcher options include parameters to control parallel execution, ordering and error handling.</p
      ><p
      >The command dispatcher supports two methods of command execution:</p
      ><ul
      ><li
	><em
	  >Ad-hoc commands</em
	  >: Execute any shell command or shell script across a set of hosts.<br
	   /></li
	><li
	><em
	  >Jobs</em
	  >: Encapsulate commands as a named Job and tie them together into multi-step workflows.</li
	></ul
      ><p
      >RunDeck provides both graphical and command line interfaces to interact with the command dispatcher.</p
      ></div
    ><div id="resource-model"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.2</span
	  > Resource model</a
	></h3
      ><p
      >The command dispatcher works in conjunction with a resource model. A <em
	>resource model</em
	> is a representation of hosts deployed in your network. A <em
	>Node</em
	> is a resource that is either a physical or virtual instance of a network accessible host.</p
      ><p
      >Nodes have a number of basic properties but these properties can be extended to include arbitrary named key value pairs.</p
      ><p
      >You can configure RunDeck to retrieve and store resource model data from any source, so long as it meets the RunDeck resource model document requirement.</p
      ><p
      >A <em
	>resource model provider</em
	> is an external service accesible via the HTTP GET method that returns data conforming to the RunDeck resource model document format <a href="resource-v10.html"
	>resource-v10(5)</a
	>.</p
      ></div
    ><div id="authorization"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.3</span
	  > Authorization</a
	></h3
      ><p
      >RunDeck enforces an <em
	>access control policy</em
	> that grants certain privileges to groups of users. Every action executed through the RunDeck command dispatcher must meet the requirements of an access control policy definition.</p
      ><p
      >Since RunDeck respects the policy definition, you can define role-based authorization to restrict some users to only a subset of actions. This enables a self-service type interface, where some users have access to only a limited set of executable actions.</p
      ></div
    ><div id="project"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.1.4</span
	  > Project</a
	></h3
      ><p
      >A <em
	>project</em
	> is a place to separate management activity. All RunDeck activities occur within the context of a project. Each project has its own resource model and Job store.</p
      ><p
      >Multiple projects can be maintained on the same RunDeck server. Projects are independent from one another, so you can use them to organize unrelated systems within a single RunDeck installation. This can be useful for managing different infrastructures.</p
      ></div
    ></div
  ><div id="installing-rundeck"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.2</span
	> Installing RunDeck</a
      ></h2
    ><p
    >Assuming the system requirements are met, RunDeck can be installed either from source, system package or via the launcher.</p
    ><div id="system-requirements"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.1</span
	  > System Requirements</a
	></h3
      ><p
      >The following operating systems are known to support RunDeck:</p
      ><ul
      ><li
	>Linux: Most recent distributions are likely to work</li
	><li
	>Windows: XP, Server and above</li
	><li
	>Mac OS X 10.4 or later</li
	></ul
      ><p
      >Root (or Administrator on Windows) is not required or recommended. We recommend using a dedicated user account such as &quot;rundeck&quot;.</p
      ><p
      >If there is need for root access, please set up the RunDeck user to have access via <a href="http://en.wikipedia.org/wiki/Sudo"
	>sudo</a
	>.</p
      ><div id="java"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >2.2.1.1</span
	    > Java</a
	  ></h4
	><p
	>RunDeck is a Java-Servlet based server and therefore requires the Java runtime.</p
	><p
	>The install process requires that the latest version of Java 1.6 be installed. Both the <a href="http://openjdk.java.net/"
	  >Open JDK</a
	  > and <a href="http://java.com/"
	  >Sun/Oracle</a
	  > JVMs can be used. You must have the JAVA_HOME environment variable defined in your environment before running the launcher. The RPM will use the java found on your path. See <a href="#setting-java_home"
	  >Setting JAVA_HOME</a
	  > if you want to run a different version of java.</p
	><p
	>Verify your Java version to check it meets the requirement:</p
	><pre
	><code
	  >$ java -version
java version &quot;1.6.0_22&quot;
Java(TM) SE Runtime Environment (build 1.6.0_22-b04-307-10M3261)
Java HotSpot(TM) 64-Bit Server VM (build 17.1-b03-307, mixed mode)
</code
	  ></pre
	></div
      ><div id="network-access"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >2.2.1.2</span
	    > Network access</a
	  ></h4
	><p
	>When the server starts, it binds to several TCP ports:</p
	><ul
	><li
	  >4440 (http)</li
	  ><li
	  >4443 (https)</li
	  ><li
	  >4435 (log4j)</li
	  ></ul
	><p
	>To check if the ports are free on a Unix host, run:</p
	><pre
	><code
	  >netstat -an | egrep '4440|4435' 
</code
	  ></pre
	><p
	>If the ports are in use on the server, you will see output similar to below:</p
	><pre
	><code
	  >tcp46      0      0  *.4440                 *.*                    LISTEN
tcp46      0      0  *.4435                 *.*                    LISTEN
</code
	  ></pre
	><p
	>The installation procedures describe how to choose different ports, if there is a conflict.</p
	><p
	>In addition, TCP port 22 needs to be open on the clients for SSH.</p
	><p
	>Cients should be set up to allow the RunDeck server user to connect to the clients using SSH via public-key authentication. It should not prompt for a password. See <a href="#configuring-remote-machine-for-ssh"
	  >Configure remote machine for SSH</a
	  > in the Administration chapter.</p
	><p
	>There are various ways for installing SSH on Windows; we recommend <a href="http://www.cygwin.org"
	  >Cygwin</a
	  >.</p
	></div
      ></div
    ><div id="installing-from-source"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.2</span
	  > Installing from Source</a
	></h3
      ><p
      >Checkout the sources from <a href="https://github.com/dtolabs/rundeck"
	>GitHub</a
	></p
      ><p
      >Run the build script:</p
      ><pre
      ><code
	>./build.sh
</code
	></pre
      ><p
      >Build clean</p
      ><pre
      ><code
	>./build.sh -clean
</code
	></pre
      ><p
      >The build will generate a launcher jar. On Linux build servers, an RPM will also be generated.</p
      ></div
    ><div id="installing-with-rpm"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.3</span
	  > Installing with RPM</a
	></h3
      ><p
      >If you want to install RunDeck on Linux via a binary installer, you can generally do so through the RPM tool that comes with your distribution.</p
      ><pre
      ><code
	># rpm -i rundeck-1.1.0.noarch.rpm
</code
	></pre
      ><p
      >To install it using yum, first install the yum repo package and then run yum install:</p
      ><pre
      ><code
	># rpm -Uvh http://rundeck.org/latest.rpm
# yum install rundeck
</code
	></pre
      ></div
    ><div id="installing-with-launcher"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.2.4</span
	  > Installing with Launcher</a
	></h3
      ><p
      >Use the launcher as an alternative to a system package:</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Download the launcher jar file.</li
	><li
	><p
	  >Define RDECK_BASE environment variable to the location of the install</p
	  ><pre
	  ><code
	    >export RDECK_BASE=$HOME/rundeck; # or where you like it
</code
	    ></pre
	  ></li
	><li
	><p
	  >Create the directory for the installation.</p
	  ><pre
	  ><code
	    >mkdir -p $RDECK_BASE 
</code
	    ></pre
	  ></li
	><li
	><p
	  >Copy the launcher jar to the installation directory.</p
	  ><pre
	  ><code
	    >cp rundeck-launcher-1.1.0.jar $RDECK_BASE
</code
	    ></pre
	  ></li
	><li
	><p
	  >Change directory and run the jar.</p
	  ><pre
	  ><code
	    >cd $RDECK_BASE    
java -jar rundeck-launcher-1.1.0.jar
</code
	    ></pre
	  ></li
	><li
	><p
	  >Wait for the Started message.</p
	  ><pre
	  ><code
	    >2010-11-19 13:35:51.127::INFO:  Started SocketConnector@0.0.0.0:4440
</code
	    ></pre
	  ></li
	><li
	><p
	  >Update your shell environment</p
	  ><pre
	  ><code
	    >PATH=$PATH:$RDECK_BASE/tools/bin
MANPATH=$MANPATH:$RDECK_BASE/docs/man
</code
	    ></pre
	  ></li
	></ol
      ><p
      >If you get an error message that resembles the one below, you probably are using an unupported Java version.</p
      ><pre
      ><code
	>Exception in thread &quot;main&quot; java.lang.UnsupportedClassVersionError: Bad version number in .class file
</code
	></pre
      ><p
      >See the <a href="#startup-and-shutdown"
	>startup and shutdown</a
	> section for instructions on using the <code
	>rundeckd</code
	> shell tool to manage the rundeck launcher process.</p
      ></div
    ></div
  ><div id="first-time-setup"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.3</span
	> First-Time Setup</a
      ></h2
    ><div id="logins"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.3.1</span
	  > Logins</a
	></h3
      ><p
      >RunDeck supports a number of user directory configurations. By default, the installation uses a file based directory, but connectivity to LDAP is also available. See <a href="#managing-logins"
	>Managing logins</a
	> in the Administration chapter.</p
      ><p
      >The RunDeck installation process will have defined a set of temporary logins useful during the getting started phase.</p
      ><ul
      ><li
	><code
	  >user</code
	  >: Has access to run commands and jobs but unable to modify job definitions. Password: &quot;user&quot;</li
	><li
	><code
	  >admin</code
	  >: Belongs to the &quot;admin&quot; group and is automatically granted the &quot;admin&quot; and &quot;user&quot; role privileges. Password: &quot;admin&quot;</li
	></ul
      ></div
    ><div id="group-membership"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >2.3.2</span
	  > Group membership</a
	></h3
      ><p
      >If you installed RunDeck using the RPM installation method, it will have created a unix group called &quot;rundeck&quot;.</p
      ><pre
      ><code
	>$ groups rundeck
rundeck : rundeck
</code
	></pre
      ><p
      >It also made several log files writable to members of the &quot;rundeck&quot; group.</p
      ><pre
      ><code
	>$ ls -l /var/log/rundeck/command.log
-rw-rw-r-- 1 rundeck rundeck 588 Dec  2 11:24 /var/log/rundeck/command.log
</code
	></pre
      ><p
      >If you want to use the RunDeck shell tools, be sure to add that group to the necessary user accounts.</p
      ><p
      >RunDeck shell tool users that do not belong to group, rundeck, will get error messages like so:</p
      ><pre
      ><code
	>$ rd-jobs
log4j:ERROR setFile(null,true) call failed. java.io.FileNotFoundException: /var/log/rundeck/command.log (Permission denied)
</code
	></pre
      ><p
      >Consult the <a href="http://linux.die.net/man/8/usermod"
	>usermod</a
	> command to modify a user account.</p
      ></div
    ></div
  ><div id="summary"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>2.4</span
	> Summary</a
      ></h2
    ><p
    >You should now have a basic understanding of RunDeck. You should also have a working version of RunDeck on your system and login access. It is now time to learn some RunDeck basics.</p
    ></div
  ></div
><div id="rundeck-basics-1"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >3</span
      > RunDeck Basics</a
    ></h1
  ><p
  >This chapter covers the basics for using RunDeck. The chapter begins by describing the RunDeck user interfaces, both its graphical and command line. From there it will show you how to set up a project and learn about command execution. You will learn more about using the command dispatcher to control execution and finally, how to find and use history.</p
  ><div id="rundeck-interfaces"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.1</span
	> RunDeck Interfaces</a
      ></h2
    ><p
    >RunDeck provides two primary user interfaces:</p
    ><ul
    ><li
      >An HTML-based graphical console</li
      ><li
      >A suite of shell tools</li
      ></ul
    ><p
    >Both interfaces allow you to view resources, dispatch commands, as well as, store and run jobs.</p
    ><div id="graphical-console"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.1.1</span
	  > Graphical Console</a
	></h3
      ><p
      >To get started, go to the URL for your RunDeck server. Login to the web app with the credentials defined by the RunDeck user directory configuration.</p
      ><div id="navigation"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.1.1.1</span
	    > Navigation</a
	  ></h4
	><p
	>The RunDeck page header contains global navigation control to move between tabbed pages: Run, Jobs and History. It also has links to logout, view your user profile and a link to this online help.</p
	><div class="figure"
	><img src="figures/fig0201.png" alt="Top navigation bar"
	   /><p class="caption"
	  >Top navigation bar</p
	  ></div
	><dl
	><dt
	  >Run</dt
	  ><dd
	  ><p
	    >The Run page is used to execute ad hoc commands. It displays filtered Node resources configured in your Project resource model. A filter control can be used to limit the listing to just the Node resources matching the filter criteria.</p
	    ></dd
	  ><dt
	  >Jobs</dt
	  ><dd
	  ><p
	    >From the Jobs page, one can list, create and run Jobs. A configurable filter allows a user to limit the Job listing to those Jobs matching the filtering criteria. These filter settings can be saved to a Users profile. Only authorized jobs will be visible.</p
	    ></dd
	  ><dt
	  >History</dt
	  ><dd
	  ><p
	    >From the History page, one can view currently executing commands in the &quot;Now Running&quot; area or browse execution history. The execution history can be filtered based on user selected parameters. Once the filter has been set, the matching history is displayed. The current filter settings also configure an RSS link, found in the top right of the page.</p
	    ></dd
	  ><dt
	  >Project menu</dt
	  ><dd
	  ><p
	    >The top navigation bar contains a menu to select the desired project. If only one project exists, the menu will automatically be defaulted.</p
	    ></dd
	  ><dt
	  >Admin</dt
	  ><dd
	  ><p
	    >If your login belongs to the &quot;admin&quot; group and therefore granted &quot;admin&quot; privileges, a wrench icon will be displayed next to your login name. This page allows the admin to view group memberships for all users, as well as, edit their profile data.</p
	    ></dd
	  ><dt
	  >User profile</dt
	  ><dd
	  ><p
	    >Shows a page showing group memberships.</p
	    ></dd
	  ><dt
	  >Logout</dt
	  ><dd
	  ><p
	    >Pressing this link ends the login session and will require a subsequent login.</p
	    ></dd
	  ><dt
	  >Help</dt
	  ><dd
	  ><p
	    >Opens a page to the online help system.</p
	    ></dd
	  ></dl
	></div
      ><div id="now-running"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.1.1.2</span
	    > Now running</a
	  ></h4
	><p
	>The &quot;Now running&quot; section appears at the top of the Run and Jobs pages and provides a view into the execution queue. Any currently executing ad hoc command or Job will be listed and include information like the name of the job, when it started, who ran it, and a link to the execution output.</p
	><div class="figure"
	><img src="figures/fig0215.png" alt="Now running"
	   /><p class="caption"
	  >Now running</p
	  ></div
	><p
	>Jobs that have been run before also have a progress bar approximating duration.</p
	></div
      ></div
    ><div id="shell-tools"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.1.2</span
	  > Shell Tools</a
	></h3
      ><p
      >RunDeck includes a number of shell tools to dispatch commands, load and run Job definitions and interact with the dispatcher queue. These command tools are an alternative to functions accessible in the graphical console.</p
      ><dl
      ><dt
	><a href="dispatch.html"
	  >dispatch</a
	  ></dt
	><dd
	>Execute ad hoc commands and scripts</dd
	><dt
	><a href="rd-queue.html"
	  >rd-queue</a
	  ></dt
	><dd
	>Query the dispatcher for currently running Jobs and possibly kill them<br
	   /></dd
	><dt
	><a href="rd-jobs.html"
	  >rd-jobs</a
	  ></dt
	><dd
	>List defined jobs as well as load them from text file definitions</dd
	><dt
	><a href="run.html"
	  >run</a
	  ></dt
	><dd
	>Invoke the execution of a stored Job</dd
	><dt
	><a href="rd-project.html"
	  >rd-project</a
	  ></dt
	><dd
	>Setup a new RunDeck project</dd
	><dt
	><a href="rd-setup.html"
	  >rd-setup</a
	  ></dt
	><dd
	>(Re-)configure an instance of RunDeck</dd
	></dl
      ><p
      >Consult the online manual pages for options and usage information.</p
      ></div
    ></div
  ><div id="project-setup"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.2</span
	> Project Setup</a
      ></h2
    ><p
    >A RunDeck <em
      >Project</em
      > provides a space to manage related management activities.</p
    ><p
    >A Project can be set up either from the graphical console or using the <code
      >rd-project</code
      > shell tool.</p
    ><p
    >After logging into the graphical console, you will notice a Project menu in the top navigation bar. If no projects exist, you will be prompted to create a new project.</p
    ><div class="figure"
    ><img src="figures/fig0203-a.png" alt="Create project prompt"
       /><p class="caption"
      >Create project prompt</p
      ></div
    ><p
    >After entering your project name, RunDeck initializes it and returns you to the &quot;Run&quot; page.</p
    ><p
    >Projects can be created at any time by going back to the Project menu and selecting the &quot;Create a new project...&quot; item.</p
    ><div class="figure"
    ><img src="figures/fig0203.png" alt="Create project menu"
       /><p class="caption"
      >Create project menu</p
      ></div
    ><p
    >The <code
      >rd-project</code
      > shell tool can also be used to create a project.</p
    ><p
    >On the RunDeck server, execute the <code
      >rd-project</code
      > command and specify a project name, here we use &quot;examples&quot;:</p
    ><pre
    ><code
      >rd-project -a create -p examples
</code
      ></pre
    ><p
    >After running this command, you can login into the graphical console and see the new project in the project menu.</p
    ><p
    >The project setup process generates Project configuration in the server, and a bootstrap resource model.</p
    ><div class="figure"
    ><img src="figures/fig0204.png" alt="Run page after new project"
       /><p class="caption"
      >Run page after new project</p
      ></div
    ><p
    >One node will be listed, the RunDeck server host. The server host is distinguished with the word &quot;server&quot; in red text.</p
    ><div id="resource-model-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.2.1</span
	  > Resource model</a
	></h3
      ><p
      >The initial resource model generated during project setup will contain information just about the RunDeck server host and is useful just for running local commands on the RunDeck server. You can browse the project resource model by going to the &quot;Run&quot; page.</p
      ><p
      >In the shell, you can list the Node resources in a resource model using the shell tool, <code
	>dispatch</code
	>. Specify project name using the <code
	>-p project</code
	> option.</p
      ><p
      >Here the <code
	>dispatch</code
	> command lists the registered server for the &quot;examples&quot; project after the project setup. The <code
	>-v</code
	> gives a verbose listing that includes more detail:</p
      ><pre
      ><code
	>$ dispatch -p examples -v   
 strongbad:
    hostname: strongbad
    osArch: x86_64
    osFamily: unix
    osName: Mac OS X
    osVersion: 10.6.2
    tags: ''
   ---- Attributes ----
</code
	></pre
      ><p
      >Node resources have standard properties, such as &quot;hostname&quot; but these can be extended via attributes. One of the more useful properties is the &quot;tags&quot; property. A <em
	>tag</em
	> is a text label that you give to the Node, perhaps denoting a classification, a role the node plays in the environment, or group membership. Multiple tags can be defined for a given node.</p
      ><p
      >The output above shows the &quot;strongbad&quot; node currently has an empty tags property: <code
	>tags: ''</code
	>.</p
      ><p
      >It is important to start thinking about node tagging for the nodes you manage because you will use them later when specifying filtering options to drive distributed command dispatch.</p
      ><p
      >Each Project has a configuration file called <a href="#project.properties"
	>project.properties</a
	>, located at this path: <code
	>$RDECK_BASE/projects/</code
	><em
	>project</em
	><code
	>/etc/project.properties</code
	>.</p
      ><p
      >This configuration file contains two important properties for accessing and storing resource model data:</p
      ><ul
      ><li
	><code
	  >project.resources.file</code
	  >: File path to store resource model data (required).</li
	><li
	><code
	  >project.resources.url</code
	  >: URL to an external resource model provider (optional)</li
	></ul
      ><p
      >You can configure RunDeck to retrieve and store resource model data from any source, so long as it meets the RunDeck resource model document requirement. Set the <code
	>project.resource.url</code
	> to the resource model provider of your choice.</p
      ><p
      >RunDeck reads the XML document retrieved from the <code
	>${project.resources.url}</code
	> site and stores it in the path defined by <code
	>${project.resources.file}</code
	>.</p
      ><p
      >Here's the XML document stored for the &quot;examples&quot; project that corresponds to the output printed by the <code
	>dispatch -v</code
	> shown earlier:</p
      ><pre
      ><code
	>&lt;project&gt;
    &lt;node name=&quot;strongbad&quot; type=&quot;Node&quot; 
      description=&quot;the RunDeck server host&quot; tags=&quot;&quot; 
      hostname=&quot;strongbad&quot; 
      osArch=&quot;x86_64&quot; osFamily=&quot;unix&quot; osName=&quot;Mac OS X&quot; osVersion=&quot;10.6.2&quot;
      username=&quot;alexh&quot; 
      editUrl=&quot;&quot; remoteUrl=&quot;&quot;/&gt;
&lt;/project&gt;
</code
	></pre
      ><p
      >You'll notice the root node is called <code
	>project</code
	> and there is a single node descriptor for &quot;strongbad&quot;. The <code
	>node</code
	> tag has a number of required and optional attributes. Additional node descriptors can be added by defining new <code
	>node</code
	> elements inside the <code
	>project</code
	> tag.</p
      ><p
      >The strongbad host does not have any tags defined for it. One or more tags can be defined. Use comma for the delimiter (e.g, <code
	>tags=&quot;tag1,tag2&quot;</code
	>).</p
      ><p
      >Here's an example of a node called &quot;homestar&quot; with just the required attributes:</p
      ><pre
      ><code
	>    &lt;node name=&quot;homestar&quot; type=&quot;Node&quot; 
      hostname=&quot;192.168.1.02&quot; 
      username=&quot;alexh&quot; /&gt;
</code
	></pre
      ><p
      >The <code
	>hostname</code
	> and <code
	>username</code
	> values are used for the SSH connection while the <code
	>name</code
	> and <code
	>type</code
	> are used to define Node identity in the resource model. It is possible to overload the hostname value to include port information (eg, hostname=&quot;somehost:2022&quot;). This is useful if your run SSH on a different port.</p
      ><p
      >Chances are you maintain information about your hosts within another tool, perhaps Chef, Puppet, Nagios, Amazon EC2, RightScale or even an in-house database. One of these tools might be considered the authority of knowledge about the nodes deployed in your network. Therefore, it is best to create an interface to the authorative tool and expose it as RunDeck resource model provider. This can be done as a simple CGI script that does a transformation from the tool's format to the one RunDeck understands.</p
      ><p
      >Of course, a rudimentary alternative is to maintain this information as an XML document, storing it in a source repository that is periodically exported to Rundeck. This method could be practical if your host infrastructure infrequently changes.</p
      ><p
      >The <a href="resource-v10.html"
	>resource-v10(5)</a
	> manual contains reference information about the RunDeck resources document content and structure.</p
      ><p
      >Check the RunDeck web site for resource model providers. If you are interested in creating your own, see the <a href="#resource-model-provider"
	>Resource model provider</a
	> section in the <a href="#integration-with-external-data-providers"
	>Integration with External Data Providers</a
	> chapter.</p
      ></div
    ></div
  ><div id="command-execution"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.3</span
	> Command Execution</a
      ></h2
    ><p
    >RunDeck supports two modes of execution: <em
      >ad-hoc commands</em
      > and <em
      >Job</em
      >.</p
    ><p
    >An <em
      >ad-hoc command</em
      > is any system command or shell script executed via the command dispatcher. Ad hoc commands can be executed via a command line utility named <code
      >dispatch</code
      > or run from the graphical console.</p
    ><p
    >A <em
      >Job</em
      > specifies a sequence of one or more command invocations that can be run once (i.e, is temporary) or named and stored for later use. Stored jobs can be started via the shell tool, <code
      >run</code
      >, and their progress checked with <code
      >rd-queue</code
      >.</p
    ><div id="dispatcher-options"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.3.1</span
	  > Dispatcher options</a
	></h3
      ><p
      >Dispatcher execution can be controlled by various types of options.</p
      ><dl
      ><dt
	>Execution control</dt
	><dd
	><p
	  >Command execution can be controlled in various ways. Concurrency is controlled through threadcount. Execution can continue if specified to keepgoing</p
	  ></dd
	><dt
	>Include and exclude patterns</dt
	><dd
	><p
	  >Filtering options specify include and exclude patterns to determine which nodes from the project resource model to distribute commands.</p
	  ></dd
	><dt
	>Keywords</dt
	><dd
	><p
	  >Keywords are used within they include and exclude patterns. The &quot;tags&quot; keywords additionally can use a boolean operator to combine logical ORs and ANDs.</p
	  ></dd
	><dt
	>Option combination</dt
	><dd
	><p
	  >All keywords can be combined by specifying the include and exclude options multiple times on the command line.</p
	  ></dd
	></dl
      ><p
      >One can experiment querying the resource model in the graphical console or with the <code
	>dispatch</code
	> tool.</p
      ><div id="filtering-nodes-graphically"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.3.1.1</span
	    > Filtering nodes graphically</a
	  ></h4
	><p
	>A project's Node resources are displayed in the Run page. Use the project menu in the navigation bar to change to the desired project. After choosing a project, the server node will be filtered by default.</p
	><p
	>Nodes can be filtered using include and exclude patterns by using the Filter form. The form can be opened by pressing the &quot;Filter&quot; button. Press the triangular disclosure icon to display the form.</p
	><div class="figure"
	><img src="figures/fig0205.png" alt="Resource filter link"
	   /><p class="caption"
	  >Resource filter link</p
	  ></div
	><p
	>When the form opens, you will see it divided into an Include section where simple include expressions can be set, as well as, an &quot;Extended Filters...&quot; link where exclude expressions can be made.</p
	><div class="figure"
	><img src="figures/fig0206.png" alt="Resource filter form"
	   /><p class="caption"
	  >Resource filter form</p
	  ></div
	><p
	>After filling out the filter form, press &quot;Filter&quot; to generate a new listing. Pressing &quot;Clear&quot; resets the form.</p
	><p
	>The Include and Exclude filters allow for filtering nodes based on the following keywords: Name, Tags, Hostname, OS Name, OS Family, OS Architecture, OS Version and Type.</p
	><p
	>Regular expressions can be used for any of the keywords. The <code
	  >.*</code
	  > pattern will match any text.</p
	><p
	>If more than 20 nodes match the filter, the UI will page the results.</p
	></div
      ><div id="filtering-nodes-in-the-shell"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.3.1.2</span
	    > Filtering nodes in the shell</a
	  ></h4
	><p
	><code
	  >dispatch</code
	  > uses the commandline options -I (include) and -X (exclude) to specify which nodes to include and exclude from the base set of nodes. You can specify a single value, a list of values, or a regular expression as the argument to these options.</p
	><p
	><em
	  >Examples</em
	  ></p
	><p
	>List nodes with OS name, Linux:</p
	><pre
	><code
	  >dispatch -p examples -I os-name=Linux
</code
	  ></pre
	><p
	>List Linux nodes but exclude ones with names prefixed &quot;web.&quot;:</p
	><pre
	><code
	  >dispatch -p examples -I os-name=Linux -X &quot;web.*&quot;
</code
	  ></pre
	><p
	>List nodes that are tagged both &quot;web&quot; and &quot;prod&quot; :</p
	><pre
	><code
	  >dispatch -p examples -I tags=web+prod
</code
	  ></pre
	><p
	>Here's an example that will execute the <code
	  >apachectl restart</code
	  > command in 10 threads across all nodes tagged &quot;web&quot; and keepgoing in case an error occurs :</p
	><pre
	><code
	  >dispatch -p examples -I tags=web -K -C 10 -- sudo apachectl restart 
</code
	  ></pre
	><p
	>Consult the <a href="rd-options.html"
	  >rd-options(1)</a
	  > manual page for the complete reference on available dispatcher options.</p
	></div
      ></div
    ><div id="ad-hoc-commands"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.3.2</span
	  > Ad-hoc commands</a
	></h3
      ><p
      >Typically, an ad-hoc command is a shell script or system executable that you run at an interactive terminal. Ad-hoc commands can be executed via the <code
	>dispatch</code
	> shell command or a graphical shell.</p
      ><div id="shell-tool-command-execution"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.3.2.1</span
	    > Shell tool command execution</a
	  ></h4
	><p
	>Use <code
	  >dispatch</code
	  > to execute individual commands or shell script files.</p
	><p
	>Here <code
	  >dispatch</code
	  > is used to run the Unix <code
	  >uptime</code
	  > command to print system status:</p
	><pre
	><code
	  >$ dispatch -I os-family=unix -- uptime
Succeeded queueing Workflow execution: Workflow:(threadcount:1){ [command( exec: uptime)] }
Queued job ID: 7 &lt;http://strongbad:4440/execution/follow/7&gt;
</code
	  ></pre
	><p
	>The <code
	  >uptime</code
	  > command is queued and executed. The output can be followed by going to the URL returned in the output (eg, http://strongbad:4440/execution/follow/7).</p
	><p
	>Sometimes it is desirable to execute the command directly, and not queue it <sup
	  ><a href="#fn1" class="footnoteRef" id="fnref1"
	    >1</a
	    ></sup
	  >. Use the <code
	  >--noqueue</code
	  > option to execute and follow the output from the console.</p
	><pre
	><code
	  >$ dispatch -I os-family=unix  --noqueue -- uptime
[ctier@centos54 dispatch][INFO]  10:34:54 up 46 min,  2 users,  load average: 0.00, 0.00, 0.00
[alexh@strongbad dispatch][INFO] 10:34  up 2 days, 18:51, 2 users, load averages: 0.55 0.80 0.75
[examples@ubuntu dispatch][INFO]  10:35:01 up 2 days, 18:40,  2 users,  load average: 0.00, 0.01, 0.00
</code
	  ></pre
	><p
	>Notice, the <code
	  >dispatch</code
	  > command prepends the message output with a header that helps understand from where the output originates. The header format includes the login and node where the <code
	  >dispatch</code
	  > execution occurred.</p
	><p
	>Execute the Unix <code
	  >whomi</code
	  > command to see what user ID is used by that Node to run dispatched commands:</p
	><pre
	><code
	  >$ dispatch -I os-family=unix --noqueue -- whoami
[ctier@centos54 dispatch][INFO] ctier
[alexh@strongbad dispatch][INFO] alexh
[examples@ubuntu dispatch][INFO] examples
</code
	  ></pre
	><p
	>You can see that the resource model defines each Node to use a different login to execute <code
	  >dispatch</code
	  > commands. That feature can be handy when Nodes serve different roles and therefore, use different logins to manage processes. See the <code
	  >username</code
	  > attribute in <a href="resource-v10.html"
	  >resource-v10(5)</a
	  > manual page.</p
	><p
	>The <code
	  >dispatch</code
	  > command can also execute shell scripts. Here's a trivial script that generates a bit of system info:</p
	><pre
	><code
	  >#!/bin/sh
echo &quot;info script&quot;
echo uptime=`uptime`
echo whoami=`whoami`
echo uname=`uname -a`
</code
	  ></pre
	><p
	>Use the -s option to specify the &quot;info.sh&quot; script file:</p
	><pre
	><code
	  >$ dispatch -I os-family=unix -s info.sh
</code
	  ></pre
	><p
	>The <code
	  >dispatch</code
	  > command copies the &quot;info.sh&quot; script located on the server to each &quot;unix&quot; Node and then executes it.</p
	></div
      ><div id="graphical-command-shell-execution"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >3.3.2.2</span
	    > Graphical command shell execution</a
	  ></h4
	><p
	>The RunDeck graphical console also provides the ability to execute ad-hoc commands to a set of filtered Node resources. The command prompt can accept any ad-hoc command string you might run via an SSH command or via the <code
	  >dispatch</code
	  > shell tool.</p
	><p
	>But before running any commands, you need to select the project containing the Nodes you wish to dispatch. Use the project menu to select the desired project name. After the project has been selected you will see a long horizontal textfield labeled &quot;Command&quot;. This is the RunDeck ad hoc command prompt.</p
	><div class="figure"
	><img src="figures/fig0207.png" alt="Ad hoc command prompt"
	   /><p class="caption"
	  >Ad hoc command prompt</p
	  ></div
	><p
	>To use the command prompt, type the desired ad-hoc command string into the textfield and press the &quot;Run&quot; button. The command will be dispatched to all the Node resources currently listed below the command prompt tool bar. The command prompt also becomes disabled until the execution completes. Output from the command execution will be shown below (see <a href="#following-execution-output"
	  >output</a
	  >).</p
	><div class="figure"
	><img src="figures/fig0208.png" alt="Ad hoc execution output"
	   /><p class="caption"
	  >Ad hoc execution output</p
	  ></div
	><p
	>You will also notice the ad hoc execution listed in the &quot;Now running&quot; part of the page, located above the command prompt. All running executions are listed there. Each running execution is listed, showing the start time, the user running it, and a link to follow execution output on a separate page.</p
	><div class="figure"
	><img src="figures/fig0207-b.png" alt="Now running ad hoc command"
	   /><p class="caption"
	  >Now running ad hoc command</p
	  ></div
	><p
	>At the bottom of the page, you will see a &quot;History&quot; section containing all executions in the selected project for the last 24 hours. After the execution completes, a new event will be added to the history. A yellow highlight indicates when the command leaves the Now running section and enters the history table.</p
	><div class="figure"
	><img src="figures/fig0207-c.png" alt="Run history"
	   /><p class="caption"
	  >Run history</p
	  ></div
	><p
	>History is organized in summary form using a table layout. The &quot;Summary&quot; column shows the command or script executed. The &quot;Node Failure Count&quot; contains the number of nodes where an error in execution occurred. If no errors occurred, &quot;ok&quot; will be displayed. The &quot;User&quot; and &quot;Time&quot; columns show the user that executed the command and when.</p
	><div id="following-execution-output"
	><h5
	  ><a href="#TOC"
	    ><span class="header-section-number"
	      >3.3.2.2.1</span
	      > Following execution output</a
	    ></h5
	  ><p
	  >Ad hoc command execution output is displayed below the command prompt.</p
	  ><p
	  >This page section provides several views to read the output using different formats.</p
	  ><dl
	  ><dt
	    >Tail Output</dt
	    ><dd
	    ><p
	      >Displays output messages from the command execution as if you were running the Unix <code
		>tail -f</code
		> command on the output log file. By default, only the last 20 lines of output is displayed but this can be expanded or reduced by pressing the &quot;-&quot; or &quot;+&quot; buttons. You can also type in an exact number into the textfield. <img src="figures/fig0208.png" alt="Ad hoc execution output"
		 /></p
	      ></dd
	    ><dt
	    >Annotated</dt
	    ><dd
	    ><p
	      >The annotated mode displays the output messages in the order they are received but labels the each line with the Node from which the message originated. Through its additional controls each Node context can be expanded to show the output it produced, or completely collapsed to hide the textual detail.<br
		 /><img src="figures/fig0209.png" alt="Annotated output"
		 /></p
	      ></dd
	    ><dt
	    >Compact</dt
	    ><dd
	    ><p
	      >Output messages are sorted into Node specific sections and are not interlaced. By default, the messages are collapsed but can be revealed by pressing the disclosure icon to the right. <img src="figures/fig0210.png" alt="Node output"
		 /></p
	      ></dd
	    ></dl
	  ><div id="separate-exeuction-follow-page"
	  ><h6
	    ><a href="#TOC"
	      ><span class="header-section-number"
		>3.3.2.2.1.1</span
		> Separate exeuction follow page</a
	      ></h6
	    ><p
	    >Sometimes it is useful to have a page where just the execution output is displayed separately. One purpose is to share a link to others interested in following the output messages. Click the &quot;output &gt;&gt;&quot; link in the &quot;Now running&quot; section to go to the execution follow page.</p
	    ><p
	    >Also, notice the URL in the location bar of your browser. This URL can be shared to others interested in the progress of execution. The URL contains the execution ID (EID) and has a form like:</p
	    ><pre
	    ><code
	      > http://rundeckserver/execution/follow/{EID}
</code
	      ></pre
	    ><p
	    >After execution completes, the command will have a status:</p
	    ><ul
	    ><li
	      >Successful: No errors occurred during execution of the command across the filtered Node set</li
	      ><li
	      >Failed: One or more errors occurred. A list of Nodes that incurred an error is displayed. The page will also contain a link &quot;Retry Failed Nodes...&quot; in case you would like to retry the command.</li
	      ></ul
	    ><p
	    >You can download the entire output as a text file from this page. Press the &quot;Download&quot; link to retrieve the file to your desk top.</p
	    ></div
	  ></div
	></div
      ></div
    ><div id="controlling-command-execution"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.3.3</span
	  > Controlling command execution</a
	></h3
      ><p
      >Parallel execution is managed using thread count via &quot;-C&quot; option. The &quot;-C&quot; option specifies the number of execution threads. Here's an example that runs the uptime command across the Linux hosts with two threads:</p
      ><pre
      ><code
	>dispatch -I os-name=Linux -C 2 -- uptime
</code
	></pre
      ><p
      >The keepgoing and retry flags control when to exit incase an error occurs. Use &quot;-K/-R&quot; flags. Here's an example script that checks if the host has port 4440 in the listening state. If it does not, it will exit with code 1.</p
      ><pre
      ><code
	>#!/bin/sh
netstat -an | grep 4440 | grep -q LISTEN
if [ &quot;$?&quot; != 0 ]; then
echo &quot;not listening on 4440&quot;
exit 1;
fi
echo  listening port=4440, host=`hostname`;
</code
	></pre
      ><p
      >Commands or scripts that exit with a non-zero exit code will cause the dispatch to fail unless the keepgoing flag is set.</p
      ><pre
      ><code
	>$ dispatch -I os-family=unix -s /tmp/listening.sh --noqueue
[alexh@strongbad dispatch][INFO] Connecting to centos54:22
[alexh@strongbad dispatch][INFO] done.
[ctier@centos54 dispatch][INFO] not listening on 4440
error: Remote command failed with exit status 1
</code
	></pre
      ><p
      >The script failed on centos54 and caused dispatch to error out immediately.</p
      ><p
      >Running the command again, but this time with the &quot;-K&quot; keepgoing flag will cause dispatch to continue and print on which nodes the script failed:</p
      ><pre
      ><code
	>$ dispatch  --noqueue -K -I tags=web -s /tmp/listening.sh
[alexh@strongbad dispatch][INFO] Connecting to centos54:22
[alexh@strongbad dispatch][INFO] done.
[ctier@centos54 dispatch][INFO] not listening on 4440
[ctier@centos54 dispatch][ERROR] Failed execution for node: centos54: Remote command failed with exit status 1
[alexh@strongbad dispatch][INFO] listening port=4440, host=strongbad
[alexh@strongbad dispatch][INFO] Connecting to 172.16.167.211:22
[alexh@strongbad dispatch][INFO] done.
[examples@ubuntu dispatch][INFO] not listening on 4440
[examples@ubuntu dispatch][ERROR] Failed execution for node: ubuntu: Remote command failed with exit status 1
error: Execution failed on the following 2 nodes: [centos54, ubuntu]
error: Execute this command to retry on the failed nodes:
    dispatch -K -s /tmp/listening.sh -p examples -I
    name=centos54,ubuntu
</code
	></pre
      ></div
    ><div id="queuing-commands-to-rundeck"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.3.4</span
	  > Queuing commands to RunDeck</a
	></h3
      ><p
      >By default, commands or scripts executed on the command line by <code
	>dispatch</code
	> are queued as temporary jobs in RunDeck. The <code
	>dispatch</code
	> command is equivalent to a &quot;Run and Forget&quot; action in the graphical console.</p
      ><p
      >The script below is a long running check that will conduct a check periodically waiting a set time between each pass. The script can be run with or without arguments as the parameters are defaulted inside the script:</p
      ><pre
      ><code
	>$ cat ~/bin/checkagain.sh 
#!/bin/bash
iterations=$1 secs=$2 port=$3
echo &quot;port ${port:=4440} will be checked ${iterations:=30} times waiting ${secs:=5}s between each iteration&quot; 
i=0
while [ $i -lt ${iterations} ]; do
  echo &quot;iteration: #${i}&quot;
  netstat -an | grep $port | grep LISTEN &amp;&amp; exit 0
  echo ----
  sleep ${secs}
  i=$(($i+1))
done
echo &quot;Not listening on $port after $i checks&quot; ; exit 1
</code
	></pre
      ><p
      >Running <code
	>dispatch</code
	> causes the execution to queue in RunDeck and controlled as temporary Job. The <code
	>-I centos54</code
	> limits execution to just the &quot;centos54&quot; node:</p
      ><pre
      ><code
	>$ dispatch -I centos54 -s ~/bin/checkagain.sh 
Succeeded queueing workflow: Workflow:(threadcount:1){ [command( scriptfile: /Users/alexh/bin/checkagain.sh)] }
Queued job ID: 5 &lt;http://strongbad:4440/execution/follow/4&gt;
</code
	></pre
      ><p
      >To pass arguments to the script pass them after the &quot;--&quot; (double dash):</p
      ><pre
      ><code
	>$ iters=5 secs=60 port=4440
$ dispatch -I centos54 -s ~/bin/checkagain.sh -- $iters $secs $ports
</code
	></pre
      ></div
    ><div id="tracking-execution"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.3.5</span
	  > Tracking execution</a
	></h3
      ><p
      >Queued ad-hoc command and temporary or saved Job executions can be tracked from the &quot;Run&quot; page in the &quot;<a href="#now-running"
	>Now Running</a
	>&quot; area at the top of the page.</p
      ><p
      >Execution can also be tracked using the <a href="rd-queue.html"
	>rd-queue</a
	> shell tool.</p
      ><pre
      ><code
	>$ rd-queue
Queue: 1 items
[5] workflow: Workflow:(threadcount:1){[command( scriptfile: /Users/alexh/bin/checkagain.sh)]} &lt;http://strongbad:4440/execution/follow/5&gt;
</code
	></pre
      ><p
      >Each job in the execution queue has an execution ID. The example above shows one item with the ID, 5.</p
      ><p
      >Running jobs can also be killed via <code
	>rd-queue kill</code
	>. Specify execution ID using the &quot;-e&quot; option:</p
      ><pre
      ><code
	>$ rd-queue kill -e 5
rd-queue kill: success. [5] Job status: killed
</code
	></pre
      ></div
    ></div
  ><div id="history"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.4</span
	> History</a
      ></h2
    ><p
    >History for queued ad-hoc commands, as well as, temporary and saved Job executions is stored by the RunDeck server. History data can be filtered and viewed inside the &quot;History&quot; page.</p
    ><div class="figure"
    ><img src="figures/fig0211.png" alt="History page"
       /><p class="caption"
      >History page</p
      ></div
    ><div id="filtering-event-history"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.1</span
	  > Filtering event history</a
	></h3
      ><p
      >By default, the History page will list history for the last day's executions. The page contains a filter control that can be used to expand or limit the executions.</p
      ><p
      >The filter form contains a number of fields to limit search:</p
      ><ul
      ><li
	>Within: Time range. Choices include 1 day, 1 week, 1 month or other (given a start after/before to ended after/before).</li
	><li
	>Name: Job title name.</li
	><li
	>Project: Project name. This may be set if the project menu was used.</li
	><li
	>User: User initiating action.</li
	><li
	>Summary: Message text.</li
	><li
	>Result: Success or failure status.</li
	></ul
      ><div class="figure"
      ><img src="figures/fig0212.png" alt="History filter form"
	 /><p class="caption"
	>History filter form</p
	></div
      ><p
      >After filling the form pressing the &quot;Filter&quot; button, the page will display events matching the search.</p
      ><p
      >Filters can be saved to a menu that makes repeating searches more convenient. Click the &quot;save this filter...&quot; link to save the filter configuration.</p
      ></div
    ><div id="event-view"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.2</span
	  > Event view</a
	></h3
      ><p
      >History for each execution contains the command(s) executed, dispatcher options, success status and a link to a file containing all the output messages.</p
      ><div class="figure"
      ><img src="figures/fig0213.png" alt="Event view"
	 /><p class="caption"
	>Event view</p
	></div
      ><p
      >If any errors occurred, the &quot;Node Failure Count&quot; column will show the number of nodes in red text. A bar chart indicates the percent failed.</p
      ><div class="figure"
      ><img src="figures/fig0216.png" alt="Event view"
	 /><p class="caption"
	>Event view</p
	></div
      ></div
    ><div id="rss-link"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.4.3</span
	  > RSS link</a
	></h3
      ><p
      >An RSS icon provides a link to an RSS view of the events that match the current filtering critera.</p
      ><div class="figure"
      ><img src="figures/fig0214.png" alt="RSS link"
	 /><p class="caption"
	>RSS link</p
	></div
      ></div
    ></div
  ><div id="tips-and-tricks"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.5</span
	> Tips and Tricks</a
      ></h2
    ><div id="saving-filters"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.5.1</span
	  > Saving filters</a
	></h3
      ><p
      >Each of the filter controls provides the means to save the current filter configuration. Press the &quot;save this filter...&quot; link to give it a name. Each saved filter is added to a menu you can access the next time you want that filter configuration.</p
      ></div
    ><div id="auto-completion"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >3.5.2</span
	  > Auto-Completion</a
	></h3
      ><p
      >If you use the Bash shell, RunDeck comes with a nice auto-completion script you can enable. Add this to your <code
	>.bashrc</code
	> file:</p
      ><pre
      ><code
	>source $RDECK_BASE/etc/bash_completion.bash
</code
	></pre
      ><p
      >Press the Tab key when you're writing a dispatch command, and it should return a set of suggestions for you to pick from:</p
      ><pre
      ><code
	>$ dispatch &lt;tab&gt;&lt;tab&gt;
</code
	></pre
      ></div
    ></div
  ><div id="summary-1"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>3.6</span
	> Summary</a
      ></h2
    ><p
    >At this point, you can do basic RunDeck operations - setup a project, define and query the project resource model, execute ad-hoc commands, run and save Jobs and view history.</p
    ><p
    >Next, we'll cover one of RunDeck's core features: Jobs.</p
    ></div
  ></div
><div id="jobs"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >4</span
      > Jobs</a
    ></h1
  ><p
  >In previous sections of this manual, you learned how to execute ad-hoc commands across a filtered set of Node resources. This chapter introduces a fundamental RunDeck feature, <em
    >Jobs</em
    >. But first, one might ask why introduce another layer over ad-hoc command execution.</p
  ><p
  >Here are some issues that might arise over time:</p
  ><ul
  ><li
    >One might find certain ad-hoc command executions are repeated, and perhaps, represent what has become a routine procedure.</li
    ><li
    >Another user in your group needs a simple self-service interface to run a procedure across a set of nodes.</li
    ><li
    >Routine procedures need to be encapsulated and become the basis for other routine procedures.</li
    ></ul
  ><p
  >Jobs provide a means to encapsulate a procedure in a logically named Job. A <em
    >Job</em
    > is a configuration representing the steps in a procedure, a Node filter specification, and dispatcher execution control parameters. Jobs access is governed by an access control policy that describes how users are granted authorization to use Jobs.</p
  ><p
  >RunDeck lets you organize and execute Jobs, and observe the output as the Job is running. You can view a list of the currently running Jobs that is dynamically updated as the Jobs progress. Jobs can also be killed if they need to be stopped.</p
  ><p
  >Each Job has a record of every time it has been executed, and the output from those executions can be viewed.</p
  ><p
  >The next sections describes how to navigate and run existing Jobs. In later sections, the topic of Job creation will be covered.</p
  ><p
  >If you want to skip ahead, you can go straight to <a href="#creating-jobs"
    >Creating Jobs</a
    >.</p
  ><div id="job-groups"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.1</span
	> Job groups</a
      ></h2
    ><p
    >As many jobs will accumulate over time, it is useful to organize Jobs into groups. A group is a logical set of jobs, and one job group can exist inside another. RunDeck displays job lists as a set of folders corresponding to the group structure your jobs define.</p
    ><p
    >Beyond organizing jobs, groups assist in defining access control policy, as we'll cover later in the Authorization chapter.</p
    ></div
  ><div id="listing-and-filtering-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.2</span
	> Listing and filtering Jobs</a
      ></h2
    ><p
    >All Job activity begins on the main &quot;Jobs&quot; page inside RunDeck. After logging in, press the &quot;Jobs&quot; button in the top navigation bar and any Jobs you are authorized to see will be displayed.</p
    ><p
    >If the Jobs were defined inside groups, you will see the listing grouped into a folder like structure. These folders represent the Job groups described earlier. You can navigate these folders by pressing the folder icon to reveal its contents.</p
    ><p
    >Once you have navigated to a Job, you will see its name, possibly its description and a summary total of how many times it has been executed.</p
    ><p
    >Clicking on the job name will will expand the window to show the Job detail. You will see a button bar containing icons representing the actions you are able to perform. Other Job detail will include what command(s) it will run, filter expressions and other dispatcher options.</p
    ><div id="filtering-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.2.1</span
	  > Filtering Jobs</a
	></h3
      ><p
      >The Job page lets you search for Jobs using the Filter option.</p
      ><p
      >Click the &quot;Filter&quot; link to show the filter options:</p
      ><div class="figure"
      ><img src="figures/fig0317.png" alt="Job filter form"
	 /><p class="caption"
	>Job filter form</p
	></div
      ><p
      >This will show the Filter fields. Enter a value in any of the filter fields:</p
      ><ul
      ><li
	>Job Name: the name of the job</li
	><li
	>Group: the name of the job group</li
	><li
	>Description: Job description text</li
	></ul
      ><p
      >You can type a substring or a regular expression in any of these fields.</p
      ><p
      >After pressing the &quot;Filter&quot; button, the Job list will be filtered to include only the matching jobs.</p
      ><div class="figure"
      ><img src="figures/fig0318.png" alt="Job filtered list"
	 /><p class="caption"
	>Job filtered list</p
	></div
      ><p
      >To refine the filter, click on the blue-outlined Filter description, and change the filter fields.</p
      ><p
      >To reset the filter and go back to the full job page, click the &quot;Clear&quot; button in the Filter fields.</p
      ></div
    ></div
  ><div id="viewing-job-detail"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.3</span
	> Viewing Job detail</a
      ></h2
    ><p
    >From a filtered job listing, a Job's detail can be previewed by hovering the mouse pointer over the Job's name. A popup view contains the Job's detail. Click outside the popup to close it.</p
    ><div class="figure"
    ><img src="figures/fig0320.png" alt="Job detail popup"
       /><p class="caption"
      >Job detail popup</p
      ></div
    ><p
    >Pressing the link for the Job name will navigate to a separate page where job detail and a button control bar is displayed. These buttons enable users to delete, copy, edit export or run the Job.</p
    ><div class="figure"
    ><img src="figures/fig0321.png" alt="Job detail page"
       /><p class="caption"
      >Job detail page</p
      ></div
    ><p
    >The buttons displayed on the control bar reflect the <a href="#authorization-1"
      >authorization policy</a
      > enforced for the user.</p
    ><p
    >The information in the Job detail view includes:</p
    ><ul
    ><li
      >Name, description and group</li
      ><li
      >Execution statistics like when the job was last run, it's average success rate, and duration</li
      ><li
      >Details including project name and workflow steps, and log level</li
      ></ul
    ><p
    >Pressing the &quot;Show Matches&quot; link will display the list of Nodes where the Job will run.</p
    ></div
  ><div id="running-a-job"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.4</span
	> Running a Job</a
      ></h2
    ><p
    >Jobs can be run from the shell or from the graphical console.</p
    ><p
    >From the command line, use the <a href="run.html"
      >run</a
      > shell tool. Here's an example that starts a hypothetical job named &quot;restart&quot; belonging in the &quot;apps/web&quot; Job group:</p
    ><pre
    ><code
      >$ run -j apps/web/restart
Job execution started:
[51] restart &lt;http://strongbad:4440/execution/follow/51&gt;
</code
      ></pre
    ><p
    >From the graphical console, any stored job can be started from the Jobs page. Navigate to the desired Job from the filtered listing and then press the green &quot;Run&quot; icon to immediatly queue and run the Job. If you do not see the Run icon, it means your login does not have &quot;run&quot; privileges.</p
    ><div class="figure"
    ><img src="figures/fig0319.png" alt="Job run button"
       /><p class="caption"
      >Job run button</p
      ></div
    ><p
    >If you navigated to the Job's detail page, you press the &quot;Run&quot; button from there.</p
    ><div class="figure"
    ><img src="figures/fig0319-b.png" alt="Job run button"
       /><p class="caption"
      >Job run button</p
      ></div
    ><p
    >After the Run button has been pressed, a dialog will open where you can choose execution options.</p
    ><div id="choose-execution-options"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.4.1</span
	  > Choose execution options</a
	></h3
      ><p
      >Jobs can be defined to prompt the user for options. This page contains a form presenting any of these Job options.</p
      ><p
      >Some options will have default values while others may present you with a menu of choices. Some options are optional while others are required. Lastly, their might be a pattern govering what values are acceptable.</p
      ><p
      >If there are any such Job options, you can change them here before proceeding with the execution.</p
      ><p
      >When you are ready, press &quot;Run Job Now&quot;. The job will enter the execution queue and you can track its execution in the <a href="#now-running"
	>Now running</a
	> section.</p
      ></div
    ><div id="following-running-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.4.2</span
	  > Following Running Jobs</a
	></h3
      ><p
      >Once you have started running a Job, you can follow the Job's output in the Execution Follow page.</p
      ><p
      >On the Jobs page, look in the &quot;Now running&quot; section and click the &quot;output &gt;&gt;&quot; link in the row with the desired Job name.</p
      ><p
      >If you pressed the &quot;run&quot; button from the Job's detail page, your browser will already have been directed to the Execution Follow page.</p
      ></div
    ></div
  ><div id="creating-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.5</span
	> Creating Jobs</a
      ></h2
    ><p
    >RunDeck allows you to define two kinds of Jobs.</p
    ><ul
    ><li
      >Temporary: A <em
	>temporary Job</em
	> defines a set of commands to execute and a node filter configuration.</li
      ><li
      >Saved: A <em
	>saved job</em
	> also defines a set of commands to execute and dispatcher options but can be given a name and stored in a group. Additionally, saved Jobs can be given an execution schedule.</li
      ></ul
    ><p
    >From the Jobs, page press the &quot;New Job&quot; button to begin creating a Job.</p
    ><div class="figure"
    ><img src="figures/fig0301.png" alt="New Job button"
       /><p class="caption"
      >New Job button</p
      ></div
    ><div id="temporary-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.5.1</span
	  > Temporary Jobs</a
	></h3
      ><p
      >A temporary job is a bit like an ad-hoc command except you get more control over how the commands will execute plus the execution can be better tracked within the RunDeck webapp.</p
      ><p
      >To create a temporary job, begin by logging in to the RunDeck graphical console, and press the &quot;Jobs&quot; tab.</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Locate the &quot;New Job&quot; button in the right hand corner and press it to display the &quot;Create New Job&quot; form.</li
	><li
	>A job is defined in terms of one or more workflow steps. In the Workflows area, click the &quot;Add a step&quot; link.</li
	><li
	>Workflow steps can be one of several types. Click the &quot;Script&quot; workflow step type.</li
	><li
	>A script type can be any script that can be executed on the target hosts. Type in the &quot;info&quot; shell script we executed earlier using dispatch.</li
	><li
	>At the bottom of the form, push the &quot;Run and Forget&quot; button to begin execution.</li
	><li
	>Execution output can be followed on the subsequent page.</li
	></ol
      ><div class="figure"
      ><img src="figures/fig0302.png" alt="Temporary job form"
	 /><p class="caption"
	>Temporary job form</p
	></div
      ></div
    ><div id="saved-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.5.2</span
	  > Saved Jobs</a
	></h3
      ><p
      >Running ad hoc commands and temporary jobs are a typical part of day to day administrative work. Occasionally, ad-hoc commands become routine procedures and if were reusable, would become more valuable. These jobs could be handed off to others in the team or invoked from within other Jobs. RunDeck provides an interface to declare and save jobs, both graphically or declared with an XML file.</p
      ></div
    ><div id="simple-saved-job"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >4.5.3</span
	  > Simple saved job</a
	></h3
      ><p
      >For the first saved Job example, create a Job that calls the info script.</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Like in the earlier example, begin by pressing the &quot;New Job&quot; button.</li
	><li
	>Within the new job form:<ul
	  ><li
	    >Select &quot;Yes&quot; for the &quot;Save this job?&quot; prompt. Pressing Yes reveals a form to define a name, group and description for the job.</li
	    ><li
	    >For &quot;Job Name&quot;, enter &quot;info&quot; and for the &quot;Group&quot;, enter &quot;adm/resources&quot;.</li
	    ><li
	    >Providing a description will be come helpful to other users to understand the intent and purpose for the Job.</li
	    ><li
	    >Check the box for &quot;Dispatch to Nodes&quot;</li
	    ><li
	    >Choose the &quot;Node Exclude Filters&quot; and enter the name of your RunDeck server. This will cause the job to run on just the remote Nodes (eg., centos54 and ubuntu).</li
	    ><li
	    >Type in and info script</li
	    ><li
	    >Save the Workflow step</li
	    ><li
	    >Press the &quot;Create&quot; button at the bottom of the page. <img src="figures/fig0303.png" alt="Simple saved job form"
	       /></li
	    ></ul
	  ></li
	><li
	>After the the job is created, the browser is directed to the Jobs page. The folder structure reflecting the group naming will show one Job.<ul
	  ><li
	    >Navigate through the folders buttons to the new job</li
	    ></ul
	  ></li
	><li
	>Notice the green arrow button.<ul
	  ><li
	    >Press the button to run the Job. <img src="figures/fig0304.png" alt="Simple saved job"
	       /></li
	    ></ul
	  ></li
	><li
	>Press the &quot;Run Job Now&quot; button to begin execution.<ul
	  ><li
	    >The job will be queued and executed.</li
	    ></ul
	  ></li
	><li
	>Look in the &quot;Now running&quot; section.<ul
	  ><li
	    >Press the &quot;output &gt;&gt;&quot; link to go to the execution follow page. <img src="figures/fig0305.png" alt="Simple saved job output"
	       /></li
	    ></ul
	  ></li
	></ol
      ></div
    ></div
  ><div id="scheduled-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.6</span
	> Scheduled Jobs</a
      ></h2
    ><p
    >Saved jobs can be configured to run on a periodic basis. If you want to create a Scheduled Job, select Yes under &quot;Schedule to run repeatedly?&quot;</p
    ><div class="figure"
    ><img src="figures/fig0306.png" alt="Scheduled job simple form"
       /><p class="caption"
      >Scheduled job simple form</p
      ></div
    ><p
    >The schedule can be defined in a simple graphical chooser or Unix crontab format.</p
    ><p
    >To use the simple chooser, choose an hour and minute. You can then choose &quot;Every Day&quot; (default), or uncheck that option and select individual days of the week. You can select &quot;Every Month&quot; (default) or unselect that option and choose specific months of the year:</p
    ><p
    >If the crontab time and date format is preferred, enter a cron expression.</p
    ><div class="figure"
    ><img src="figures/fig0307.png" alt="Scheduled job crontab form"
       /><p class="caption"
      >Scheduled job crontab form</p
      ></div
    ><p
    >Use the crontab syntax referenced here: <a href="http://www.quartz-scheduler.org/docs/api/1.8.1/org/quartz/CronExpression.html"
      >CronExpression</a
      ></p
    ><p
    >After the Job has been updated to include a schedule, a clock icon will be displayed when the Job is listed:</p
    ><div class="figure"
    ><img src="figures/fig0308.png" alt="Scheduled job icon"
       /><p class="caption"
      >Scheduled job icon</p
      ></div
    ></div
  ><div id="job-history"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.7</span
	> Job history</a
      ></h2
    ><p
    >In the Jobs page, you can see the outcome of previous executions of Jobs by clicking the &quot;Executions&quot; link for the Job.</p
    ><div class="figure"
    ><img src="figures/fig0309.png" alt="Job executions link"
       /><p class="caption"
      >Job executions link</p
      ></div
    ><p
    >This returns a filtered history peraining to that Job. You can click on any past execution in the list to see the full execution state.</p
    ><div class="figure"
    ><img src="figures/fig0310.png" alt="Job executions matches"
       /><p class="caption"
      >Job executions matches</p
      ></div
    ><p
    >From the Job detail page, one can also see previous execution history.</p
    ></div
  ><div id="killing-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.8</span
	> Killing Jobs</a
      ></h2
    ><p
    >Jobs that are currently running can be Killed immediately.</p
    ><p
    >WARNING: This feature should be used with caution, as it forcibly kills the Java Thread that the Job is running on. It may result in the RunDeck server becoming flaky. It is a deprecated feature of Java that is not recommended to be used, so do so only when extremely necessary.</p
    ><p
    >From the History view Now Running section, or in the Job execution follow page, click on the &quot;Kill Job Now&quot; button for the running Job.</p
    ><p
    >When prompted &quot;Really kill this job?&quot; Click the &quot;Yes&quot; button.</p
    ><p
    >The Job will terminate with a &quot;Killed&quot; completion status.</p
    ><p
    >See also: <a href="rd-queue.html"
      >rd-queue</a
      >.</p
    ></div
  ><div id="deleting-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.9</span
	> Deleting Jobs</a
      ></h2
    ><p
    >In the Job detail page, click the red &quot;X&quot; icon for to delete the Job.</p
    ><div class="figure"
    ><img src="figures/fig0311.png" alt="Job delete button"
       /><p class="caption"
      >Job delete button</p
      ></div
    ><p
    >Click &quot;Yes&quot; when it says &quot;Really delete this Job?&quot;</p
    ></div
  ><div id="updating-and-copying-jobs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.10</span
	> Updating and copying Jobs</a
      ></h2
    ><p
    >All of the data you set when creating a job can be modified. To edit a Job, you can click the Pencil icon:</p
    ><div class="figure"
    ><img src="figures/fig0312.png" alt="Job edit button"
       /><p class="caption"
      >Job edit button</p
      ></div
    ><p
    >Similarly, to Copy a Job definition to a new Job, press the Copy button.</p
    ><div class="figure"
    ><img src="figures/fig0313.png" alt="Job copy button"
       /><p class="caption"
      >Job copy button</p
      ></div
    ></div
  ><div id="exporting-job-definitions"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.11</span
	> Exporting Job definitions</a
      ></h2
    ><p
    >Job definitions created inside the RunDeck graphical console can be exported to an XML file format and be used for later import.</p
    ><p
    >Two methods exist to retrieve the XML definition one inside RunDeck's graphical interface and the other using the <code>rd-jobs</code> shell tool.</p
    ><p
    >In the Job detail page, locate the icon with an XML symbol in the toolbar. It is labeled &quot;Download XML&quot; in the mouse tool tip.</p
    ><div class="figure"
    ><img src="figures/fig0314.png" alt="Job export button"
       /><p class="caption"
      >Job export button</p
      ></div
    ><p
    >Press this button to initiate the file download to your browser. Depending on your browser, it will be stored in your downloads directory.</p
    ><p
    >If you prefer the command line open a shell on the RunDeck server. Run the <code
      >rd-jobs</code
      > command to write it to disk. By default, rd-jobs will dump all Job definitions to one file. To limit it to just a single Job specify its name:</p
    ><pre
    ><code
      >rd-jobs -n &quot;job-name&quot; -f job.xml
</code
      ></pre
    ><p
    >This will store the results in the &quot;job.xml&quot; file <a href="job-v20.html"
      >job-v20(5)</a
      >.</p
    ><p
    >Consult the <a href="rd-jobs.html"
      >rd-jobs(1)</a
      > manual page for additional command usage.</p
    ></div
  ><div id="importing-jobs-definitions"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.12</span
	> Importing Jobs definitions</a
      ></h2
    ><p
    >If you have a &quot;job.xml&quot; file (See above) and want to upload it via the GUI web interface, you can do so.</p
    ><p
    >Click on the New Job&quot; button in the Job list.</p
    ><p
    >In the &quot;Create New Job&quot; form, click on the button that says &quot;Uplaod Definition...&quot; on the right side:</p
    ><div class="figure"
    ><img src="figures/fig0315.png" alt="Job import button"
       /><p class="caption"
      >Job import button</p
      ></div
    ><p
    >Click the Choose File button and choose your job.xml file to upload.</p
    ><div class="figure"
    ><img src="figures/fig0316.png" alt="Job import form"
       /><p class="caption"
      >Job import form</p
      ></div
    ><p
    >Choose an option where it says &quot;When a job with the same name already exists:&quot;:</p
    ><ul
    ><li
      >Update - this means that a job defined in the xml will overwrite any existing job with the same name<br
	 /></li
      ><li
      >Skip - this means that a job defined in the xml will be skipped over if there is an existing job with the same name<br
	 /></li
      ><li
      >Create - this means that the job defined in the xml will be used to create a new job if there is an existing job with the same name.</li
      ></ul
    ><p
    >Click the Upload button. If there are any errors with the Job definitions in the XML file, they will show up on the page.</p
    ></div
  ><div id="summary-2"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>4.13</span
	> Summary</a
      ></h2
    ><p
    >After reading this chapter, you should be familiar with RunDeck Jobs and able to find and run them. You should understand how to create temporary and saved jobs and understand how to find thier history. Finally, you should be aware of how to export and import Job definitions as XML documents.</p
    ><p
    >Next, we'll cover how to create multi-step procedures using Job Workflows.</p
    ></div
  ></div
><div id="job-workflows"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >5</span
      > Job Workflows</a
    ></h1
  ><p
  >The Job's most basic feature is its ability to execute one or more commands across a set of nodes. This sequence of commands is called a <em
    >workflow</em
    >, and each step in the workflow is defined as an invocation to a command.</p
  ><p
  >The steps of the Job workflow are displayed when viewing a Job's detail from a Job listing or within the Job editor form.</p
  ><div id="workflow-definition"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.1</span
	> Workflow definition</a
      ></h2
    ><p
    >Workflows can be defined within the RunDeck graphical console or as an XML document that is loaded to the server.</p
    ><p
    >The graphical console provides an authoring environment where steps can be added, edited, removed or reordered.</p
    ><p
    >Users prefering to define Jobs in XML should read the <a href="job-v20.html"
      >job-v20(5)</a
      > manual page.</p
    ><p
    >It is also possible to author Jobs inside the graphical console and then export the definiton as an XML file using the <code
      >rd-jobs</code
      > shell tool (<a href="rd-jobs.html"
      >rd-jobs(1)</a
      >).</p
    ></div
  ><div id="workflow-control-settings"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.2</span
	> Workflow control settings</a
      ></h2
    ><p
    >Workflow execution is controlled by two important settings: <em
      >Keepgoing</em
      > and <em
      >Strategy</em
      >.</p
    ><div class="figure"
    ><img src="figures/fig0401.png" alt="Workflow controls"
       /><p class="caption"
      >Workflow controls</p
      ></div
    ><p
    ><em
      >Keepgoing</em
      >: This manages what to do if a step incurs and error:</p
    ><ul
    ><li
      >No: Fail immediately (default)</li
      ><li
      >Yes: Continue to next step</li
      ></ul
    ><p
    >The default is to fail immediately but depending on the procedure at hand you can choose to have the execution continue.</p
    ><p
    ><em
      >Strategy</em
      >: Controls the order of execution of steps and command dispatch to nodes: <em
      >Node-oriented</em
      > and <em
      >Step-oriented</em
      >.</p
    ><ul
    ><li
      ><em
	>Node-oriented</em
	>: Executes the full workflow on each node before the next node. (default)</li
      ><li
      ><em
	>Step-oriented</em
	>: Executes each step on all nodes before the next node.</li
      ></ul
    ><p
    >The following illustrations contrast the strategies showing how three steps proceed across two nodes.</p
    ><p
    >Node-oriented flow illustrated:</p
    ><pre
    ><code
      >1.   NodeA    step#1
2.     &quot;      step#2
3.     &quot;      step#3
4.   NodeB    step#1
5.     &quot;      step#2
6.     &quot;      step#3
</code
      ></pre
    ><p
    >Step-oriented flow illustrated:</p
    ><pre
    ><code
      >1.   NodeA    step#1
2.   NodeB      &quot;
3.   NodeA    step#2
4.   NodeB      &quot;
5.   NodeA    step#1
6.   NodeB      &quot;
</code
      ></pre
    ><p
    >The process you are automating will determine which strategy is correct, though the node-oriented flow is more commonplace.</p
    ></div
  ><div id="workflow-steps"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.3</span
	> Workflow steps</a
      ></h2
    ><p
    >The following sections describe how to construct a workflow as a set of steps that call commands of different types.</p
    ><p
    >When creating a new Job definition, the Workflow form will be set with defaults and have no workflow steps defined. The workflow editor will have a form open asking to enter a shell command as the first step.</p
    ><div class="figure"
    ><img src="figures/fig0402.png" alt="Add a step"
       /><p class="caption"
      >Add a step</p
      ></div
    ><p
    >To add new steps simply press the &quot;Add a step&quot; link inside the workflow editor form. This will prompt you with a dialog asking which kind of workflow step you would like to add. Each kind of step has its own form. When you are done filling out the form, press &quot;Save&quot; to add it to the sequence. Pressing &quot;Cancel&quot; will close the form and leave the sequence unchanged.</p
    ><div class="figure"
    ><img src="figures/fig0403.png" alt="Workflow step types"
       /><p class="caption"
      >Workflow step types</p
      ></div
    ><p
    >New steps are always added to the end of the sequence. See <a href="#reordering-steps"
      >Reordering steps</a
      > for directions on modifying the step order.</p
    ><p
    >The next several sections describe the specification of each kind of command step.</p
    ><div id="command-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.1</span
	  > Command step</a
	></h3
      ><p
      >Use the command step to call system commands. This is the default type of workflow step when creating a Job. Enter any command string you would type at the terminal on the remote hosts.</p
      ><div class="figure"
      ><img src="figures/fig0404.png" alt="Command step type"
	 /><p class="caption"
	>Command step type</p
	></div
      ><p
      >This is similar to calling the command with <code>dispatch</code>:</p
      ><pre
      ><code
	>dispatch [filter-options] -- command
</code
	></pre
      ></div
    ><div id="script-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.2</span
	  > Script step</a
	></h3
      ><p
      >Execute the supplied shell script content. Optionally, can pass an argument to the script specified in the lower text field.</p
      ><div class="figure"
      ><img src="figures/fig0405.png" alt="Script step type"
	 /><p class="caption"
	>Script step type</p
	></div
      ><p
      >This is similar to calling the command with <code>dispatch</code>:</p
      ><pre
      ><code
	>dispatch [filter-options] --stdin -- args &lt;&lt;EOF 
script content here 
EOF
</code
	></pre
      ></div
    ><div id="script-file-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.3</span
	  > Script file step</a
	></h3
      ><p
      >Executes the script file local to the sever to the filtered Node set. Arguments can be passed to the script by specifying them in the lower text field.</p
      ><div class="figure"
      ><img src="figures/fig0406.png" alt="Script file step type"
	 /><p class="caption"
	>Script file step type</p
	></div
      ><p
      >This is similar to calling the script file with <code>dispatch</code>:</p
      ><pre
      ><code
	>dispatch [filter-options] -s scriptfile -- args
</code
	></pre
      ></div
    ><div id="job-reference-step"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >5.3.4</span
	  > Job reference step</a
	></h3
      ><p
      >To call another saved Job, create a Job Reference step. Enter the name of the Job and its group.</p
      ><div class="figure"
      ><img src="figures/fig0407.png" alt="Job step type"
	 /><p class="caption"
	>Job step type</p
	></div
      ><p
      >The Job Reference form provides a Job browser to make it easier to select from the existing set of saved Jobs. Click the &quot;Choose A Job...&quot; link and navigate to the desired Job.</p
      ><p
      >Finally, if the Job defines Options, you can specify them in the commandline arguments text field.</p
      ><p
      >This is simililar to calling the other Job with <a href="run.html"
	>run</a
	>:</p
      ><pre
      ><code
	>run [filter-options] -j group/jobname
</code
	></pre
      ></div
    ></div
  ><div id="reordering-steps"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.4</span
	> Reordering steps</a
      ></h2
    ><p
    >The order of the Workflow steps can be modified by hovering over any step and then clicking and dragging the double arrow icon to the desired position. A blue horizontal bar helps highlight the position where the Job will land.</p
    ><div class="figure"
    ><img src="figures/fig0408.png" alt="Job step reorder"
       /><p class="caption"
      >Job step reorder</p
      ></div
    ><p
    >After releasing the select Job, it will land in the desired position and the step order will be updated.</p
    ><p
    >If you wish to Undo the step reordering, press the &quot;Undo&quot; link above the steps.</p
    ><p
    >The &quot;Redo&quot; button can be pressed to reapply the last undone change.</p
    ><p
    >Press the &quot;Revert All Changes&quot; button to go back to the original step order.</p
    ></div
  ><div id="save-the-changes"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.5</span
	> Save the changes</a
      ></h2
    ><p
    >Once the Workflow steps have been defined and order, changes are permanently saved after pressing the &quot;Create&quot; button if new or the &quot;Update&quot; button if the Job is being modified.</p
    ></div
  ><div id="summary-3"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>5.6</span
	> Summary</a
      ></h2
    ><p
    >At this point you should understand what a Job workflow is, the kinds of steps they can contain and how to define a workflow.</p
    ><p
    >Next, we'll cover more about RunDeck's Job Option features.</p
    ></div
  ></div
><div id="job-options"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >6</span
      > Job Options</a
    ></h1
  ><p
  >Any command or script can be wrapped as a Job. Creating a Job for every use case will proliferate a large number of Jobs differing only by how the Job calls the scripts. These differences are often environment or application version related. Other times only the person running the Job can provide the needed information to run the Job correctly.</p
  ><p
  >Making your scripts and commands data driven, will also make them more generic and therefore, resuable in different contexts. Rather than maintain variations of the same basic process, letting Jobs be driven by a model of options from externally provided data will lead to better abstraction and encapsulation of your process.</p
  ><p
  >RunDeck Jobs can be configured to prompt a user for input by defining one or more named <em
    >options</em
    >. An <em
    >option</em
    > models a named parameter that can be required or optional and include a range of choices that will be presented to the user when the Job is run.</p
  ><p
  >Users supply options by typing in a value or selecting from a menu of choices. A validation pattern ensures input complies to the option requirement. Once chosen, the value chosen for the option is accessible to the commands called by the Job.</p
  ><p
  >Option choices can be modeled as a static set or from a dynamic source. Static choices can be modeled as a comma separated list in the job definition. When option values must be dynamic, the Job can be defined to use a URL to retrieve option data from an external source. Enabling Jobs to access external sources via URL opens the door to integrating RunDeck with other tools and incorporating their data into Job workflows.</p
  ><div id="prompting-the-user"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.1</span
	> Prompting the user</a
      ></h2
    ><p
    >The obvious effect from defining Job options is their appearance to the user running the Job. Users will be presented a page called &quot;Choose Execution Options...&quot; where input and menu choices must be configured.</p
    ><p
    >Command line users executing Jobs via the <code
      >run</code
      > shell tool also will specify options as an argument string.</p
    ><p
    >It is worth spending a moment to consider how options become part of the user interface to Jobs and give some thought to this next level of procedure formalization.</p
    ><ul
    ><li
      >Naming and description convention: Visualize how the user will read the option name and judge its purpose from the description you supply.</li
      ><li
      >Required options: Making an option required means the Job will fail if a user leaves it out.</li
      ><li
      >Input restrictions and validation: If you need to make the option value be somewhat open ended consider how you can create safeguards to control their choice.</li
      ></ul
    ></div
  ><div id="options-editor"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.2</span
	> Options editor</a
      ></h2
    ><p
    >Options can be created for any stored Job. The Job edit page contains an area displaying a summary to existing options and a link to add new ones or edit existing ones.</p
    ><div class="figure"
    ><img src="figures/fig0501.png" alt="Add option link"
       /><p class="caption"
      >Add option link</p
      ></div
    ><p
    >The option summary shows each option and its default value if it defines them.</p
    ><p
    >Clicking the &quot;edit&quot; link opens the options editor.</p
    ><div class="figure"
    ><img src="figures/fig0503.png" alt="Option editor"
       /><p class="caption"
      >Option editor</p
      ></div
    ><p
    >The options editor displays an expanded summary for each defined option. Each option is listed with its usage summary, description, values list and any restrictions. Pressing the &quot;Add an option&quot; link will open a form to define a new parameter. Pressing the &quot;Close&quot; link will collapse the options editor and return back to the summary view.</p
    ><p
    >Moving the mouse over any row in the options editor reveals links to delete or edit the highlighted option. Pressing the remove icon will display a prompt confirming you want to delete that option from the Job. Clicking the &quot;edit&quot; link opens a new form that lets you modify all aspects of that option.</p
    ><p
    >Options can also be defined as part of an XML job definition and later loaded to the RunDeck server. See <a href="job-v20.html"
      >job-v20(5)</a
      > and <a href="rd-jobs.html"
      >rd-jobs(1)</a
      > manual pages if you prefer using an XML Job definition.</p
    ></div
  ><div id="defining-an-option"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.3</span
	> Defining an option</a
      ></h2
    ><p
    >New options can be defined by pressing the &quot;Add an option&quot; link while existing ones can be changed by pressing their &quot;edit&quot; link.</p
    ><div class="figure"
    ><img src="figures/fig0502.png" alt="Option edit form"
       /><p class="caption"
      >Option edit form</p
      ></div
    ><p
    >The option definition form is organized into several areas:</p
    ><dl
    ><dt
      >Identification</dt
      ><dd
      ><p
	>Here you provide the option's name and description. The name becomes part of acceptable arguments to the Job while the description will be provided as help text to users running the Job.</p
	><p
	>The Default Value will be pre-selected in the GUI when the option is presented.</p
	></dd
      ><dt
      >Allowed values</dt
      ><dd
      ><p
	>Allowed values provide a model of possible choices. This can contain a static list of values or a URL to a server providing option data. Values can be specified as a comma separated list as seen above but can also be requested from an external source using a &quot;remote URL&quot; <a href="#remote-option-values"
	  >See below</a
	  >.</p
	></dd
      ><dt
      >Restrictions</dt
      ><dd
      ><p
	>Defines criteria on which input to accept or present. Option choices can be controlled using the &quot;Enforced from values&quot; restriction. When set &quot;true&quot;, RunDeck will only present a popup menu. If set &quot;false&quot;, a text field will also be presented. Enter a regular expression in the &quot;Match Regular Expression&quot; field the Job will evaluate when run.</p
	></dd
      ><dt
      >Requirement</dt
      ><dd
      ><p
	>Indicates if the Job can only run if a choice is provided for that Option. Choosing &quot;No&quot; states the option is not required Choose &quot;Yes&quot; to state the option is required.</p
	><p
	>If a Default Value is set for the option, then this value will automatically be set for the option if it is Required, even if not specified among the arguments when executing a job via the command-line or API.</p
	></dd
      ><dt
      >Multi-valued</dt
      ><dd
      ><p
	>Defines if the user input can consist of multiple values. Choosing &quot;No&quot; states that only a single value can chosen as input. Choosing &quot;Yes&quot; states that the user may select multiple input values from the Allowed values and/or enter multiple values of their own. The delimiter string will be used to separate the multiple values when the Job is run.</p
	></dd
      ></dl
    ><p
    >Once satisfied with the option definition, press the &quot;Save&quot; button to add it to the Job definition. Pressing the &quot;Cancel&quot; button will dismiss the changes and close the form.</p
    ></div
  ><div id="remote-option-values"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.4</span
	> Remote option values</a
      ></h2
    ><p
    >A model of option values can be retrieved from an external source. When the <code
      >valuesUrl</code
      > is specified for an Option, then the model of allowed values is retrieved from the specified URL.</p
    ><p
    >This is useful in a couple of scenarios when RunDeck is used to coordinate process that depend on other systems:</p
    ><ul
    ><li
      >Deploying packages or artifacts produced by a build or CI server, e.g. Hudson.<ul
	><li
	  >A list of recent Hudson build artifacts can be imported as Options data, so that a User can pick an appropriate package name to deploy from a list.</li
	  ></ul
	></li
      ><li
      >Selecting from a set of available environments, defined in a CMDB</li
      ><li
      >Any situation in which input variables for your Jobs must be selected from some set of values produced by a different system.</li
      ></ul
    ><p
    >See <a href="#option-model-provider"
      >Chapter 9 - Option Model Provider</a
      >.</p
    ></div
  ><div id="script-usage"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.5</span
	> Script usage</a
      ></h2
    ><p
    >Option values can be passed to scripts as an argument or referenced inside the script via a named token. Option values can be accessed in one of several ways:</p
    ><dl
    ><dt
      >Value passed as an environment variable:</dt
      ><dd
      ><p
	>Bash: $RD_OPTION_<em
	  >NAME</em
	  > <sup
	  ><a href="#fn2" class="footnoteRef" id="fnref2"
	    >2</a
	    ></sup
	  ></p
	></dd
      ><dt
      >Value passed as an argument to a script:</dt
      ><dd
      ><p
	>Commandline Arguments: ${option.<em
	  >name</em
	  >}</p
	></dd
      ><dt
      >Value referenced as a replacement token inside the script:</dt
      ><dd
      ><p
	>Script Content: @option.<em
	  >name</em
	  >@</p
	></dd
      ></dl
    ><p
    >A single example helps illustrate these methods. Imagine a trivial script is wrapped in a Job named &quot;hello&quot; and has an option named &quot;message&quot;.</p
    ><p
    >The &quot;hello&quot; Job option signature would be: <code
      >-message &lt;&gt;</code
      >.</p
    ><div class="figure"
    ><img src="figures/fig0504.png" alt="Option usage"
       /><p class="caption"
      >Option usage</p
      ></div
    ><p
    >Here's the content of this simple script.</p
    ><pre class="sourceCode bash"
    ><code
      ><span class="Normal NormalText"
	>    </span
	><span class="Comment"
	>#!/bin/sh    </span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Builtin"
	>echo</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Variable"
	>envvar=$RD_OPTION_MESSAGE</span
	><span class="Normal NormalText"
	> ;</span
	><span class="Comment"
	># read from environment</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Builtin"
	>echo</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Variable"
	>args=$1</span
	><span class="Normal NormalText"
	>                   ;</span
	><span class="Comment"
	># comes from argument vector</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Builtin"
	>echo</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Variable"
	>message=</span
	><span class="Normal NormalText"
	>@option.message@  ;</span
	><span class="Comment"
	># replacement token</span
	><br
	 /></code
      ></pre
    ><p
    >When the user runs the &quot;hello&quot; job they will be prompted for the &quot;message&quot; value.</p
    ><div class="figure"
    ><img src="figures/fig0505.png" alt="Option entered"
       /><p class="caption"
      >Option entered</p
      ></div
    ><p
    >Let's assume they entered the word &quot;howdy&quot; in response. The output of the Job will be:</p
    ><pre
    ><code
      >envar=howdy
args=howdy    
message=howdy    
</code
      ></pre
    ><p
    >It's important to know what happens if the option isn't set. This can happen if you define an option that is not required and do not give it a default value.</p
    ><p
    >Let's imagine the Job was run without a message option supplied, the output would look like this:</p
    ><pre
    ><code
      >envar=
args=
message=@option.message@
</code
      ></pre
    ><p
    >Here are some tips to deal with this possibility:</p
    ><dl
    ><dt
      >Environment variable:</dt
      ><dd
      ><p
	>As a precaution you might test existence for the variable and perhaps set a default value. To test its existence you might use:</p
	><pre
	><code
	  > test -s  $RD_OPTION_NAME
</code
	  ></pre
	><p
	>You might also use a Bash feature that tests and defaults it to a value:</p
	><pre
	><code
	  > ${RD_OPTION_NAME:=mydefault} 
</code
	  ></pre
	></dd
      ><dt
      >Replacement token</dt
      ><dd
      >If the option is unset the token will be left alone inside the script. You might write your script a bit more defensively and change the implementation like so:</dd
      ></dl
    ><pre class="sourceCode bash"
    ><code
      ><span class="Normal NormalText"
	>        </span
	><span class="Others Variable"
	>message=</span
	><span class="Normal NormalText"
	>@option.message@</span
	><br
	 /><span class="Normal NormalText"
	>        </span
	><span class="Keyword"
	>if</span
	><span class="Keyword Builtin"
	> [</span
	><span class="Normal NormalText"
	> </span
	><span class="String StringDoubleQ"
	>&quot;</span
	><span class="Others Variable"
	>$message</span
	><span class="String StringDoubleQ"
	>&quot;</span
	><span class="Normal NormalText"
	> </span
	><span class="Others Expression"
	>==</span
	><span class="Normal NormalText"
	> </span
	><span class="String StringDoubleQ"
	>&quot;@option.message@&quot;</span
	><span class="Keyword Builtin"
	> ]</span
	><span class="Normal NormalText"
	> ; </span
	><span class="Keyword"
	>then</span
	><br
	 /><span class="Normal NormalText"
	>           </span
	><span class="Others Variable"
	>message=</span
	><span class="Normal NormalText"
	>mydefault</span
	><br
	 /><span class="Normal NormalText"
	>        </span
	><span class="Keyword"
	>fi</span
	><span class="Normal NormalText"
	> </span
	><br
	 /></code
      ></pre
    ></div
  ><div id="calling-a-job-with-options"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.6</span
	> Calling a Job with options</a
      ></h2
    ><p
    >Jobs can be invoked from the command line using the <code
      >run</code
      > shell tool or as a step in another Job's workflow.</p
    ><p
    >Using the <code
      >run</code
      > command pass them after the double hyphen:</p
    ><pre
    ><code
      >run -j jobId -- -paramA valA -paramB valB
</code
      ></pre
    ><p
    >Inside an XML definition, insert them as an <code
      >arg</code
      > element:</p
    ><pre class="sourceCode xml"
    ><code
      ><span class="Keyword Element"
	>&lt;command&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;jobref</span
	><span class="Others Attribute"
	> group=</span
	><span class="String Value"
	>&quot;test&quot;</span
	><span class="Others Attribute"
	> name=</span
	><span class="String Value"
	>&quot;other tests&quot;</span
	><span class="Keyword Element"
	>&gt;</span
	><br
	 /><span class="Normal NormalText"
	>        </span
	><span class="Keyword Element"
	>&lt;arg</span
	><span class="Others Attribute"
	> line=</span
	><span class="String Value"
	>&quot;-paramA valA -paramB valB&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;/jobref&gt;</span
	><br
	 /><span class="Keyword Element"
	>&lt;/command&gt;</span
	><br
	 /></code
      ></pre
    ><p
    >Consult the <a href="run.html"
      >run(1)</a
      > and <a href="job-v20.html"
      >job-v20(5)</a
      > manual pages for additional information.</p
    ></div
  ><div id="summary-4"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>6.7</span
	> Summary</a
      ></h2
    ><p
    >After reading this chapter you should understand how to run Jobs with options, as well as, add and edit them. If you are interested in generating option data for one of your jobs, see the <a href="#option-model-provider-examples"
      >option model provider</a
      > section in the <a href="#rundeck-by-example"
      >Examples</a
      > chapter.</p
    ></div
  ></div
><div id="rundeck-by-example"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >7</span
      > RunDeck by example</a
    ></h1
  ><p
  >This chapter presents working examples reflecting a variety of solutions you can create with RunDeck. Helping you apply concepts and features introduced in earlier chapters is the focus of these examples. Rather than make the examples abstract, they are set in the context of Acme Anvils, a fictious organization that manages an online application.</p
  ><div id="acme-anvils"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.1</span
	> Acme Anvils</a
      ></h2
    ><p
    >Acme Anvils is a hypothetical start up selling new and used anvils from their web site. Two teams inside the company are involved with the development and support of the anvil sales application. Being a new company, there isn't much control over access to the live environment. Either team can make changes to systems which has led to mistakes and outages. Because the senior management is so enthusiastic, they push the teams to deliver new features as frequently as possible. Unfortunately, this has led to another problem: the Acme Anvil web site is an unstable memory hog and requires occassional restarts.</p
    ><p
    >There are actually two methods to the restart procedure depending on the problem: &quot;kill&quot; versus &quot;normal&quot;. The &quot;kill&quot; restart is required when the application becomes totally unresponsive. The &quot;normal&quot; restart occurs when the application needs to free memory.</p
    ><p
    >Depending on the urgency or the staff on hand, either a developer or an administrator conducts the restart, albeit differently. Because the developers write the software, they understand the restart requirements from an application perspective. The administrators on the other hand, are not always informed of these requirements but are well versed in restarting the application from a systems perspective. This has led to a divergence in procedures and has become the main source of problems that affect their customers.</p
    ><p
    >An administrator, tired of the late night calls to restart the application, and frustrated by the knowledge gap between operations and development has decided to take the initiative come up with a better approach.</p
    ></div
  ><div id="rundeck-set-up"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.2</span
	> RunDeck set up</a
      ></h2
    ><p
    >The administrator chooses a machine with access to the servers in the live environment and installs the RunDeck software there.</p
    ><p
    >A project called &quot;anvils&quot; is created to manage the application support activites .</p
    ><p
    >The administrator creates the project using the <a href="rd-project.html"
      >rd-project</a
      > shell tool though this could be done with the RunDeck GUI (see (<a href="#project-setup"
      >project setup</a
      >). After logging into the RunDeck server, the command is run:</p
    ><pre
    ><code
      >rd-project -p anvils -a create
</code
      ></pre
    ><p
    >This initialized the &quot;anvils&quot; project in RunDeck so it only contains information about the server node. Adding information about the nodes deployed in the live environment is the next step (see <a href="#resource-model"
      >resource model</a
      >).</p
    ><p
    >The environment has five nodes: anv1-anv5. Anvils is a three tier application and has web, application and database components installed across the five nodes.</p
    ><p
    >Additionally, the administrator decides to incorporate a recent convention to use different system logins to execute SSH commands to control running application components. The web component are run as the &quot;www&quot; user while the app and database components run as user &quot;anvils&quot;.</p
    ><p
    >With this information in hand, the administrator prepares the project resource model using the <a href="resource-v10.html"
      >resource-v10</a
      > document format. The file listing below contains the node definitions for the five nodes -- anv1, anv2, anv3, anv4, anv5:</p
    ><p
    >File listing: resources.xml</p
    ><pre
    ><code
      >&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;project&gt;
  &lt;node name=&quot;anv1&quot; type=&quot;Node&quot;
     description=&quot;an anvils web server&quot; 
     hostname=&quot;anv1.acme.com&quot;  username=&quot;www&quot; tags=&quot;web&quot;/&gt;
  &lt;node name=&quot;anv2&quot; type=&quot;Node&quot; 
     description=&quot;an anvils web server&quot; 
     hostname=&quot;anv2.acme.com&quot;  username=&quot;www&quot; tags=&quot;web&quot;/&gt;
  &lt;node name=&quot;anv3&quot; type=&quot;Node&quot; 
     description=&quot;an avnils app server&quot; 
     hostname=&quot;anv3.acme.com&quot;  username=&quot;anvils&quot; tags=&quot;app&quot;/&gt;
  &lt;node name=&quot;anv4&quot; type=&quot;Node&quot; 
     description=&quot;an anvils app server&quot; 
     hostname=&quot;anv4.acme.com&quot;  username=&quot;anvils&quot; tags=&quot;app&quot;/&gt;
  &lt;node name=&quot;anv5&quot; type=&quot;Node&quot; 
     description=&quot;the anvils database server&quot; 
     hostname=&quot;anv5.acme.com&quot;  username=&quot;anvils&quot; tags=&quot;db&quot;/&gt; 
&lt;/project&gt;
</code
      ></pre
    ><p
    >Reviewing the XML content one sees the XML tag set represent the host information described above. A logical name for each node is defined with the <code
      >name</code
      > attribute (eg name=&quot;anv1&quot;). The address used by SSH is set with <code
      >hostname</code
      > (eg hostname=&quot;anv1.acme.com&quot;) while the login used to execute SSH commands has been specified with the <code
      >username</code
      > attribute (username=&quot;www&quot; vs username=&quot;anvils&quot;). The value for the <code
      >tags</code
      > attribute reflects the node function (tags=&quot;web&quot; vs tags=&quot;app&quot;).</p
    ><p
    >The administrator saves the file and places it in a path of his choice. To make RunDeck aware of it, the administrator modifies the project configuration file, $RDECK_BASE/projects/anvils/etc/project.properties, modifying the <code
      >project.resources.file</code
      > setting :</p
    ><pre
    ><code
      >project.resources.file = /etc/rundeck/projects/anvils/resources.xml
</code
      ></pre
    ><p
    >With the resources file in place and the project configuration updated, the administrator has finished with the resource model preparation and can begin dispatching commands.</p
    ><p
    >List all the nodes in the anvils project by opening the Filter and typing <code
      >.*</code
      > in the <em
      >Name</em
      > field and then press &quot;Filter&quot;. You should see a listing of 6 nodes.</p
    ><div class="figure"
    ><img src="figures/fig0601.png" alt="Anvils resources"
       /><p class="caption"
      >Anvils resources</p
      ></div
    ></div
  ><div id="tag-classification-and-command-dispatching"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.3</span
	> Tag classification and command dispatching</a
      ></h2
    ><p
    >With tags that describe application role, commands can be targeted to specific sub sets of nodes without hard coding any hostnames. The <a href="dispatch.html"
      >dispatch</a
      > command's listing feature illustrates how tag filtering selects particular node sets in the shell:</p
    ><p
    >Use the <code
      >tags</code
      > keyword to list the web nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=web
anv1 anv2
</code
      ></pre
    ><p
    >List the app nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=app
anv3 anv4
</code
      ></pre
    ><p
    >List the db nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=db
anv5
</code
      ></pre
    ><p
    >Use the &quot;+&quot; (AND) operator to list the web and app nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I tags=web+app
anv1 anv2 anv3 anv4
</code
      ></pre
    ><p
    >Exclude the web and app nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -X tags=web+app
anv5
</code
      ></pre
    ><p
    >Using a wildcard for node name, list all the nodes:</p
    ><pre
    ><code
      >dispatch -p anvils -I '.*' 
anv1 anv2 anv3 anv4 anv5 
</code
      ></pre
    ><p
    >Here's an example using filters in the graphical console:</p
    ><div class="figure"
    ><img src="figures/fig0602.png" alt="Anvils filtered list"
       /><p class="caption"
      >Anvils filtered list</p
      ></div
    ><p
    >Filtering with tags provides an abstraction over hostnames and lets the administrator think about scripting process using loose classifications. New nodes can be added, others decommissioned while others given new purpose, and the procedures stay unchanged because they are bound to the filtering critera.</p
    ><p
    >This simple classification scheme will allow the developers and administrators to share a common vocabulary when talking about the kinds of nodes supporting the Anvils application.</p
    ></div
  ><div id="jobs-1"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.4</span
	> Jobs</a
      ></h2
    ><p
    >Jobs are a convenient method to establish a library of routine procedures. By its nature, a saved Job encapsulates a process into a logically named interface. Jobs can begin as a single item workflow that calls a small or large shell script but evolve into a multi-step workflow. One job can also call another job as a step in its workflow. Using this approach one can view each Job as a reusable building block upon which more complex automation can be built.</p
    ><p
    >The administrator decides Jobs can be used to encapsulate procedures to manage the restart process. Both developers and administrators can collaborate on their definition and evolution and maintenance.</p
    ><p
    >Two sets of scripts are already in use to manage the startup and shutdown procedures. Rather than force the issue as to which one is correct or superior, the administrator focuses on creating a skeleton to more easily present how scripts can be encapsulated by the job workflow. After demonstrating this simple framework, the administrator can discuss how to incorporate the best of both script implementations into the Job definitions.</p
    ><p
    >For the skeleton, the administrator creates simple placeholder scripts that merely echo their intent and the arguments passed to the them. Two scripts - start.sh and stop.sh - represent the two steps of the restart process.</p
    ><p
    >Scripts:</p
    ><p
    >File listing: start.sh</p
    ><pre
    ><code
      >#!/bin/sh
# Usage: $0 
echo Web started.
</code
      ></pre
    ><p
    >File listing: stop.sh</p
    ><pre
    ><code
      >#!/bin/sh
# Usage: $0 [normal|kill]
echo Web stopped with method: $1.
</code
      ></pre
    ><p
    >Because either the normal or kill can be specified for the &quot;method&quot; option, the Jobs will need to pass the user's choice as an argument to the script.</p
    ><p
    >There is no script for the restart process itself since that will be defined as a Job workflow.</p
    ><div id="job-structure"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.4.1</span
	  > Job structure</a
	></h3
      ><p
      >With an idea of the restart scripts in mind, the next step is to define a job to encapsulate the restart procedure. Though the overall goal is to provide a single restart procedure, for the sake of reusability, it might be preferred to break each step of the process into separate jobs.</p
      ><p
      >Using this approach the adminstrator imagines the following jobs:</p
      ><ul
      ><li
	>start: call the start.sh script to start the web service</li
	><li
	>stop: call the stop.sh script to stop the web service</li
	><li
	>Restart: calls the jobs: stop, start</li
	></ul
      ><p
      >Since the restart procedure is the primary focus, it is capitalized for distinction.</p
      ><p
      >The extra complexity from defining a job for every individual step can pay off later, if those steps can be recombined with future jobs to serve later management needs. How far a process is decomposed into individual jobs is a judgement balancing maintenance requirements and the desire for job reuse.</p
      ></div
    ><div id="job-grouping"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.4.2</span
	  > Job grouping</a
	></h3
      ><p
      >Though not a requirement, it is helpful to use job groups and have a convention for naming them. A good convention assists others with a navigation scheme that helps them remember and find the desired procedure.</p
      ><p
      >The administrator chooses to create a top level group named &quot;/anvils/web/&quot; where the web restart related jobs will be organized.</p
      ><pre
      ><code
	>anvils/
`-- web/
    |-- Restart
    |-- start
    `-- stop
</code
	></pre
      ><p
      >After choosing the &quot;anvils&quot; project users will see this grouping of jobs.</p
      ><div class="figure"
      ><img src="figures/fig0604.png" alt="Anvils job group"
	 /><p class="caption"
	>Anvils job group</p
	></div
      ></div
    ></div
  ><div id="job-option"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.5</span
	> Job option</a
      ></h2
    ><p
    >To support specifying the restart method to the scripts, the the three jobs will declare an option named &quot;method&quot;. Without such a parameter, the administrator would be forced to duplicate restart Jobs for both the kill and normal stop methods.</p
    ><p
    >Another benefit from defining the job option is the ability to display a menu of choices to the user running the job. Once chosen, the value selected by the menu is then passed to the script.</p
    ><div id="allowed-values"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.5.1</span
	  > Allowed values</a
	></h3
      ><p
      >An option can be defined to only allow values from a specified list. This places safe guards on how a Job can be run by limiting choices to those the scripts can safely handle.</p
      ><p
      >The administrator takes advantage of this by limiting the &quot;method&quot; option values to just &quot;normal&quot; or &quot;kill&quot; choices.</p
      ><p
      >The screenshot below contains the Option edit form for the &quot;method&quot; option. The form includes elements to define description and default value, as well as, Allowed Values and Restrictions.</p
      ><div class="figure"
      ><img src="figures/fig0605.png" alt="Option editor for method"
	 /><p class="caption"
	>Option editor for method</p
	></div
      ><p
      >Allowed values can be specified as a comma separated list as seen above but can also be requested from an external source using a &quot;remote URL&quot;.</p
      ><p
      >Option choices can be controlled using the &quot;Enforced from values&quot; restriction. When set &quot;true&quot;, the RunDeck UI will only present a popup menu. If set &quot;false&quot;, a text field will also be presented. Use the &quot;Match Regular Expression&quot; form to validate the input option.</p
      ><p
      >Here's a screenshot of how RunDeck will display the menu choices:</p
      ><div class="figure"
      ><img src="figures/fig0606.png" alt="Option menu for method"
	 /><p class="caption"
	>Option menu for method</p
	></div
      ></div
    ><div id="script-access-to-option-data"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >7.5.2</span
	  > Script access to option data</a
	></h3
      ><p
      >Option values can be passed to scripts as an argument or referenced inside the script using a named token. For example, the value for the &quot;method&quot; option selection can be accessed in one of several ways:</p
      ><p
      >Value referenced as an environment variable:</p
      ><ul
      ><li
	>Bash: $CT_OPTION_METHOD</li
	></ul
      ><p
      >Value passed in the argument vector to the executed script or command via the <code
	>scriptargs</code
	> tag:</p
      ><ul
      ><li
	>Commandline Arguments: ${option.method}</li
	></ul
      ><p
      >Value represented as a named token inside the script and replaced before execution:</p
      ><ul
      ><li
	>Script Content: @option.method@</li
	></ul
      ></div
    ></div
  ><div id="job-workflow-composition"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.6</span
	> Job workflow composition</a
      ></h2
    ><p
    >With an understanding of the scripts and the option needed to control the restart operation, the final step is to compose the Job definitions.</p
    ><p
    >While each job can be defined graphically in RunDeck, each can succinctly be defined using an XML file comforming to the <a href="job-v20.html"
      >job-v20(5)</a
      > document format. This document contains a set of tags corresponding to the choices seen in the RunDeck GUI form.</p
    ><p
    >Below are the XML definitions for the jobs. One or more jobs can be defined inside a single XML file but your convention will dictate how to organize the definitions. The files can be named any way desired and do not have to correspond to the Job name or its group.</p
    ><p
    >File listing: stop.xml</p
    ><pre
    ><code
      >&lt;joblist&gt;   
    &lt;job&gt; 
       &lt;name&gt;stop&lt;/name&gt;  
       &lt;description&gt;the web stop procedure&lt;/description&gt;  
       &lt;loglevel&gt;INFO&lt;/loglevel&gt;  
       &lt;group&gt;anvils/web&lt;/group&gt;  
       &lt;context&gt; 
           &lt;project&gt;anvils&lt;/project&gt;  
             &lt;options&gt; 
               &lt;option name=&quot;method&quot; enforcedvalues=&quot;true&quot;
                       required=&quot;true&quot; 
                   values=&quot;normal,kill&quot;/&gt; 
               &lt;/options&gt; 
       &lt;/context&gt;  
       &lt;sequence threadcount=&quot;1&quot; keepgoing=&quot;false&quot; strategy=&quot;node-first&quot;&gt; 
         &lt;command&gt; 
           &lt;script&gt;&lt;![CDATA[#!/bin/sh
echo Web stopped with method: $1.]]&gt;&lt;/script&gt;  
            &lt;scriptargs&gt;${option.method}&lt;/scriptargs&gt; 
         &lt;/command&gt; 
       &lt;/sequence&gt;  
       &lt;nodefilters excludeprecedence=&quot;true&quot;&gt; 
         &lt;include&gt; 
          &lt;tags&gt;web&lt;/tags&gt; 
          &lt;/include&gt; 
       &lt;/nodefilters&gt;  
       &lt;dispatch&gt; 
         &lt;threadcount&gt;1&lt;/threadcount&gt;  
         &lt;keepgoing&gt;false&lt;/keepgoing&gt; 
       &lt;/dispatch&gt; 
     &lt;/job&gt;
&lt;/joblist&gt;
</code
      ></pre
    ><p
    >Defines Job, /anvils/web/stop, and executes the shell script to Nodes tagged &quot;web&quot;. Using the <code
      >scriptargs</code
      > tag, the shell script is passed a single argument, <code
      >${option.method}</code
      >, containing the value chosen in the Job run form.</p
    ><p
    >File listing: start.xml</p
    ><pre
    ><code
      >&lt;joblist&gt;   
   &lt;job&gt; 
     &lt;name&gt;start&lt;/name&gt;  
     &lt;description&gt;the web start procedure&lt;/description&gt;  
     &lt;loglevel&gt;INFO&lt;/loglevel&gt;  
     &lt;group&gt;anvils/web&lt;/group&gt;  
    &lt;context&gt; 
      &lt;project&gt;anvils&lt;/project&gt;  
        &lt;options&gt; 
         &lt;option name=&quot;method&quot; enforcedvalues=&quot;true&quot; required=&quot;true&quot; 
          values=&quot;normal,kill&quot; /&gt; 
       &lt;/options&gt; 
    &lt;/context&gt;  
    &lt;sequence threadcount=&quot;1&quot; keepgoing=&quot;false&quot; strategy=&quot;node-first&quot;&gt; 
     &lt;command&gt; 
      &lt;script&gt;&lt;![CDATA[#!/bin/sh
 echo Web started. after a $1 shutdown]]&gt;&lt;/script&gt;  
       &lt;scriptargs&gt;${option.method}&lt;/scriptargs&gt; 
     &lt;/command&gt; 
  &lt;/sequence&gt;  
    &lt;nodefilters excludeprecedence=&quot;true&quot;&gt; 
      &lt;include&gt; 
        &lt;tags&gt;web&lt;/tags&gt; 
      &lt;/include&gt; 
   &lt;/nodefilters&gt;  
   &lt;dispatch&gt; 
     &lt;threadcount&gt;1&lt;/threadcount&gt;  
     &lt;keepgoing&gt;false&lt;/keepgoing&gt; 
   &lt;/dispatch&gt; 
  &lt;/job&gt;
&lt;/joblist&gt;
</code
      ></pre
    ><p
    >Defines Job, /anvils/web/start, that also executes a shell script to Nodes tagged &quot;web&quot;. The shell script is passed a single argument, <code
      >${option.method}</code
      >, containing the value chosen in the Job run form.</p
    ><p
    >File listing: restart.xml</p
    ><pre
    ><code
      >&lt;joblist&gt;   
   &lt;job&gt; 
     &lt;name&gt;Restart&lt;/name&gt;  
     &lt;description&gt;restart the web server&lt;/description&gt;  
     &lt;loglevel&gt;INFO&lt;/loglevel&gt;  
     &lt;group&gt;anvils/web&lt;/group&gt;  
     &lt;context&gt; 
       &lt;project&gt;anvils&lt;/project&gt;  
         &lt;options&gt; 
           &lt;option name=&quot;method&quot; enforcedvalues=&quot;true&quot; required=&quot;false&quot; 
          values=&quot;normal,kill&quot; /&gt; 
        &lt;/options&gt; 
     &lt;/context&gt;  
     &lt;sequence threadcount=&quot;1&quot; keepgoing=&quot;false&quot; strategy=&quot;node-first&quot;&gt; 
      &lt;command&gt; 
        &lt;jobref name=&quot;stop&quot; group=&quot;apps/web&quot;&gt; 
          &lt;arg line=&quot;-method ${option.method}&quot;/&gt; 
        &lt;/jobref&gt; 
      &lt;/command&gt;  
      &lt;command&gt; 
        &lt;jobref name=&quot;start&quot; group=&quot;apps/web&quot;&gt; 
          &lt;arg line=&quot;-method ${option.method}&quot;/&gt; 
        &lt;/jobref&gt; 
      &lt;/command&gt; 
    &lt;/sequence&gt;  
    &lt;nodefilters excludeprecedence=&quot;true&quot;&gt; 
     &lt;include&gt; 
       &lt;tags&gt;web&lt;/tags&gt; 
     &lt;/include&gt; 
    &lt;/nodefilters&gt;  
     &lt;dispatch&gt; 
       &lt;threadcount&gt;1&lt;/threadcount&gt;  
       &lt;keepgoing&gt;true&lt;/keepgoing&gt; 
     &lt;/dispatch&gt; 
   &lt;/job&gt;   
&lt;/joblist&gt;
</code
      ></pre
    ><p
    >Defines Job, /anvils/web/Restart, that executes a sequence of Job calls, using the <code
      >jobref</code
      > tag.</p
    ><p
    >Saving the XML definitions files located on the RunDeck server, one can load them using the <a href="rd-jobs.html"
      >rd-jobs</a
      > command.</p
    ><p
    >Run the <code
      >rd-jobs load</code
      > command for each job definition file:</p
    ><pre
    ><code
      >rd-jobs load -f start.xml
rd-jobs load -f stop.xml
rd-jobs load -f restart.xml
</code
      ></pre
    ><p
    >The <code
      >rd-jobs list</code
      > command queries RunDeck and prints out the list of defined jobs:</p
    ><pre
    ><code
      >rd-jobs list
Found 3 jobs:
- Restart [9] &lt;http://strongbad:4440/scheduledExecution/show/9&gt;
- start [10] &lt;http://strongbad:4440/scheduledExecution/show/10&gt;
- stop [11] &lt;http://strongbad:4440/scheduledExecution/show/11&gt;
</code
      ></pre
    ><p
    >Of course, the jobs can be viewed inside the RunDeck graphical console by going to the Jobs page. Hovering over the &quot;Restart&quot; job name reveals job detail.</p
    ><div class="figure"
    ><img src="figures/fig0607.png" alt="Anvils restart jobs"
       /><p class="caption"
      >Anvils restart jobs</p
      ></div
    ><p
    >You will see the composition of the &quot;Restart&quot; job as a workflow calling the jobs: stop and start. The &quot;Restart&quot; job passes the <code
      >-method</code
      > option value to the lower level stop and start Jobs.</p
    ></div
  ><div id="running-the-job"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.7</span
	> Running the job</a
      ></h2
    ><p
    >The Jobs can be run from the RunDeck graphical console by going to the &quot;Jobs&quot; page. From there, navigate to the &quot;Anvils/web&quot; job group to display the three stored Jobs.</p
    ><p
    >Clicking the &quot;Run&quot; button for the Restart job, will display the options selection page. The menu for the &quot;method&quot; option dislays the two choices: &quot;normal&quot; and &quot;kill&quot;. No other choices can be made, nor a textfield for free form entry, because the &quot;method&quot; option was defined with the restriction &quot;enforced from allowed values&quot;.</p
    ><div class="figure"
    ><img src="figures/fig0608.png" alt="Restart run page"
       /><p class="caption"
      >Restart run page</p
      ></div
    ><p
    >The jobs can also be started from the command line using the <a href="run.html"
      >run</a
      > shell tool. The job group and name are specified using the &quot;-j&quot; parameter. Any options the Job supports are supplied after the &quot;--&quot; (double dash) parameter.</p
    ><p
    >Run Restart specifying the method, &quot;normal&quot;:</p
    ><pre
    ><code
      >run -j &quot;anvils/web/Restart&quot; -- -method normal
</code
      ></pre
    ><p
    >Run Restart specifying the method, &quot;kill&quot;:</p
    ><pre
    ><code
      >run -j &quot;anvils/web/Restart&quot; -- -method kill
</code
      ></pre
    ></div
  ><div id="job-access-control"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.8</span
	> Job access control</a
      ></h2
    ><p
    >Access to running or modifying Jobs is managed in an access control policy defined using the aclpolicy document format (<a href="aclpolicy-v10.html"
      >aclpolicy-v10(5)</a
      >). This file contains a number of policy elements that describe what user group is allowed to perform which actions. The <a href="#authorization"
      >Authorization</a
      > section of the Administration chapter covers this in detail.</p
    ><p
    >The administrator wants to use the aclpolicy to define two levels of access. The first level, has limited privilge and allows for just running jobs. The second level, is administrative and can modify job definitions.</p
    ><p
    >Policies can be organized into more than one file to help organize access by group or pattern of use. The normal RunDeck install will define two user groups: &quot;admin&quot; and &quot;user&quot; and have a generated a policy for the &quot;admin&quot; group.</p
    ><p
    >The Acme administrator decides to create a policy that allows users in the &quot;user&quot; group to run commands just in the &quot;anvils&quot; and &quot;anvils/web&quot; Job groups. We can employ the &quot;user&quot; login and group as it was also included in the normal install.</p
    ><p
    >To create the aclpolicy file for the &quot;user&quot; group:</p
    ><pre
    ><code
      >cp $RDECK_BASE/etc/admin.aclpolicy $RDECK_BASE/etc/user.aclpolicy
</code
      ></pre
    ><p
    >Modify the <command> and <group> elements as shown in the example below. Notice that just workflow_read,workflow_run actions are allowed.</p
    ><pre class="sourceCode xml"
    ><code
      ><span class="Normal NormalText"
	>$ cat $RDECK_BASE/etc/user.aclpolicy</span
	><br
	 /><span class="Keyword Element"
	>&lt;policies&gt;</span
	><br
	 /><span class="Normal NormalText"
	>  </span
	><span class="Keyword Element"
	>&lt;policy</span
	><span class="Others Attribute"
	> description=</span
	><span class="String Value"
	>&quot;User group access policy.&quot;</span
	><span class="Keyword Element"
	>&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;context</span
	><span class="Others Attribute"
	> project=</span
	><span class="String Value"
	>&quot;*&quot;</span
	><span class="Keyword Element"
	>&gt;</span
	><br
	 /><span class="Normal NormalText"
	>      </span
	><span class="Keyword Element"
	>&lt;command</span
	><span class="Others Attribute"
	> group=</span
	><span class="String Value"
	>&quot;anvils&quot;</span
	><span class="Others Attribute"
	> job=</span
	><span class="String Value"
	>&quot;*&quot;</span
	><span class="Others Attribute"
	> actions=</span
	><span class="String Value"
	>&quot;workflow_read,workflow_run&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>      </span
	><span class="Keyword Element"
	>&lt;command</span
	><span class="Others Attribute"
	> group=</span
	><span class="String Value"
	>&quot;anvils/web&quot;</span
	><span class="Others Attribute"
	> job=</span
	><span class="String Value"
	>&quot;*&quot;</span
	><span class="Others Attribute"
	> actions=</span
	><span class="String Value"
	>&quot;workflow_read,workflow_run&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;/context&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;by&gt;</span
	><br
	 /><span class="Normal NormalText"
	>      </span
	><span class="Keyword Element"
	>&lt;group</span
	><span class="Others Attribute"
	> name=</span
	><span class="String Value"
	>&quot;user&quot;</span
	><span class="Keyword Element"
	>/&gt;</span
	><br
	 /><span class="Normal NormalText"
	>    </span
	><span class="Keyword Element"
	>&lt;/by&gt;</span
	><br
	 /><span class="Normal NormalText"
	>  </span
	><span class="Keyword Element"
	>&lt;/policy&gt;</span
	><br
	 /><span class="Keyword Element"
	>&lt;/policies&gt;</span
	><br
	 /></code
      ></pre
    ><p
    >Restart RunDeck to load the new policy file (see <a href="#startup-and-shutdown"
      >startup and shutdown</a
      >).</p
    ><pre
    ><code
      >rundeckd restart
</code
      ></pre
    ><p
    >Once the RunDeck webapp has started, login as the &quot;user&quot; user (the password is probably &quot;user&quot;). Just the Jobs in the &quot;anvils&quot; group are displayed in the Jobs page. The &quot;user&quot; user does is not allowed to access jobs outside of &quot;/anvils group.</p
    ><p
    >Notice the absence of the &quot;New Job&quot; button that would be displayed if logged in as &quot;admin&quot;. Job creation is an action not granted to &quot;user&quot;. Notice also, that the button bar for the listed Jobs does not include icons for editing or deleting the Job. Only workflow_read and workflow_actions were allowed in the <code
      >user.aclpolicy</code
      > file.</p
    ></div
  ><div id="resource-model-provider-examples"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.9</span
	> Resource model provider examples</a
      ></h2
    ><p
    >See <a href="#resource-model-provider"
      >Chapter 9 - Resource Model Provider</a
      >.</p
    ></div
  ><div id="resource-editor-examples"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.10</span
	> Resource editor examples</a
      ></h2
    ><p
    >See <a href="#resource-editor"
      >Chapter 9 - Resource Editor</a
      >.</p
    ></div
  ><div id="option-model-provider-examples"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>7.11</span
	> Option model provider examples</a
      ></h2
    ><p
    >See <a href="#option-model-provider"
      >Chapter 9 - Option Model Provider</a
      >.</p
    ></div
  ></div
><div id="administration"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >8</span
      > Administration</a
    ></h1
  ><div id="startup-and-shutdown"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.1</span
	> Startup and shutdown</a
      ></h2
    ><p
    >RunDeck installation includes a control script used for starting and stopping the RunDeck server process. The control script provides a number of actions:</p
    ><pre
    ><code
      >rundeckd [start|stop|restart|condrestart|status]
</code
      ></pre
    ><div id="rpm"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.1.1</span
	  > RPM</a
	></h3
      ><p
      >The RPM installation includes the placement of the boot control script that will automatically start RunDeck when the system boots.</p
      ><p
      >The script is located here: <code
	>/etc/init.d/rundeckd</code
	></p
      ><p
      ><em
	>Startup</em
	></p
      ><pre
      ><code
	>/etc/init.d/rundeckd start
</code
	></pre
      ><p
      ><em
	>Shutdown</em
	></p
      ><pre
      ><code
	>/etc/initd./rundeckd stop
</code
	></pre
      ><div id="setting-java_home"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.1.1.1</span
	    > Setting JAVA_HOME</a
	  ></h4
	><p
	>When using the RPM, by default rundeck will use <em
	  >java</em
	  > found in your path. Various RPM based distributions provide ways of managing which version of java is found. CentOS uses <em
	  >/usr/sbin/alternatives</em
	  > and the processing of setting alternatives can be found here: <a href="http://wiki.centos.org/HowTos/JavaOnCentO"
	  >http://wiki.centos.org/HowTos/JavaOnCentOS</a
	  >.</p
	><p
	>If you have installed a JDK or JRE in a unique directory and do not want to alter the global system configuration, then simply setting JAVA_HOME before running any command will use the version of java found in JAVA_HOME/bin. Updating /etc/rundeck/profile with JAVA_HOME is another option as well.</p
	></div
      ></div
    ><div id="launcher"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.1.2</span
	  > Launcher</a
	></h3
      ><p
      >The Launcher installation generates the script into the RDECK_BASE directory.</p
      ><p
      >The script is located here: <code
	>$RDECK_BASE/server/sbin/rundeckd</code
	>.</p
      ><p
      ><em
	>Startup</em
	></p
      ><pre
      ><code
	>$RDECK_BASE/server/sbin/rundeckd start
</code
	></pre
      ><p
      ><em
	>Shutdown</em
	></p
      ><pre
      ><code
	>$RDECK_BASE/server/sbin/rundeckd stop
</code
	></pre
      ><p
      >You may choose to incorporate this script into your server's operating system specific boot process.</p
      ></div
    ></div
  ><div id="configuration"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.2</span
	> Configuration</a
      ></h2
    ><div id="configuration-layout"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.2.1</span
	  > Configuration layout</a
	></h3
      ><p
      >Configuration file layout differs between the RPM and Launcher installation methods. See <a href="#rpm-layout"
	>RPM layout</a
	> and <a href="#launcher-layout"
	>Launcher layout</a
	> for details.</p
      ><div id="rpm-layout"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.1.1</span
	    > RPM layout</a
	  ></h4
	><pre
	><code
	  >/etc/rundeck
|-- admin.aclpolicy
|-- framework.properties
|-- log4j.properties
|-- profile
|-- project.properties
|-- jaas-loginmodule.conf
|-- log4j.properties
|-- realm.properties
|-- rundeck-config.properties
`-- ssl
    |-- ssl.properties
    |-- keystore (not packaged)
    `-- truststore (not packaged)
</code
	  ></pre
	></div
      ><div id="launcher-layout"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.1.2</span
	    > Launcher layout</a
	  ></h4
	><pre
	><code
	  >$RDECK_BASE/etc
|-- admin.aclpolicy
|-- framework.properties
|-- log4j.properties
|-- profile
`-- project.properties
$RDECK_BASE/server/config
|-- jaas-loginmodule.conf
|-- realm.properties
`-- rundeck-config.properties
</code
	  ></pre
	></div
      ></div
    ><div id="configuration-files"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.2.2</span
	  > Configuration files</a
	></h3
      ><p
      >Configuration is specified in a number of standard RunDeck configuration files generated during the installation process.</p
      ><p
      >See the <a href="#configuration-layout"
	>Configuration layout</a
	> section for where these files reside for RPM and Launcher installations.</p
      ><p
      >The purpose of each configuration file is described in its own section.</p
      ><div id="admin.aclpolicy"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.1</span
	    > admin.aclpolicy</a
	  ></h4
	><p
	>Administrator access control policy defined with a &quot;aclpolicy(5)&quot; XML document.</p
	><p
	>This file governs the access for the &quot;admin&quot; group and role.</p
	><p
	>See <a href="#authorization"
	  >Authorization</a
	  > for information about setting up policy files for other user groups.</p
	></div
      ><div id="framework.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.2</span
	    > framework.properties</a
	  ></h4
	><p
	>Configuration used by shell tools. This file contains a number of settings used by the shell tools to interoperate with the RunDeck services.</p
	></div
      ><div id="log4j.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.3</span
	    > log4j.properties</a
	  ></h4
	><p
	>RunDeck uses <a href="http://logging.apache.org/log4j/"
	  >log4j</a
	  > as its application logging facility. This file defines the logging configuration for the RunDeck server.</p
	></div
      ><div id="profile"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.4</span
	    > profile</a
	  ></h4
	><p
	>Shell environment variables used by the shell tools. This file contains several paramaters needed during the startup of the shell tools like umask, Java home and classpath, and SSL options.</p
	></div
      ><div id="project.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.5</span
	    > project.properties</a
	  ></h4
	><p
	>RunDeck <a href="#project"
	  >project</a
	  > configuration file. One of these is generated at project setup time. There are two important settings in this file:</p
	><ul
	><li
	  ><code
	    >project.resources.file</code
	    >: Path to the project resource model document (see <a href="resources-v10.html"
	    >resources-v10(5)</a
	    >).</li
	  ><li
	  ><code
	    >project.resources.url</code
	    >: (Optional) The URL to an external <a href="#resource-model-provider"
	    >Resource Model Provider</a
	    >.</li
	  ></ul
	></div
      ><div id="jaas-loginmodule.conf"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.6</span
	    > jaas-loginmodule.conf</a
	  ></h4
	><p
	><a href="http://docs.codehaus.org/display/JETTY/JAAS"
	  >JAAS</a
	  > configuration for the RunDeck server. The listing below shows the file content for a normal RPM installation. One can see it specifies the use of the <a href="http://jetty.codehaus.org/jetty/jetty-6/apidocs/org/mortbay/jetty/plus/jaas/spi/PropertyFileLoginModule.html"
	  >PropertyFileLoginModule</a
	  >:</p
	><pre
	><code
	  >RDpropertyfilelogin {
  org.mortbay.jetty.plus.jaas.spi.PropertyFileLoginModule required
  debug=&quot;true&quot;
  file=&quot;/etc/rundeck/realm.properties&quot;;
};
</code
	  ></pre
	></div
      ><div id="realm.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.7</span
	    > realm.properties</a
	  ></h4
	><p
	>Property file user directory when PropertyFileLoginModule is used. Specified from <a href="#jaas-loginmodule.conf"
	  >jaas-loginmodule.conf</a
	  >.</p
	></div
      ><div id="rundeck-config.properties"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.2.2.8</span
	    > rundeck-config.properties</a
	  ></h4
	><p
	>The primary RunDeck webapp configuration file. Defines default loglevel, datasource configuration, <a href="#role-mapping"
	  >role mapping</a
	  >, and <a href="#customizing-rundeck-gui"
	  >GUI customization</a
	  >.</p
	></div
      ></div
    ></div
  ><div id="logs"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.3</span
	> Logs</a
      ></h2
    ><p
    >Depending on the installer used, the log files will be under a base directory:</p
    ><ul
    ><li
      >RPM: <code
	>/var/log/rundeck</code
	></li
      ><li
      >Launcher: <code
	>$RDECK_BASE/server/logs</code
	></li
      ></ul
    ><p
    >The following files will be found in the log directory:</p
    ><pre
    ><code
      > .
 |-- command.log
 |-- rundeck.audit.log
 |-- rundeck.jobs.log
 |-- rundeck.options.log
 |-- rundeck.log
 `-- service.log
</code
      ></pre
    ><p
    >Different facilities log to their own files:</p
    ><ul
    ><li
      ><code
	>command.log</code
	>: Shell tools log their activity to the command.log</li
      ><li
      ><code
	>rundeck.audit.log</code
	>: Authorization messages pertaining to aclpolicy</li
      ><li
      ><code
	>rundeck.job.log</code
	>: Log of all job definition changes</li
      ><li
      ><code
	>rundeck.options.log</code
	>: Logs remote HTTP requests for Options JSON data</li
      ><li
      ><code
	>rundeck.log</code
	>: General RunDeck application messages</li
      ><li
      ><code
	>service.log</code
	>: Standard input and output generated during runtime</li
      ></ul
    ><p
    >See the <a href="#log4j.properties"
      >#log4j.properties</a
      > section for information about customizing log message formats and location.</p
    ></div
  ><div id="backup-and-recovery"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.4</span
	> Backup and recovery</a
      ></h2
    ><p
    >RunDeck backup should only be done with the server down.</p
    ><ol style="list-style-type: decimal;"
    ><li
      ><p
	>Export the jobs</p
	><pre
	><code
	  > rd-jobs -f /path/to/backup/dir/job.xml
</code
	  ></pre
	></li
      ><li
      ><p
	>Stop the server. See: <a href="#startup-and-shtudown"
	  >startup and shutdown</a
	  ></p
	><pre
	><code
	  >rundeckd stop
</code
	  ></pre
	></li
      ><li
      ><p
	>Copy the data files. (Assumes file datastore configuration). The location of the data directory depends on the installation method:</p
	><ul
	><li
	  >RPM install: <code
	    >/var/lib/rundeck/data</code
	    ></li
	  ><li
	  ><p
	    >Launcher install: <code
	      >$RDECK_BASE/server/data</code
	      ></p
	    ><pre
	    ><code
	      > cp -r data /path/to/backup/dir
</code
	      ></pre
	    ></li
	  ></ul
	></li
      ><li
      ><p
	>Start the server</p
	><pre
	><code
	  > rundeckd start    
</code
	  ></pre
	></li
      ></ol
    ></div
  ><div id="ssh"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.5</span
	> SSH</a
      ></h2
    ><p
    >RunDeck uses <a href="http://en.wikipedia.org/wiki/Secure_Shell"
      >SSH</a
      > for remote execution. You do <em
      >not</em
      > need to have root account access on either the server or the remote hosts.</p
    ><div id="ssh-configuration-requirements"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.5.1</span
	  > SSH configuration requirements</a
	></h3
      ><ul
      ><li
	>The SSH configuration requires that the RunDeck server machine can ssh commands to the client machines.</li
	><li
	>SSH is assumed to be installed and configured appropriately to allow this access.<br
	   /></li
	><li
	>No passphrase should be set.</li
	><li
	>SSH should not prompt for a password. There are many resources available on how to configure ssh to use public key authentication instead of passwords such as: <a href="http://www.debian-administration.org/articles/152"
	  >Password-less logins with OpenSSH</a
	  > or <a href="http://www.cs.wustl.edu/~mdeters/how-to/ssh/"
	  >How-To: Password-less SSH</a
	  ></li
	></ul
      ></div
    ><div id="ssh-key-generation"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.5.2</span
	  > SSH key generation</a
	></h3
      ><ul
      ><li
	>The RunDeck installation can be configured to use RSA <em
	  >or</em
	  > DSA type keys.</li
	></ul
      ><p
      >Here's an example of SSH RSA key generation on a Linux system:</p
      ><pre
      ><code
	>$ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/home/demo/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/demo/.ssh/id_rsa.
Your public key has been saved in /home/demo/.ssh/id_rsa.pub.
The key fingerprint is:
a7:31:01:ca:f0:62:42:9d:ab:c8:b7:9c:d1:80:76:c6 demo@ubuntu
The key's randomart image is:
+--[ RSA 2048]----+
| .o . .          |
|.  * . .         |
|. = =   .        |
| = E     .       |
|+ + o   S .      |
|.o o .   =       |
|  o +   .        |
|   +             |
|                 |
+-----------------+
</code
	></pre
      ></div
    ><div id="configuring-remote-machine-for-ssh"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.5.3</span
	  > Configuring remote machine for SSH</a
	></h3
      ><p
      >To be able to directly ssh to remote machines, the SSH public key of the client should be shared to the remote machine.</p
      ><p
      >Follow the steps given below to enable ssh to remote machines.</p
      ><p
      >The ssh public key should be copied to the <code
	>authorized_keys</code
	> file of the remote machine. The public key will be available in <code
	>~/.ssh/id_rsa.pub</code
	> file.</p
      ><p
      >The <code
	>authorized_keys</code
	> file should be created in the <code
	>.ssh</code
	> directory of the remote machine.</p
      ><p
      >The file permission of the authorized key should be read/write for the user and nothing for group and others. To do this check the permission and change it as shown below.</p
      ><pre
      ><code
	>$ cd ~/.ssh
$ ls -la
-rw-r--r--   1 raj  staff     0 Nov 22 18:14 authorized_keys

$ chmod 600 authorized_keys 
$ ls -la
-rw-------   1 raj  staff     0 Nov 22 18:14 authorized_keys
</code
	></pre
      ><p
      >The permission for the .ssh directory of the remote machine should be read/write/execute for the user and nothing for the group and others. To do this, check the permission and change it as shown below.</p
      ><pre
      ><code
	>$ ls -la
drwxr-xr-x   2 raj  staff    68 Nov 22 18:19 .ssh
$ chmod 700 .ssh
$ ls -la
drwx------   2 raj  staff    68 Nov 22 18:19 .ssh
</code
	></pre
      ><p
      >If you are running RunDeck on Windows, we heartily recommend using <a href="http://www.cygwin.org"
	>Cygwin</a
	> on Windows as it includes SSH and a number of Unix-like tools that are useful when you work in a command line environment.</p
      ><div id="passing-environment-variables-through-remote-command"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.5.3.1</span
	    > Passing environment variables through remote command</a
	  ></h4
	><p
	>To pass environment variables through remote command dispatches, it is required to properly configure the SSH server on the remote end. See the <code
	  >AcceptEnv</code
	  > directive in the &quot;sshd_config(5)&quot; manual page for instructions.</p
	><p
	>Use a wild card pattern to permit <code
	  >RD_</code
	  > prefixed variables to provide open access to RunDeck generated environment variables.</p
	></div
      ></div
    ></div
  ><div id="managing-logins"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.6</span
	> Managing logins</a
      ></h2
    ><div id="realm.properties-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.6.1</span
	  > realm.properties</a
	></h3
      ><p
      >These instructions explain how to manage user credentials for RunDeck in the <code>realm.properties</code> file.</p
      ><p
      >The default RunDeck webapp handles user authentication via its container, which in turn is configured to pull its user authentication from the <code
	>$RDECK_BASE/server/config/realm.properties</code
	> file. This file is created at the time that you install the server.</p
      ><p
      >Assuming it wasn't modified, your realm.properties file will probably look something like this:</p
      ><pre
      ><code
	>#
# This file defines users passwords and roles for a HashUserRealm
#
# The format is
#  &lt;username&gt;: &lt;password&gt;[,&lt;rolename&gt; ...]
#
# Passwords may be clear text, obfuscated or checksummed.  
#
# This sets the default user accounts for the RunDeck apps
#
admin:admin,user,admin
user:user,user
</code
	></pre
      ><p
      ><em
	>Adding additional users</em
	></p
      ><p
      >You may wish to have additional users with various privileges rather than giving out role accounts to groups. You may also want to avoid having the passwords in plaintext within the configuration file.</p
      ><p
      >To accomplish this, you'll need a properly hashed or encrypted password to use in the config. On the RunDeck server, move into the directory that contains your installation and pass the username and password to the <code
	>Password</code
	> utility. In this example, we'll setup a new user named &quot;jsmith&quot;, with a password of &quot;mypass&quot;:</p
      ><pre
      ><code
	>$ cd $RDECK_BASE
$ java -cp server/lib/jetty-6.1.21.jar:server/lib/jetty-util-6.1.21.jar org.mortbay.jetty.security.Password jsmith mypass
OBF:1xfd1zt11uha1ugg1zsp1xfp
MD5:a029d0df84eb5549c641e04a9ef389e5
CRYPT:jsnDAc2Xk4W4o
</code
	></pre
      ><p
      >Then add this to the <code
	>realm.properties</code
	> file with a line like so:</p
      ><pre
      ><code
	>jsmith: MD5:a029d0df84eb5549c641e04a9ef389e5,user,admin
</code
	></pre
      ><p
      >Then restart RunDeck to ensure it picks up the change and you're done.</p
      ></div
    ><div id="ldap-and-active-directory"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.6.2</span
	  > LDAP and Active Directory</a
	></h3
      ><p
      ><em
	>note</em
	> Because the underlying security mechanism relies on JAAS, you are free to use what ever JAAS provider you feel is suitable for your environment.</p
      ><ol style="list-style-type: decimal;"
      ><li
	>Setup the LDAP login module configuration file</li
	></ol
      ><p
      >Create a <code
	>jaas-activedirectory.conf</code
	> file in the same directory as the <code
	>jaas-loginmodule.conf</code
	> file.</p
      ><ul
      ><li
	>RPM install: /etc/runduck/</li
	><li
	>Launcher install: $RDECK_BASE/server/config</li
	></ul
      ><pre
      ><code
	>activedirectory {
    com.dtolabs.rundeck.jetty.jaas.JettyCachingLdapLoginModule required
    debug=&quot;true&quot;
    contextFactory=&quot;com.sun.jndi.ldap.LdapCtxFactory&quot;
    providerUrl=&quot;ldap://localhost:389&quot;
    bindDn=&quot;cn=Manager,dc=rundeck,dc=com&quot;
    bindPassword=&quot;secret&quot;
    authenticationMethod=&quot;simple&quot;
    forceBindingLogin=&quot;true&quot;
    userBaseDn=&quot;ou=users,dc=rundeck,dc=com&quot;
    userRdnAttribute=&quot;cn&quot;
    userIdAttribute=&quot;cn&quot;
    userPasswordAttribute=&quot;unicodePwd&quot;
    userObjectClass=&quot;user&quot;
    roleBaseDn=&quot;ou=roles,dc=rundeck,dc=com&quot;
    roleNameAttribute=&quot;cn&quot;
    roleMemberAttribute=&quot;member&quot;
    roleObjectClass=&quot;group&quot;;
    cacheDurationMillis=&quot;300000&quot;
    reportStatistics=&quot;true&quot;;
    };
</code
	></pre
      ><ol start="2" style="list-style-type: decimal;"
      ><li
	><p
	  >Update the <code
	    >profile</code
	    ></p
	  ></li
	><li
	>RPM: /etc/rundeck/profile</li
	><li
	><p
	  >Launcher: $RDECK_BASE/etc/profile</p
	  ></li
	></ol
      ><p
      >Append the <code
	>RDECK_JVM</code
	> variable adding the <code
	>java.security.auth.login.config</code
	> and <code
	>loginmodule.name</code
	> properties to use the <code
	>jaas-loginmodule.conf</code
	> and <code
	>activedirectory</code
	>:</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;$RDECK_JVM -Djava.security.auth.login.config=/etc/rundeck/jaas-loginmodule.conf \
    -Dloginmodule.name=RDpropertyfilelogin \
</code
	></pre
      ><p
      >to</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;-Djava.security.auth.login.config=/etc/rundeck/jaas-activedirectory.conf \
    -Dloginmodule.name=activedirectory \
</code
	></pre
      ><ol start="3" style="list-style-type: decimal;"
      ><li
	><p
	  >Restart rundeckd</p
	  ></li
	><li
	>RPM install: <code
	  >sudo /etc/init.d/rundeckd restart</code
	  ></li
	><li
	><p
	  >Launcher install: <code
	    >$RDECK_BASE/server/sbin/rundeckd restart</code
	    ></p
	  ></li
	><li
	><p
	  >Attempt to login</p
	  ></li
	></ol
      ><p
      >If everything was configured correctly, you will be able to access RunDeck using your credentials. If something did not go smoothly, look at <code
	>/var/log/rundeck/service.log</code
	> for stack traces that may indicate what is wrong.</p
      ><div id="communicating-over-secure-ldap-ldaps:"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.6.2.1</span
	    > Communicating over secure ldap (ldaps://)</a
	  ></h4
	><p
	>The default port for communicating with active directory is 389, which is insecure. The secure port is 686, but the LoginModule describe above requires that the AD certificate or organizations CA certificate be placed in a truststore. The truststore provided with rundeck <code
	  >/etc/rundeck/ssl/truststore</code
	  > is used for the local communication between the cli tools and the rundeck server.</p
	><p
	>Before you can establish trust, you need to get the CA certificate. Typically, this would require a request to the organization's security officer to have them send you the certificate. It's also often found publicly if your organization does secure transactions.</p
	><p
	>Another option is to interogate the secure ldap endpoint with openssl. The example below shows a connection to paypal.com on port 443. The first certificate is the machine and that last is the CA. Pick the last certificate.</p
	><p
	><em
	  >note</em
	  > that for Active Directory, the host would be the Active Directory server and port 686.<br
	   /><em
	  >note</em
	  > Certificates are PEM encoded and start with -----BEGIN CERTIFICATE----- end with -----END CERTIFICATE----- inclusive.</p
	><pre
	><code
	  >$ openssl s_client -showcerts -connect paypal.com:443
CONNECTED(00000003)
depth=1 C = US, O = &quot;VeriSign, Inc.&quot;, OU = VeriSign Trust Network, OU = Terms of use at https://www.verisign.com/rpa (c)09, CN = VeriSign Class 3 Secure Server CA - G2
verify error:num=20:unable to get local issuer certificate
verify return:0
---
Certificate chain
 0 s:/C=US/ST=California/L=San Jose/O=PayPal, Inc./OU=Information Systems/CN=paypal.com
   i:/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)09/CN=VeriSign Class 3 Secure Server CA - G2
-----BEGIN CERTIFICATE-----
MIIFDjCCA/agAwIBAgIQL0NdM6l74HplIwrcygDcCTANBgkqhkiG9w0BAQUFADCB
tTELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQL
ExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTswOQYDVQQLEzJUZXJtcyBvZiB1c2Ug
YXQgaHR0cHM6Ly93d3cudmVyaXNpZ24uY29tL3JwYSAoYykwOTEvMC0GA1UEAxMm
VmVyaVNpZ24gQ2xhc3MgMyBTZWN1cmUgU2VydmVyIENBIC0gRzIwHhcNMTAwNTAz
MDAwMDAwWhcNMTIwNjExMjM1OTU5WjB/MQswCQYDVQQGEwJVUzETMBEGA1UECBMK
Q2FsaWZvcm5pYTERMA8GA1UEBxQIU2FuIEpvc2UxFTATBgNVBAoUDFBheVBhbCwg
SW5jLjEcMBoGA1UECxQTSW5mb3JtYXRpb24gU3lzdGVtczETMBEGA1UEAxQKcGF5
cGFsLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEArlvu+86iVb4RXdX+
8MjmGynNSl+Hu2/ZJ7nU1sj5O2jASWwFH7PFUv10qlRtL+gi3Rjw+zFN958iUetz
ef4CxQYf52PA7Uj9YlFEzLz7f8UDotu4WNLM3QGbLrqS28pPb2qKyyOQDvwNpI1c
Jt4JDa0ofVnCdICZEnf+cJB121MCAwEAAaOCAdEwggHNMAkGA1UdEwQCMAAwCwYD
VR0PBAQDAgWgMEUGA1UdHwQ+MDwwOqA4oDaGNGh0dHA6Ly9TVlJTZWN1cmUtRzIt
Y3JsLnZlcmlzaWduLmNvbS9TVlJTZWN1cmVHMi5jcmwwRAYDVR0gBD0wOzA5Bgtg
hkgBhvhFAQcXAzAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy52ZXJpc2lnbi5j
b20vcnBhMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAfBgNVHSMEGDAW
gBSl7wsRzsBBA6NKZZBIshzgVy19RzB2BggrBgEFBQcBAQRqMGgwJAYIKwYBBQUH
MAGGGGh0dHA6Ly9vY3NwLnZlcmlzaWduLmNvbTBABggrBgEFBQcwAoY0aHR0cDov
L1NWUlNlY3VyZS1HMi1haWEudmVyaXNpZ24uY29tL1NWUlNlY3VyZUcyLmNlcjBu
BggrBgEFBQcBDARiMGChXqBcMFowWDBWFglpbWFnZS9naWYwITAfMAcGBSsOAwIa
BBRLa7kolgYMu9BSOJsprEsHiyEFGDAmFiRodHRwOi8vbG9nby52ZXJpc2lnbi5j
b20vdnNsb2dvMS5naWYwDQYJKoZIhvcNAQEFBQADggEBADbOGDkzZy22y+fW4OR7
wkx+1E3BxnRMZYx89OOykzTEUt2UV5DVuccUbqxTxg9/4pKMYJLywYn9UIOPHpwx
fbvMQNpdqV3JSuGMTwpROrMvC3bT13aCxxDnozeCjd/lH74m6G5ef2EUd3m5Y+iC
fMPo2NMrVyQYOCtpJurh9Tre1gQFHUYAXw8ty0YxfMoR/7FwYbd4spiZJwL2Mvfn
9gn24dWuKY7JaFutomwOM78rGzBDZZ/spEx9rcNa3OuVHcqBamnnXQZlZJilj4LE
buMBx8ti5Oqy4z1u1vzA8HalseiZerqFtBGOIakXdto8qLnwYEHQvVa/ih5iTsi3
Ja8=
-----END CERTIFICATE-----
 1 s:/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)09/CN=VeriSign Class 3 Secure Server CA - G2
   i:/C=US/O=VeriSign, Inc./OU=Class 3 Public Primary Certification Authority - G2/OU=(c) 1998 VeriSign, Inc. - For authorized use only/OU=VeriSign Trust Network
-----BEGIN CERTIFICATE-----
MIIGLDCCBZWgAwIBAgIQbk/6s8XmacTRZ8mSq+hYxDANBgkqhkiG9w0BAQUFADCB
wTELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMTwwOgYDVQQL
EzNDbGFzcyAzIFB1YmxpYyBQcmltYXJ5IENlcnRpZmljYXRpb24gQXV0aG9yaXR5
IC0gRzIxOjA4BgNVBAsTMShjKSAxOTk4IFZlcmlTaWduLCBJbmMuIC0gRm9yIGF1
dGhvcml6ZWQgdXNlIG9ubHkxHzAdBgNVBAsTFlZlcmlTaWduIFRydXN0IE5ldHdv
cmswHhcNMDkwMzI1MDAwMDAwWhcNMTkwMzI0MjM1OTU5WjCBtTELMAkGA1UEBhMC
VVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQLExZWZXJpU2lnbiBU
cnVzdCBOZXR3b3JrMTswOQYDVQQLEzJUZXJtcyBvZiB1c2UgYXQgaHR0cHM6Ly93
d3cudmVyaXNpZ24uY29tL3JwYSAoYykwOTEvMC0GA1UEAxMmVmVyaVNpZ24gQ2xh
c3MgMyBTZWN1cmUgU2VydmVyIENBIC0gRzIwggEiMA0GCSqGSIb3DQEBAQUAA4IB
DwAwggEKAoIBAQDUVo9XOzcopkBj0pXVBXTatRlqltZxVy/iwDSMoJWzjOE3JPMu
7UNFBY6J1/raSrX4Po1Ox/lJUEU3QJ90qqBRVWHxYISJpZ6AjS+wIapFgsTPtBR/
RxUgKIKwaBLArlwH1/ZZzMtiVlxNSf8miKtUUTovStoOmOKJcrn892g8xB85essX
gfMMrQ/cYWIbEAsEHikYcV5iy0PevjG6cQIZTiapUdqMZGkD3pz9ff17Ybz8hHyI
XLTDe+1fK0YS8f0AAZqLW+mjBS6PLlve8xt4+GaRCMBeztWwNsrUqHugffkwer/4
3RlRKyC6/qfPoU6wZ/WAqiuDLtKOVImOHikLAgMBAAGjggKpMIICpTA0BggrBgEF
BQcBAQQoMCYwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLnZlcmlzaWduLmNvbTAS
BgNVHRMBAf8ECDAGAQH/AgEAMHAGA1UdIARpMGcwZQYLYIZIAYb4RQEHFwMwVjAo
BggrBgEFBQcCARYcaHR0cHM6Ly93d3cudmVyaXNpZ24uY29tL2NwczAqBggrBgEF
BQcCAjAeGhxodHRwczovL3d3dy52ZXJpc2lnbi5jb20vcnBhMDQGA1UdHwQtMCsw
KaAnoCWGI2h0dHA6Ly9jcmwudmVyaXNpZ24uY29tL3BjYTMtZzIuY3JsMA4GA1Ud
DwEB/wQEAwIBBjBtBggrBgEFBQcBDARhMF+hXaBbMFkwVzBVFglpbWFnZS9naWYw
ITAfMAcGBSsOAwIaBBSP5dMahqyNjmvDz4Bq1EgYLHsZLjAlFiNodHRwOi8vbG9n
by52ZXJpc2lnbi5jb20vdnNsb2dvLmdpZjApBgNVHREEIjAgpB4wHDEaMBgGA1UE
AxMRQ2xhc3MzQ0EyMDQ4LTEtNTIwHQYDVR0OBBYEFKXvCxHOwEEDo0plkEiyHOBX
LX1HMIHnBgNVHSMEgd8wgdyhgcekgcQwgcExCzAJBgNVBAYTAlVTMRcwFQYDVQQK
Ew5WZXJpU2lnbiwgSW5jLjE8MDoGA1UECxMzQ2xhc3MgMyBQdWJsaWMgUHJpbWFy
eSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAtIEcyMTowOAYDVQQLEzEoYykgMTk5
OCBWZXJpU2lnbiwgSW5jLiAtIEZvciBhdXRob3JpemVkIHVzZSBvbmx5MR8wHQYD
VQQLExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrghB92f4Hz6getxB5Z/uniTTGMA0G
CSqGSIb3DQEBBQUAA4GBAGN0Lz1Tqi+X7CYRZhr+8d5BJxnSf9jBHPniOFY6H5Cu
OcUgdav4bC1nHynCIdcUiGNLsJsnY5H48KMBJLb7j+M9AgtvVP7UzNvWhb98lR5e
YhHB2QmcQrmy1KotmDojYMyimvFu6M+O0Ro8XhnF15s1sAIjJOUFuNWI4+D6ufRf
-----END CERTIFICATE-----
---
Server certificate
subject=/C=US/ST=California/L=San Jose/O=PayPal, Inc./OU=Information Systems/CN=paypal.com
issuer=/C=US/O=VeriSign, Inc./OU=VeriSign Trust Network/OU=Terms of use at https://www.verisign.com/rpa (c)09/CN=VeriSign Class 3 Secure Server CA - G2
---
No client certificate CA names sent
---
SSL handshake has read 3039 bytes and written 401 bytes
---
New, TLSv1/SSLv3, Cipher is DES-CBC3-SHA
Server public key is 1024 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : TLSv1
    Cipher    : DES-CBC3-SHA
    Session-ID: A8AAA4F22E9A4B3F12F76303464643525178846D96CA0BC0B81F35368BF55B89
    Session-ID-ctx: 
    Master-Key: 9F767B91FC2450E291CBB21E3438CA9A73FE8D5B825AD98F821F5EB912C088DFB66FCBF2D53591E2D1ED77E9B6A22504
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    Start Time: 1295242116
    Timeout   : 300 (sec)
    Verify return code: 20 (unable to get local issuer certificate)
---
^C
</code
	  ></pre
	><p
	>Once a certificate has been obtained. There are two options for adding the certificate. The first involves updating the truststore for the JRE. If that is not possible or not desirable, then one can set the truststore to be used by the jvm, using any arbitrary truststore that contains the appropriate certificate.</p
	><p
	>Both options require importing a certificate. The following would import a certificate called, AD.cert into the <code
	  >/etc/rundeck/ssl/truststore</code
	  >.</p
	><pre
	><code
	  >keytool -import -alias CompanyAD -file AD.cert -keystore /etc/rundeck/ssl/truststore -storepass adminadmin 
</code
	  ></pre
	><p
	>To add the certificate to the JRE, locate the file $JAVA_HOME/lib/security/cacerts and run</p
	><pre
	><code
	  >keytool -import -alias CompanyAD -file AD.cert -keystore $JAVA_HOME/lib/security/cacerts -storepass changeit 
</code
	  ></pre
	><p
	>To verify your CA has been added, run keytool list and look for CompanyAD in the output.</p
	><pre
	><code
	  >keytool -list -keystore $JAVA_HOME/lib/security/cacerts -storepass changeit
</code
	  ></pre
	><p
	>Refer to: http://download.oracle.com/javase/1.5.0/docs/tooldocs/solaris/keytool.html for more information how how to import a certificate.</p
	><p
	>Finally, in your <code
	  >ldap-activedirectory.conf</code
	  > be sure to change the <em
	  >providerUrl</em
	  > to be <code
	  >ldaps://ad-server</code
	  >. Including the port is optional as the default is 686.</p
	></div
      ><div id="redundant-connection-options"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.6.2.2</span
	    > Redundant Connection Options</a
	  ></h4
	><p
	><em
	  >providerUrl</em
	  > can take multiple, space delimited, urls. For example:</p
	><pre
	><code
	  > providerUrl=ldaps://ad1 ldaps://ad2  
</code
	  ></pre
	><p
	>Use this to provide connection redundancy if a particular host is unavailable.</p
	></div
      ></div
    ></div
  ><div id="authorization-1"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.7</span
	> Authorization</a
      ></h2
    ><p
    >Three dimensions of information dictate authorization inside RunDeck:</p
    ><ul
    ><li
      ><em
	>group</em
	> memberships assigned to a <em
	>user</em
	> login.<br
	 /></li
      ><li
      >access control policy that grants access to one or more <em
	>policy action</em
	>s to a <em
	>group</em
	> or <em
	>user</em
	>.</li
      ><li
      >role mapping that ties <em
	>policy action</em
	>s to a set of user <em
	>group</em
	>s.</li
      ></ul
    ><p
    >The section on <a href="#managing-logins"
      >managing logins</a
      > discusses how to assign group memberships to users.</p
    ><p
    >The remainder of this section will describe how to use the access control policy and role mappings.</p
    ><p
    ><em
      >Note from the project team</em
      >: The authorization layer is an early work in progress. Please share your ideas on the IRC or mailing list.</p
    ><div id="access-control-policy"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.7.1</span
	  > Access control policy</a
	></h3
      ><p
      >Access to running or modifying Jobs is managed in an access control policy defined using the aclpolicy XML document (aclpolicy-v10(5)). This file contains a number of policy elements that describe what user group is allowed to perform which actions.</p
      ><p
      >Policies can be organized into more than one file to help organize access by group or pattern of use. The normal RunDeck install will have generated a policy for the &quot;admin&quot; group. Not all users will need to be given &quot;admin&quot; access level to control and modify all Jobs. More typically, a group of users will be given access to just a subset of Jobs.</p
      ><p
      >File listing: admin.aclpolicy example</p
      ><pre
      ><code
	>&lt;policies&gt;
  &lt;policy description=&quot;Administrative group that has access to
execute all actions.&quot;&gt;
    &lt;context project=&quot;*&quot;&gt;
      &lt;command group=&quot;*&quot; job=&quot;*&quot; actions=&quot;*&quot;/&gt;
    &lt;/context&gt;
    &lt;by&gt;
      &lt;group name=&quot;admin&quot;/&gt;
    &lt;/by&gt;
  &lt;/policy&gt;
&lt;/policies&gt;
</code
	></pre
      ><p
      >The example policy document above demonstrates the access granted to the users in group &quot;admin&quot;. The asterisks indicate a wild card for those attributes (eg, semantically it means &quot;ALL&quot;).</p
      ></div
    ><div id="access-control-policy-actions"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.7.2</span
	  > Access control policy actions</a
	></h3
      ><p
      >The authorization defines a number of actions that can be referenced inside the access control policy document. Reading their names, one might see these actions as a granular set of roles.</p
      ><dl
      ><dt
	><code
	  >admin</code
	  ></dt
	><dd
	>Enables the user or group &quot;super user&quot; access.</dd
	><dt
	><code
	  >user_admin</code
	  ></dt
	><dd
	>Modify user profiles.</dd
	><dt
	><code
	  >workflow_read</code
	  ></dt
	><dd
	>Read and view jobs.</dd
	><dt
	><code
	  >workflow_create</code
	  ></dt
	><dd
	>Create new jobs.</dd
	><dt
	><code
	  >workflow_update</code
	  ></dt
	><dd
	>Edit existing jo.bs</dd
	><dt
	><code
	  >workflow_delete</code
	  ></dt
	><dd
	>Remove jobs.</dd
	><dt
	><code
	  >workflow_kill</code
	  ></dt
	><dd
	>Kill running jobs.</dd
	><dt
	><code
	  >workflow_run</code
	  ></dt
	><dd
	>Execute a job.</dd
	><dt
	><code
	  >events_read</code
	  ></dt
	><dd
	>List and view history.</dd
	><dt
	><code
	  >events_create</code
	  ></dt
	><dd
	>Create new events.</dd
	><dt
	><code
	  >events_update</code
	  ></dt
	><dd
	>Modify history (unused).</dd
	><dt
	><code
	  >events_delete</code
	  ></dt
	><dd
	>Delete events (unused).</dd
	><dt
	><code
	  >resources_read</code
	  ></dt
	><dd
	>List and view resources.</dd
	><dt
	><code
	  >resources_create</code
	  ></dt
	><dd
	>Create resources (unused).</dd
	><dt
	><code
	  >resources_update</code
	  ></dt
	><dd
	>Modify resources (unused).</dd
	><dt
	><code
	  >resources_delete</code
	  ></dt
	><dd
	>Delete resources (unused).</dd
	><dt
	><code
	  >job_view_unauthorized</code
	  ></dt
	><dd
	>Special role for viewing jobs that the user is unauthorized to run.</dd
	></dl
      ><div id="access-control-policy-actions-example"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >8.7.2.1</span
	    > Access control policy actions example</a
	  ></h4
	><p
	>Below is an example policy document demonstrating wokflow policy actions to create limited job access for a group of users. Users in the group &quot;restart_user&quot; are allowed to run three jobs in the &quot;adm&quot; group: Restart, stop and start. By allowing <code
	  >workflow_run</code
	  > but not <code
	  >workflow_read</code
	  >, the &quot;stop&quot; and &quot;start&quot; jobs will not be visible in job listings in the graphical console. The &quot;Restart&quot; job will be visible since it has <code
	  >workflow_read</code
	  > granted.</p
	><p
	>File listing: restart_user.aclpolicy</p
	><pre
	><code
	  >&lt;policies&gt;
  &lt;policy description=&quot;Limited user access for adm restart actions&quot;&gt;
    &lt;context project=&quot;*&quot;&gt;
      &lt;command group=&quot;adm&quot; job=&quot;Restart&quot; actions=&quot;workflow_run,workflow_read&quot;/&gt;
      &lt;command group=&quot;adm&quot; job=&quot;stop&quot;  actions=&quot;workflow_run&quot;/&gt;
      &lt;command group=&quot;adm&quot; job=&quot;start&quot; actions=&quot;workflow_run&quot;/&gt;
    &lt;/context&gt;
    &lt;by&gt;
      &lt;group name=&quot;restart_user&quot;/&gt;
    &lt;/by&gt;
  &lt;/policy&gt;
&lt;/policies&gt;
</code
	  ></pre
	></div
      ></div
    ><div id="role-mapping"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.7.3</span
	  > Role mapping</a
	></h3
      ><p
      >Role mapping is a way of adapting the User Roles provided by your authentication system to the Application Roles used by the RunDeck web app. This lets you work with whatever authentication provider based roles you have. Role mappings are defined in the <a href="#rundeck-config.properties"
	>rundeck-config.properties</a
	> configuration file.</p
      ><dl
      ><dt
	><em
	  >Application Roles</em
	  ></dt
	><dd
	><p
	  >Role names used by the RunDeck application for testing whether the user is allowed to perform certain actions</p
	  ></dd
	><dt
	><em
	  >User Roles</em
	  ></dt
	><dd
	><p
	  >Role names used by an authencation system</p
	  ></dd
	></dl
      ><p
      >These properties provide a mapping of allowed <em
	>Application Roles</em
	> to a set of specified <em
	>User Roles</em
	>. The defaults shown here match the set of default User Roles installed in the file based login mechanism (ie, <a href="#realm.properties"
	>realm.properties</a
	> when you install RunDeck.</p
      ><p
      >If you use your own directory-based authentication (eg <a href="#active-directory"
	>Active Directory</a
	>) you may need to modify the roles you use, especially if you are unable to change the roles/groups that User profiles are assigned to in your directory.</p
      ><p
      >These are the default Application Roles that the role mapping can override:</p
      ><p
      >+-----------------------+-----------------------+ |<strong
	>Application Role</strong
	> |<strong
	>User Role</strong
	> | +-----------------------+-----------------------+ |<code
	>admin</code
	> |admin | +-----------------------+-----------------------+ |<code
	>user_admin</code
	> |admin | +-----------------------+-----------------------+ |<code
	>workflow_read</code
	> |user | +-----------------------+-----------------------+ |<code
	>workflow_create</code
	> |admin | +-----------------------+-----------------------+ |<code
	>workflow_update</code
	> |admin | +-----------------------+-----------------------+ |<code
	>workflow_kill</code
	> |user | +-----------------------+-----------------------+ |<code
	>workflow_run</code
	> |user | +-----------------------+-----------------------+ |<code
	>events_read</code
	> |user | +-----------------------+-----------------------+ |<code
	>events_create</code
	> |user | +-----------------------+-----------------------+ |<code
	>events_update</code
	> |admin | +-----------------------+-----------------------+ |<code
	>events_delete</code
	> |admin | +-----------------------+-----------------------+ |<code
	>resources_read</code
	> |user | +-----------------------+-----------------------+ |<code
	>resources_create</code
	> |admin | +-----------------------+-----------------------+ |<code
	>resources_update</code
	> |admin | +-----------------------+-----------------------+ |<code
	>resources_delete</code
	> |admin | +-----------------------+-----------------------+ |<code
	>job_view_unauthorized</code
	>|job_view_unauthorized| +-----------------------+-----------------------+</p
      ><dl
      ><dt
	>Note</dt
	><dd
	>Setting the mapping value to a comma-separated list of Role names grants that Application Role to a user in any of the mapped roles.</dd
	></dl
      ><p
      >If no role mapping is defined for an Application Role, then the literal name of the Application Role will be tested as the role name. E.g. If &quot;mappedRoles.admin&quot; is not defined, then a role named &quot;admin&quot; will be used.</p
      ><p
      >The listing below contains the role mappings that appear after a normal RunDeck installation you will find in <a href="#rundeck-config.properties"
	>rundeck-config.properties</a
	>.</p
      ><pre
      ><code
	>#
# Map rundeck actions to allowed roles
#       mappedRoles.X=A,B,C
# means allow X to users in role A, B or C
#
mappedRoles.admin=admin
mappedRoles.user_admin=admin
mappedRoles.workflow_read=user
mappedRoles.workflow_create=admin
mappedRoles.workflow_update=admin
mappedRoles.workflow_delete=admin
mappedRoles.workflow_kill=user
mappedRoles.workflow_run=user
mappedRoles.events_read=user
mappedRoles.events_create=user
mappedRoles.events_update=user
mappedRoles.events_delete=user
mappedRoles.resources_read=user
mappedRoles.resources_create=admin
mappedRoles.resources_update=admin
mappedRoles.resources_delete=admin
#special role for viewing jobs unauthorized to run
mappedRoles.job_view_unauthorized=job_view_unauthorized
</code
	></pre
      ><p
      >You can replace all of the <em
	>User Roles</em
	> shown in this file with your own custom role names from your directory service.</p
      ></div
    ><div id="troubleshooting-access-control-policy"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.7.4</span
	  > Troubleshooting access control policy</a
	></h3
      ><p
      >After defining an aclpolicy file to grant access to a particular group of users, you may find them getting &quot;unauthorized&quot; messages or complaints that certain actions are not possible.</p
      ><p
      >To diagnose this, begin by checking two bits:</p
      ><ol style="list-style-type: decimal;"
      ><li
	>The user's group membership. This can be done by going to the user's profile page in RunDeck. That page will list the groups the user is a member.</li
	><li
	>Read the messages inside the <code
	  >rundeck.audit.log</code
	  > log file. The authorization facility generates fairly low level messages describing how the policy is matched to the user context.</li
	></ol
      ><p
      >If you don't see any output in the audit log for a user's action and they are able to login, then make sure <a href="#role-mapping"
	>role mapping</a
	> is set correctly.</p
      ><p
      >Once the user role mappings are defined correctly ask the user to login again and attempt accessing their jobs. You should watch the stream of messages flowing through the audit log. For each entry, you'll see all decisions leading up to either a AUTHORIZED or a REJECTED message. It's not uncommon to see REJECTED messages followed by AUTHORIZED. The important thing is to look at the last decision made.</p
      ></div
    ><div id="authorization-caveats"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.7.5</span
	  > Authorization caveats</a
	></h3
      ><ul
      ><li
	>aclpolicy is used to determine what UI widgets are displayed (e.g., run, edit, delete, etc). But Authorization for pages still depends on Roles. (i.e. the AuthorizationFilter code looks at role membership, not aclpolicy).</li
	><li
	>role mapping changes require a server restart, while aclpolicy changes do not.</li
	><li
	>new and deleted aclpolicy files are detected after restarts</li
	></ul
      ></div
    ></div
  ><div id="configuring-rundeck-for-ssl"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.8</span
	> Configuring Rundeck for SSL</a
      ></h2
    ><p
    >This document describes how to configure Rundeck for SSL/HTTPS support, and assumes you are using the rundeck-launcher standalone launcher.</p
    ><ol style="list-style-type: decimal;"
    ><li
      ><p
	>Before beginning, do a first-run of the launcher, as it will create the base directory for Rundeck and generate configuration files.</p
	><pre
	><code
	  >cd $RDECK_BASE;  java -jar rundeck-launcher-1.1.0.jar
</code
	  ></pre
	></li
      ></ol
    ><p
    >This will start the server and generate necessary config files. Press control-c to shut down the server.</p
    ><ol start="2" style="list-style-type: decimal;"
    ><li
      ><p
	>Using the <a href="http://linux.die.net/man/1/keytool-java-1.6.0-openjdk"
	  >keytool</a
	  > command, generate a keystore for use as the server cert and client truststore. Specify passwords for key and keystore:</p
	><pre
	><code
	  >keytool -keystore etc/keystore -alias rundeck -genkey -keyalg RSA -keypass admin -storepass admin
</code
	  ></pre
	></li
      ></ol
    ><p
    >Be sure to specify the correct hostname of the server as the response to the question &quot;What is your first and last name?&quot;. Answer &quot;yes&quot; to the final question.</p
    ><p
    >You can pass all the answers to the tool on the command-line by using a HERE document.</p
    ><p
    >Replace the first line &quot;Venkman.local&quot; with the hostname for your server, and use any other organizational values you like:</p
    ><pre
    ><code
      >    keytool -keystore etc/keystore -alias rundeck -genkey -keyalg RSA -keypass adminadmin -storepass adminadmin  &lt;&lt;!
    Venkman.local
    devops
    My org
    my city
    my state
    US
    yes
    !
</code
      ></pre
    ><ol start="3" style="list-style-type: decimal;"
    ><li
      ><p
	>CLI tools that communicate to the Rundeck server need to trust the SSL certificate provided by the server. They are preconfigured to look for a truststore at the location: <code
	  >$RDECK_BASE/etc/truststore</code
	  >. Copy the keystore as the truststore for CLI tools:</p
	><pre
	><code
	  >cp etc/keystore etc/truststore
</code
	  ></pre
	></li
      ><li
      ><p
	>Modify the ssl.properties file to specify the location of the keystore and the appropriate passwords:</p
	><pre
	><code
	  >vi server/config/ssl.properties
</code
	  ></pre
	></li
      ></ol
    ><p
    >An example ssl.properties file (from the RPM package).</p
    ><pre
    ><code
      >    keystore=/etc/rundeck/ssl/keystore
    keystore.password=adminadmin
    key.password=adminadmin
    truststore=/etc/rundeck/ssl/truststore
    truststore.password=adminadmin
</code
      ></pre
    ><ol start="5" style="list-style-type: decimal;"
    ><li
      ><p
	>Configure client properties. Modify the file <code
	  >$RDECK_BASE/etc/framework.properties</code
	  > and change these properties:</p
	><ul
	><li
	  ><code
	    >framework.server.url</code
	    ></li
	  ><li
	  ><code
	    >framework.rundeck.url</code
	    ></li
	  ><li
	  ><code
	    >framework.server.port</code
	    ></li
	  ></ul
	></li
      ></ol
    ><p
    >Set them to the appropriate https protocol, and change the port to 4443, or to the value of your <code
      >-Dserver.https.port</code
      > runtime configuration property.</p
    ><ol start="6" style="list-style-type: decimal;"
    ><li
      ><p
	>Launch the rundeck launcher and tell it where to read the ssl.properties</p
	><pre
	><code
	  >java -Drundeck.ssl.config=$RDECK_BASE/server/config/ssl.properties -jar rundeck-launcher-1.1.0.jar
</code
	  ></pre
	></li
      ></ol
    ><p
    >You can change port by adding <code
      >-Dserver.https.port</code
      >:</p
    ><pre
    ><code
      >    java -Drundeck.ssl.config=$RDECK_BASE/server/config/ssl.properties -Dserver.https.port=1234 rundeck-launcher-1.1.0.jar
</code
      ></pre
    ><p
    >If successful, you will see a line indicating the SSl connector has started:</p
    ><pre
    ><code
      >Started SslSocketConnector@0.0.0.0:4443
</code
      ></pre
    ><div id="securing-passwords"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.1</span
	  > Securing passwords</a
	></h3
      ><p
      >Passwords do not have to be stored in the ssl.config. If they are not set, then the server will prompt on the console for a user to enter the passwords.</p
      ><p
      >If you want the server to start without prompting then you need to set the passwords in the config file.</p
      ><p
      >The passwords stored in ssl.properties can be obfuscated so they are not in plaintext:</p
      ><p
      >Run the jetty &quot;Password&quot; utility:</p
      ><pre
      ><code
	>$ java -cp server/lib/jetty-6.1.21.jar:server/lib/jetty-util-6.1.21.jar org.mortbay.jetty.security.Password &lt;password&gt;
</code
	></pre
      ><p
      >This will produce two lines, one starting with &quot;OBF:&quot;</p
      ><p
      >Use the entire OBF: output as the password in the ssl.properties file, eg:</p
      ><pre
      ><code
	>key.password=OBF:1lk2j1lkj321lj13lj
</code
	></pre
      ></div
    ><div id="troubleshooting-keystore"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.2</span
	  > Troubleshooting keystore</a
	></h3
      ><p
      >Some common error messages and causes:</p
      ><dl
      ><dt
	>java.io.IOException: Keystore was tampered with, or password was incorrect</dt
	><dd
	><p
	  >A password specified in the file was incorrect.</p
	  ></dd
	><dt
	>2010-12-02 10:07:29.958::WARN: failed SslSocketConnector@0.0.0.0:4443: java.io.FileNotFoundException: /Users/greg/rundeck/etc/keystore (No such file or directory)</dt
	><dd
	><p
	  >The keystore/truststore file specified in ssl.properties doesn't exist</p
	  ></dd
	></dl
      ></div
    ><div id="optional-pem-export"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.8.3</span
	  > Optional PEM export</a
	></h3
      ><p
      >You can export the PEM formatted server certificate for use by HTTPS clients (web browsers or e.g. curl).</p
      ><p
      >Export pem cacert for use by e.g. curl:</p
      ><pre
      ><code
	>keytool -export -keystore etc/keystore -rfc -alias rundeck &gt; rundeck.server.pem
</code
	></pre
      ></div
    ></div
  ><div id="customizing-rundeck-gui"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.9</span
	> Customizing RunDeck GUI</a
      ></h2
    ><p
    >You can modify some display features of the RunDeck GUI by setting these properties in the <a href="#rundeck-config.properties"
      >rundeck-config.properties</a
      > file:</p
    ><p
    >+-------------------------+-------------------------------------+--------------------+ |<strong
      >Property</strong
      > | <strong
      >Description</strong
      > |<strong
      >example</strong
      > | +-------------------------+-------------------------------------+--------------------+ |<code
      >rundeck.gui.title</code
      > |Title shown in app header |Test App | +-------------------------+-------------------------------------+--------------------+ |<code
      >rundeck.gui.logo</code
      > |Logo icon path relative to | test-logo.png | | |webapps/rundeck/images dir | | +-------------------------+-------------------------------------+--------------------+ |<code
      >rundeck.gui.logo-width</code
      > |Icon width for proper display (32px |32px | | |is best) | | +-------------------------+-------------------------------------+--------------------+ |<code
      >rundeck.gui.logo-height</code
      >|Icon height for proper display (32px |32px | | |is best) | | +-------------------------+-------------------------------------+--------------------+ |<code
      >rundeck.gui.titleLink</code
      > |URL for the link used by the app |http://rundeck.org | | |header icon. | | +-------------------------+-------------------------------------+--------------------+</p
    ></div
  ><div id="customizing-configuration-for-scale"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>8.10</span
	> Customizing configuration for scale</a
      ></h2
    ><p
    >Note: This section is early in its development.</p
    ><div id="file-descriptors"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.10.1</span
	  > File descriptors</a
	></h3
      ><p
      >The RunDeck server process opens a number of files during normal operation. These include system and java libraries, logs, and sockets. Your system restricts the number of open file handles per process but these limitations can be adjusted.</p
      ><p
      >If your installation attempts to exceed the limit, you will see an error like the one shown below in your <a href="#logs"
	>service.log</a
	> file.</p
      ><pre
      ><code
	>Too many open files 
</code
	></pre
      ><p
      ><em
	>On Linux nodes</em
	></p
      ><p
      >List the current limit with the <a href="http://ss64.com/bash/ulimit.html"
	>ulimit</a
	> command:</p
      ><pre
      ><code
	>ulimit -n
</code
	></pre
      ><p
      >If the limit is low (eg <code
	>1024</code
	>) it should be raised.</p
      ><p
      >You can get the current number of open file descriptors used by the RunDeck server process with <a href="http://linux.die.net/man/8/lsof"
	>lsof</a
	>:</p
      ><pre
      ><code
	>losf -p &lt;rundeck pid&gt; | wc -l
</code
	></pre
      ><p
      >Increase the limit for a wide margin. Edit <a href="http://ss64.com/bash/limits.conf.html"
	>/etc/security/limits.conf</a
	> file to raise the hard and soft limits. Here they are raised to <code
	>65535</code
	> for the &quot;rundeck&quot; system account:</p
      ><pre
      ><code
	>rundeck hard nofile 65535
rundeck soft nofile 65535
</code
	></pre
      ><p
      >The system file descriptor limit is set in /proc/sys/fs/file-max. The following command will increase the limit to 65535:</p
      ><pre
      ><code
	>echo 65535 &gt; /proc/sys/fs/file-max
</code
	></pre
      ><p
      >In a new shell, run the ulimit command to set the new level:</p
      ><pre
      ><code
	>ulimit -n 65535
</code
	></pre
      ><p
      >The ulimit setting can be set in the <a href="#rundeckd"
	>rundeckd</a
	> startup script, or <a href="#profile"
	>profile</a
	>.</p
      ><p
      >Restart RunDeck.</p
      ></div
    ><div id="java-heap-size"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.10.2</span
	  > Java heap size</a
	></h3
      ><p
      >The <code
	>rundeckd</code
	> startup script sets initial and maximum heap sizes for the server process. For many installations it will be sufficient.</p
      ><p
      >If the Rundeck JVM runs out of memory, the following error occurs:</p
      ><pre
      ><code
	>Exception in thread &quot;main&quot; java.lang.OutOfMemoryError: Java heap space
</code
	></pre
      ><p
      >Heap size is governed by the following startup parameters: <code
	>-Xms&lt;initial heap size&gt;</code
	> and <code
	>-Xmx&lt;maximum heap size&gt;</code
	></p
      ><p
      >You can increase these by updating the RunDeck <a href="#profile"
	>profile</a
	>. To see the current values, grep the <code
	>profile</code
	> for the Xmx and Xms patterns:</p
      ><ul
      ><li
	><p
	  >Launcher installs:</p
	  ><pre
	  ><code
	    >egrep '(Xmx|Xms)' $RDECK_BASE/etc/profile
</code
	    ></pre
	  ></li
	><li
	><p
	  >RPM installs:</p
	  ><pre
	  ><code
	    >egrep '(Xmx|Xms)' /etc/rundeck/profile
</code
	    ></pre
	  ></li
	></ul
      ><p
      >The default settings initialized by the installer sets these to 1024 megabytes maximum and 256 megabytes initial:</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;$RDECK_JVM -Xmx1024m -Xms256m&quot;
</code
	></pre
      ><p
      ><em
	>Sizing advice</em
	></p
      ><p
      >Several factors drive memory usage in RunDeck:</p
      ><ul
      ><li
	>User sessions</li
	><li
	>Concurrent threads</li
	><li
	>Concurrent jobs</li
	><li
	>Number of managed nodes</li
	></ul
      ><p
      >For example, if your installation has dozens of active users that manage a large environment (1000+ nodes), and has sufficient system memory, the following sizings might be more suitable:</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;$RDECK_JVM -Xmx4096m -Xms1024m -XX:MaxPermSize=256m&quot;
</code
	></pre
      ></div
    ><div id="quartz-job-threadcount"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.10.3</span
	  > Quartz job threadCount</a
	></h3
      ><p
      >The maximum number of threads used by RunDeck for concurrent jobs is set in the <code
	>quartz.properties</code
	> file. By default, this is set to <code
	>10</code
	>.</p
      ><ul
      ><li
	>RPM install: <code
	  >/var/lib/rundeck/server/exp/webapp/WEB-INF/classes/quartz.properties</code
	  ></li
	><li
	>Launcher install: <code
	  >$RDECK_BASE/server/exp/webapp/WEB-INF/classes/quartz.properties</code
	  ></li
	></ul
      ><p
      >To change the maximum threadCount modify this file and alter the line:</p
      ><pre
      ><code
	>org.quartz.threadPool.threadCount = 20
</code
	></pre
      ><p
      >Set the threadCount value to the max number of threads you want to run concurrently.</p
      ><p
      >Please refer to the Quartz site for detailed information: <a href="http://www.quartz-scheduler.org/docs/1.x/configuration/ConfigThreadPool.html"
	>Configuration - Thread Pool</a
	></p
      ></div
    ><div id="jmx-instrumentation"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >8.10.4</span
	  > JMX instrumentation</a
	></h3
      ><p
      >You may wish to monitor the internal operation of your RunDeck server via JMX.</p
      ><p
      >JMX provides introspection on the JVM, the application server, and classes all through a consistent interface. These various components are exposed to the management console via JMX managed beans — MBeans for short.</p
      ><p
      ><em
	>Note</em
	>: For more background information on JMX, see &quot;<a href="http://www.ibm.com/developerworks/library/j-jtp09196/"
	>Java theory and practice: Instrumenting applications with JMX.</a
	>&quot;.</p
      ><p
      >Enable local JMX monitoring by adding the <code
	>com.sun.management.jmxremote</code
	> flag to the startup parameters in the <a href="#profile"
	>profile</a
	>.</p
      ><pre
      ><code
	>export RDECK_JVM=&quot;$RDECK_JVM -Dcom.sun.management.jmxremote&quot;
</code
	></pre
      ><p
      >You use a JMX client to monitor JMX agents. This can be a desktop GUI like JConsole run locally.</p
      ><pre
      ><code
	>jconsole &lt;rundeck pid&gt;
</code
	></pre
      ><p
      >For instructions on remote JMX monitoring for Grails, Spring and log4j see: <a href="http://www.ibm.com/developerworks/java/library/j-grails12168/index.html"
	>Grails in the enterprise</a
	>.</p
      ></div
    ></div
  ></div
><div id="integration-with-external-data-providers"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >9</span
      > Integration with External Data Providers</a
    ></h1
  ><p
  >RunDeck can integrate with external data by configuring the use of <em
    >Providers</em
    >. Providers are third-party services or systems that export data that RunDeck can import. Additionally, RunDeck supports an external Editor for Node data.</p
  ><p
  >RunDeck makes use of common data formats (XML, JSON &amp; YAML). Third-party software may produce these formats natively, however it is typical to have to massage the output of one system into the appropriate format to be consumed by RunDeck. Since URLs and HTTP are a lowest-common-denominator for communication, RunDeck only requires that the data Providers make this data available as a file at a URL or on the local disk.</p
  ><p
  >There are a few types of external integration:</p
  ><dl
  ><dt
    ><a href="#resource-model-provider"
      ><em
	>Resource Model Provider</em
	></a
      ></dt
    ><dd
    ><p
      >Provides a set of Nodes in XML or YAML format. E.g. a CMDB or hosted virtual machines service. RunDeck can be configured to use a different provider for each Project, and can refresh the Resources it uses from this provider.</p
      ></dd
    ><dt
    ><a href="#resource-editor"
      ><em
	>Resource Editor</em
	></a
      ></dt
    ><dd
    ><p
      >Provides a web-based editor to manage the Node definitions. RunDeck can link to this editor from the Run page, and has optional JavaScript interactions to make editing externally-managed Node resources integrated with the RunDeck GUI.</p
      ></dd
    ><dt
    ><a href="#option-model-provider"
      ><em
	>Option Model Provider</em
	></a
      ></dt
    ><dd
    ><p
      >Provides a dataset in JSON format, used as input option values for Jobs. Each Job Option can be configured to load the set of allowed input values from a remote service, and the RunDeck GUI will prompt the user to choose from those values when running a Job.</p
      ></dd
    ></dl
  ><div id="resource-model-provider"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>9.1</span
	> Resource Model Provider</a
      ></h2
    ><p
    >The Resource model provider is a way to transfer Node definitions from other systems, tools or services into RunDeck. The means of providing the Resource model data can be done in whichever way suits your environment best.</p
    ><p
    >Resource model data is a set of Node descriptors, each with a uniquely identifying name. In addition to Name, some pieces of metadata are required (like <code
      >hostname</code
      >, and <code
      >username</code
      >), and some are optional.</p
    ><p
    >(See <a href="resource-v10.html#node"
      >resource.xml - node</a
      > and <a href="resource-yaml-v12.html"
      >resource-yaml-v12</a
      > for more information.)</p
    ><p
    >The Resource model data, commonly referred to as resources.xml or resources.yaml, is stored on the server as a file. Each Project in RunDeck has its own Resources file, and this file is used to determine what Nodes are available and how to connect to those Nodes and run commands. The Resource model data is assumed to be a static file, unless a Provider URL is configured, in which case an admin can tell the RunDeck server to refresh the Resource model from the URL.</p
    ><div id="requirements"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.1.1</span
	  > Requirements</a
	></h3
      ><p
      >In order to provide the Resource model data to RunDeck:</p
      ><ol style="list-style-type: decimal;"
      ><li
	>The data must be either:<ul
	  ><li
	    >XML in <a href="resource-v10.html"
	      >resource-v10 format</a
	      ></li
	    ><li
	    >YAML in <a href="resource-yaml-v12.html"
	      >resource-yaml-v12 format</a
	      ></li
	    ></ul
	  ></li
	><li
	>Each Node entry must have a unique <code
	  >name</code
	  > value. You may have to convert the external system's identifier to be unique, or create one yourself.</li
	><li
	>The data must be <em
	  >either</em
	  >:<ul
	  ><li
	    >accessible on-disk from the RunDeck server,</li
	    ><li
	    >OR accessible via a HTTP URL</li
	    ></ul
	  ></li
	></ol
      ><p
      >This means you can provide the data in the way that best suits your specific use-case. Some examples:</p
      ><ul
      ><li
	>Hand-crafted XML/YAML data, which you could store in a version control system. The URL for the file in the VCS repository would be provided to RunDeck.<ul
	  ><li
	    >To update the data you would commit changes to your VCS, and then tell RunDeck to refresh.</li
	    ></ul
	  ></li
	><li
	>Data generated from a custom CMDB or other software, and stored on disk.<ul
	  ><li
	    >You could do this with a cron-job, or via some external trigger. RunDeck will simply read the resource.xml/resource.yaml file identified in the configuration file.</li
	    ></ul
	  ></li
	><li
	>Data generated from a simple CGI script which interfaces with another third-party or external service.<ul
	  ><li
	    >You could run Apache and host a simple CGI script. The CGI script would communicate to some other system and then return the XML/YAML content. You could tell RunDeck to refresh the Resource model, which would in turn cause the CGI to access the external data and return the reformatted content.</li
	    ></ul
	  ></li
	></ul
      ><p
      >The Resource model data does not have to include the RunDeck server Node, as it is implicitly included.</p
      ></div
    ><div id="configuration-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.1.2</span
	  > Configuration</a
	></h3
      ><p
      >Resource model providers are defined on a per-project basis, in the <a href="#project.properties"
	><code
	  >project.properties</code
	  ></a
	> file.</p
      ><p
      >Define the file where the resource.xml will be stored on-disk. Each new project will have a good default location, but you may change it.</p
      ><pre
      ><code
	>project.resources.file = ..
</code
	></pre
      ><p
      >This file path is where RunDeck will read the contents from, and also where it will store it to if refreshing from a remote URL. If you specify a file ending in &quot;.xml&quot; then the format is <a href="resource-v10.html"
	>resource-v10 XML</a
	>. If you specify a file ending in &quot;.yaml&quot; then the format is <a href="resource-yaml-v12.html"
	>resource-yaml-v12 YAML</a
	>.</p
      ><pre
      ><code
	>project.resources.url = http://...
</code
	></pre
      ><p
      >This configures the remote URL for loading the Resources model data.</p
      ></div
    ><div id="implementations-and-examples"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.1.3</span
	  > Implementations and Examples</a
	></h3
      ><div id="simple-vcs-resource-model-provider"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >9.1.3.1</span
	    > Simple VCS resource model provider</a
	  ></h4
	><p
	>Putting the resources.xml/resources.yaml file under the control of a source code management tool is a simple solution to controlling and tracking change to the resources.xml file. Any changes will be committed and the commit messages become an audit log. Most source code management tools provide a web interface to retrieve file revisions based on a URL and thus make it accessible as a resource model provider.</p
	><p
	>Going back to the <a href="#acme-anvils"
	  >Acme Anvils Example</a
	  > section, imagine the administrator decides the VCS approach is a good first step to control versioning for the anvils resource model. Acme is a <a href="http://subversion.tigris.org/"
	  >subversion</a
	  > user and installed <a href="http://www.viewvc.org/"
	  >viewvc</a
	  > to give web access to the repository.</p
	><p
	>First, the current resources.xml is added to the repository and committed:</p
	><pre
	><code
	  >svn add resources.xml http://svn.acme.com/ops/anvils/resources.xml
svn commit -m &quot;added resource model for anvils&quot; resources.xml
</code
	  ></pre
	><p
	>To test access, the administrator downloads the latest revision (ie, &quot;HEAD&quot;) via the &quot;viewvc&quot; interface.</p
	><pre
	><code
	  > curl http://svn.acme.com/viewvc/ops/anvils/resources.xml?revision=HEAD
</code
	  ></pre
	><p
	>Next, the anvils project.properties configuration file is modified to reference the URL to retrieve the &quot;HEAD&quot; revision:</p
	><pre
	><code
	  >project.resources.file = /etc/rundeck/projects/anvils/resources.xml
project.resources.url  = http://svn.acme.com/viewvc/ops/anvils/resources.xml?revision=HEAD
</code
	  ></pre
	><p
	>This configuration specifies the anvils resource model will be retrieved from <code>project.resources.url</code> and then stored at <code>project.resources.file</code>. Now, anytime RunDeck refreshes the anvils resource model, it will request the resources.xml file from the viewvc URL, obtaining the latest revision.</p
	></div
      ><div id="amazon-ec2-nodes"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >9.1.3.2</span
	    > Amazon EC2 Nodes</a
	  ></h4
	><p
	><a href="http://aws.amazon.com/ec2/"
	  >Amazon's EC2</a
	  > (Elastic Cloud Compute) is a cloud service in wide use for dynamic infrastructure; it is easy to start up and shut down Node &quot;Instances&quot; in the cloud.</p
	><p
	>For RunDeck, we would like to have a way of querying the EC2 service to see what EC2 Instances are available for use as RunDeck Nodes.</p
	><p
	>Amazon has a well-defined API for communication with their services, which allows us to pull out the EC2 data, and generate XML.</p
	><p
	>For this purpose, DTO Labs has created a Java-based implementation of this mechanism as the <a href="https://github.com/dtolabs/java-ec2-nodes"
	  >java-ec2-nodes</a
	  > project.</p
	><ul
	><li
	  ><a href="https://github.com/dtolabs/java-ec2-nodes"
	    >java-ec2-nodes</a
	    > project source code</li
	  ><li
	  ><a href="https://github.com/dtolabs/java-ec2-nodes/archives/master"
	    >download the binary distribution</a
	    >.</li
	  ></ul
	><p
	>Use is fairly simple:</p
	><ol style="list-style-type: decimal;"
	><li
	  >Unpack the distribution file &quot;java-ec2-nodes-0.1-bin.zip&quot;. This contains the required java Libs and a Perl based CGI script.</li
	  ><li
	  ><p
	    >Create an <code
	      >AWSCredentials.properties</code
	      > to specify your AWS credentials. (Available at <a href="http://aws.amazon.com/security-credentials"
	      >this page</a
	      >.) Place the file within the expanded java-ec2-nodes directory. This file should contain:</p
	    ><pre
	    ><code
	      >accessKey=&lt;your access key&gt;
secretKey=&lt;your secret key&gt;
</code
	      ></pre
	    ></li
	  ><li
	  >Place the generatenodes.cgi file within a webroot folder of an Apache server, and configure Apache to allow <code
	    >Options +ExecCGI</code
	    > for that folder.</li
	  ><li
	  ><p
	    >Modify the &quot;$basedir&quot; variable in generatenodes.cgi to point to the dir containing the zip contents you unpacked.</p
	    ></li
	  ></ol
	><p
	>Finally, you should be able to do HTTP GET for the CGI (e.g. <code
	  >http://myserver/scripts/generatenodes.cgi</code
	  >) and see an XML file returned. Note that the CGI allows query parameters to be used as API filters, e.g. <code
	  >?tag:mytag=myvalue</code
	  >. (These filters are specific to the <a href="http://docs.amazonwebservices.com/AWSEC2/latest/APIReference/ApiReference-query-DescribeInstances.html"
	  >EC2 API</a
	  >.)</p
	><p
	>Once you have the CGI producing valid XML, you can set the <code
	  >project.resources.url</code
	  > property in your project's project.properties file to be the URl to the CGI.</p
	><p
	>Finally, within RunDeck, you can Refresh the Nodes from within the Run tab. You should see a Node entry for each EC2 Instance that is available.</p
	><p
	>You can easily manage the set of Nodes that gets returned from EC2 by organizing them by use of EC2 Tags, and applying query Filters to the EC2 API query.</p
	><p
	>In the EC2 interface, modify an Instance and add a Tag. Set the Tag name to &quot;RunDeck-Project&quot; and the value to &quot;MyProject&quot; (or your project name).</p
	><p
	>Then modify the URL used as your project.resources.url, to specify a query parameter of <code
	  >?tag:RunDeck-Project=MyProject</code
	  >. Then RunDeck will only see those Instances with that tag as Nodes within that RunDeck project.</p
	><p
	>More configuration is available for the <a href="https://github.com/dtolabs/java-ec2-nodes"
	  >java-ec2-nodes project</a
	  >.</p
	></div
      ><div id="third-party-resource-model-providers"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >9.1.3.3</span
	    > Third party resource model providers</a
	  ></h4
	><p
	>Resource model providers can be developed by third parties to integrate RunDeck with their tools.</p
	><p
	>Check the list on our wiki: <a href="https://github.com/dtolabs/rundeck/wiki/Resource-model-providers"
	  >https://github.com/dtolabs/rundeck/wiki/Resource-model-providers</a
	  >.</p
	></div
      ></div
    ></div
  ><div id="option-model-provider"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>9.2</span
	> Option model provider</a
      ></h2
    ><p
    >The Option model provider is a mechanism to allow the Options defined for a Job to have some of the possible input values provided by a remote service or database.</p
    ><p
    >Option model providers are configured on a per-Option basis (where a Job may have zero or more Options).</p
    ><div id="requirements-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.2.1</span
	  > Requirements</a
	></h3
      ><ol style="list-style-type: decimal;"
      ><li
	>Options model data must be <a href="http://www.json.org"
	  >JSON formatted</a
	  >.</li
	><li
	>It must be accessible via HTTP or on the local disk for the RunDeck server.</li
	><li
	>It must be in one of two JSON structures, <em
	  >either</em
	  >:<ul
	  ><li
	    >An array of string values</li
	    ><li
	    >OR, an array of Maps, each with two entries, <code
	      >name</code
	      > and <code
	      >value</code
	      >.</li
	    ></ul
	  ></li
	></ol
      ></div
    ><div id="configuration-2"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.2.2</span
	  > Configuration</a
	></h3
      ><p
      >Each Option entry for a Job can be configured to get the set of possible values from a remote URL. If you are authoring the Jobs via <a href="job-v20.html#option"
	>job.xml file format</a
	>, simply add a <code
	>valuesUrl</code
	> attribute for the <code
	>&lt;option&gt;</code
	>. If you are modifying the Job in the RunDeck web GUI, you can entry a URL in the &quot;Remote URL&quot; field for the Option.</p
      ><p
      >e.g.:</p
      ><pre
      ><code
	>&lt;option valuesUrl=&quot;http://site.example.com/values.json&quot; ...
</code
	></pre
      ><p
      ><em
	>Note</em
	>: File URL scheme is also acceptable (e.g, <code
	>file:/path/to/job/options/optA.json</code
	>).</p
      ><p
      >The value data must be returned in JSON data format described below.</p
      ></div
    ><div id="json-format"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.2.3</span
	  > JSON format</a
	></h3
      ><p
      >Three styles of return data are supported: simple list, simple object, and a name/value list. For a simple list, the list values will be displayed in a pop-up list when running the Job. If a simple object or name/value pairs are returned, then the <code
	>name</code
	> will be displayed in the list, but the <code
	>value</code
	> will be used as the input.</p
      ><p
      ><em
	>Examples</em
	></p
      ><p
      >Simple List:</p
      ><pre
      ><code
	>[&quot;x value for test&quot;,&quot;y value for test&quot;]
</code
	></pre
      ><p
      >This will populate the select menu with the given values.</p
      ><p
      >Simple Object:</p
      ><pre
      ><code
	>{ &quot;Name&quot;: &quot;value1&quot;, &quot;Name2&quot;:&quot;value2&quot; }
</code
	></pre
      ><p
      >This will populate the select menu to show the names and use the values.</p
      ><p
      >Name Value List:</p
      ><pre
      ><code
	>[
  {name:&quot;X Label&quot;, value:&quot;x value&quot;},
  {name:&quot;Y Label&quot;, value:&quot;y value&quot;},
  {name:&quot;A Label&quot;, value:&quot;a value&quot;}
] 
</code
	></pre
      ></div
    ><div id="variable-expansion-in-remote-urls"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.2.4</span
	  > Variable expansion in remote URLs</a
	></h3
      ><p
      >The URL declared for the &quot;valuesUrl&quot; can embed variables which will be filled with certain job context items when making the remote request. This helps make the URLs more generic and contextual to the Job.</p
      ><p
      >Two types of expansions are available, Job context, and Option context.</p
      ><p
      >To include job information in the URL, specify a variable of the form ${job.<em
	>property</em
	>}.</p
      ><p
      >Properties available for Job context:</p
      ><ul
      ><li
	><code
	  >name</code
	  >: Name of the Job</li
	><li
	><code
	  >group</code
	  >: Group of the Job</li
	><li
	><code
	  >description</code
	  >: Job description</li
	><li
	><code
	  >project</code
	  >: Project name</li
	><li
	><code
	  >argString</code
	  >: Default argument string for a job</li
	></ul
      ><p
      >To include Option information in the URL, specify a variable of the form ${option.<em
	>property</em
	>}:</p
      ><p
      >Properties available for Option context:</p
      ><ul
      ><li
	><code
	  >name</code
	  >: Name of the current option</li
	></ul
      ><p
      ><em
	>Examples</em
	></p
      ><pre
      ><code
	>http://server.com/test?name=${option.name}
</code
	></pre
      ><p
      >Passes the option name as the &quot;name&quot; query parameter to the URL.</p
      ><pre
      ><code
	>http://server.com/test?jobname=${job.name}&amp;jobgroup=${job.group}
</code
	></pre
      ><p
      >Passes the job name and group as query parameters.</p
      ></div
    ><div id="remote-request-failures"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.2.5</span
	  > Remote request failures</a
	></h3
      ><p
      >If the request for the remote option values fails, then the GUI form will display a warning message:</p
      ><div class="figure"
      ><img src="figures/fig0901.png"
	 /><p class="caption"
	></p
	></div
      ><p
      >In this case, the option will be allowed to use a textfield to set the value.</p
      ></div
    ><div id="implementations-and-examples-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.2.6</span
	  > Implementations and Examples</a
	></h3
      ><p
      >The following two sections describe examples using simple CGI scripts that act as option model providers.</p
      ><div id="hudson-artifacts-option-provider"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >9.2.6.1</span
	    > Hudson artifacts option provider</a
	  ></h4
	><p
	>An end-to-end release process often requires obtaining build artifacts and publishing them to a central repository for later distribution. A continuous integration server like <a href="http://hudson-ci.org/"
	  >Hudson</a
	  > makes identifying the build artifacts a simple Job configuration step. The <a href="http://wiki.hudson-ci.org/display/HUDSON/Remote+access+API"
	  >Hudson API</a
	  > provides a network interface to obtain the list of artifacts from successful builds via a simple HTTP GET request.</p
	><p
	>Acme builds its artifacts as RPMs and has confiugred their build job to identify them. The operations team wants to create Jobs that would allow them to choose a version of these artifacts generated by the automated build.</p
	><p
	>A simple CGI script that requests the information from Hudson and then generates a <a href="http://www.json.org/"
	  >JSON</a
	  > document is sufficient to accomplish this. The CGI script can use query paramaters to specify the Hudson server, hudson job and artifact path. Job writers can then specify the paramaterized URL to the CGI script to obtain the artifacts list as an options model and present the results as a menu to Job users.</p
	><p
	>The code listing below shows the the CGI script essentially does a call to the <a href="http://curl.haxx.se/"
	  >curl</a
	  > command to retreive the XML document containing the artifacts information and then parses it using <a href="http://xmlstar.sourceforge.net/"
	  >xmlstarlet</a
	  >.</p
	><p
	>File listing: hudson-artifacts.cgi</p
	><pre
	><code
	  >#!/bin/bash
# Requires: curl, xmlstarlet
# Returns a JSON list of key/val pairs
#
# Query Params and their defaults
hudsonUrl=https://build.acme.com:4440/job
hudsonJob=ApplicationBuild
artifactPath=/artifact/bin/dist/RPMS/noarch/

echo Content-type: application/json
echo &quot;&quot;
for VAR in `echo $QUERY_STRING | tr &quot;&amp;&quot; &quot;\t&quot;`
do
  NAME=$(echo $VAR | tr = &quot; &quot; | awk '{print $1}';);
  VALUE=$(echo $VAR | tr = &quot; &quot; | awk '{ print $2}' | tr + &quot; &quot;);
  declare $NAME=&quot;$VALUE&quot;;
done

curl -s -L -k $hudsonUrl/${hudsonJob}/api/xml?depth=1 | \
  xmlstarlet sel -t -o &quot;{&quot; \
    -t -m &quot;//build[result/text()='SUCCESS']&quot; --sort A:T:L number  \
    -m . -o &quot;&amp;quot;Release&quot; -m changeSet/item -o ' ' -v revision -b \
    -m . -o &quot;, Hudson Build &quot; -v number -o &quot;&amp;quot;:&quot; \
    -m 'artifact[position() = 1]' -o &quot;&amp;quot;&quot; -v '../number' -o $artifactPath -o &quot;{&quot; -b \
    -m 'artifact[position() != last()]' -v 'fileName' -o &quot;,&quot; -b \
    -m 'artifact[position() = last()]' -v 'fileName' -o &quot;}&amp;quot;,&quot; \
    -t -o &quot;}&quot;
</code
	  ></pre
	><p
	>After deploying this script to a CGI enabled directory on the operations web server, it can be tested directly by requesting it using <code
	  >curl</code
	  >.</p
	><pre
	><code
	  >curl -d &quot;hudsonJob=anvils&amp;artifactPath=/artifact/bin/dist/RPMS/noarch/&quot; \
    --get http://opts.acme.com/cgi/hudson-artifacts.cgi
</code
	  ></pre
	><p
	>The server response should return JSON data resembling the example below:</p
	><pre
	><code
	  >[ 
  {name:&quot;anvils-1.1.rpm&quot;, value:&quot;/artifact/bin/dist/RPMS/noarch/anvils-1.1.rpm&quot;}, 
  {name:&quot;anvils-1.2.rpm&quot;, value:&quot;/artifact/bin/dist/RPMS/noarch/anvils-1.2.rpm&quot;} 
]   
</code
	  ></pre
	><p
	>Now in place, jobs can request this option data like so:</p
	><pre
	><code
	  > &lt;option name=&quot;package&quot; enforcedvalues=&quot;true&quot; required=&quot;true&quot;
    valuesUrl=&quot;http://ops.acme.com/cgi/hudson-artifacts.cgi?hudsonJob=anvils&quot;/&gt; 
</code
	  ></pre
	><p
	>The RunDeck UI will display the package names in the menu and once selected the Job will have the path to the build artifact on the Hudson server.</p
	></div
      ><div id="yum-repoquery-option-model-provider"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >9.2.6.2</span
	    > Yum repoquery option model provider</a
	  ></h4
	><p
	><a href="http://yum.baseurl.org/"
	  >Yum</a
	  > is a great tool for automating <a href="http://www.rpm.org/"
	  >RPM</a
	  > package management. With Yum, administrators can publish packages to the repository and then use the yum client tool to automate the installation of packages along with their declared dependencies. Yum includes a command called <a href="http://linux.die.net/man/1/repoquery"
	  >repoquery</a
	  > useful for querying Yum repositories similarly to rpm queries.</p
	><p
	>Acme set up their own Yum repository to distribute application release packages. The Acme administrator wants to provide an option model to Jobs that need to know what packages provide a given capability.</p
	><p
	>The code listing below shows it is a simple wrapper around the repoquery command that formats the results as JSON data.</p
	><p
	>File listing: yum-repoquery.cgi</p
	><pre
	><code
	  >#!/bin/bash
# Requires: repoquery
# 
# Query Params and their defaults
repo=acme-staging
label=&quot;Anvils Release&quot;
package=anvils
max=30
#
echo Content-type: application/json
echo &quot;&quot;
for VAR in `echo $QUERY_STRING | tr &quot;&amp;&quot; &quot;\t&quot;`
do
  NAME=$(echo $VAR | tr = &quot; &quot; | awk '{print $1}';);
  VALUE=$(echo $VAR | tr = &quot; &quot; | awk '{ print $2}' | tr + &quot; &quot;);
  declare $NAME=&quot;$VALUE&quot;;
done

echo '{'
repoquery --enablerepo=$repo --show-dupes \
  --qf='&quot;${label} %{VERSION}-%{RELEASE}&quot;:&quot;%{NAME}-%{VERSION}-%{RELEASE}&quot;,' \
  -q --whatprovides ${package} | sort -t - -k 4,4nr | head -n${max}
echo '}'
</code
	  ></pre
	><p
	>After deploying this script to the CGI enabled directory on the operations web server, it can be tested directly by requesting it using <code
	  >curl</code
	  >.</p
	><pre
	><code
	  >curl -d &quot;repo=acme&amp;label=Anvils&amp;package=anvils&quot; \
    --get http://ops.acme.com/cgi/yum-repoquery.cgi
</code
	  ></pre
	><p
	>The server response should return JSON data resembling the example below:</p
	><pre
	><code
	  >TODO: include JSON example
</code
	  ></pre
	><p
	>Now in place, jobs can request the option model data like so:</p
	><pre
	><code
	  > &lt;option name=&quot;package&quot; enforcedvalues=&quot;true&quot; required=&quot;true&quot;
    valuesUrl=&quot;http://ops.acme.com/cgi/yum-repoquery.cgi?package=anvils&quot;/&gt; 
</code
	  ></pre
	><p
	>The RunDeck UI will display the package names in the menu and once selected, the Job will have the matching package versions.</p
	></div
      ></div
    ></div
  ><div id="resource-editor"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>9.3</span
	> Resource Editor</a
      ></h2
    ><p
    >The Resource Editor integration is a way to link to a third-party system used for managing Node definitions from within RunDeck. Each Node entry in the resources.xml or resources.yaml can define a URL to provide an &quot;Edit&quot; link that will appear in the RunDeck Run page for that Node.</p
    ><p
    >This allows you to make use of the Resource Model Provider in a more seamless way. RunDeck will load the Resource model from the third-party Provider system, and users of RunDeck can click straight to the Editor for those Nodes. The Provider and the Editor could be the same system, or they could both be custom CGI scripts that integrate with a third system.</p
    ><p
    >Some teams have acquired or developed tools to manage information about the hosts deployed in their networks. These tools have interfaces to not just view but also modify the data about these hosts. Though there is no widely used common standard adopted by users of these tools, it is possible to map the data to meet the needs of <a href="#resource-model-provider"
      >RunDeck resource models</a
      >.</p
    ><div id="definition"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.3.1</span
	  > Definition</a
	></h3
      ><p
      >The <a href="resource-v10.html"
	>RunDeck resource model document format</a
	> and the <a href="resource-yaml-v12.html"
	>resource-yaml-v12</a
	> format provide two attributes that help connect the dots between the RunDeck UI and the editing interface provided by the external data management tool. They can use <code
	>editUrl</code
	> or <code
	>remoteUrl</code
	> attributes to specify the remote URL. The URLs can embed properties about the node to expand prior to being loaded, which allows you to e.g. submit query parameters using the node name.</p
      ><dl
      ><dt
	><code
	  >editUrl</code
	  ></dt
	><dd
	><p
	  >Specifies a URL to a remote site which will allow editing of the Node. When specified, the Node resource will display an &quot;Edit&quot; link in the RunDeck GUI and clicking it will open a new browser page for the URL.</p
	  ></dd
	><dt
	><a href="#using-remoteurl"
	  ><code
	    >remoteUrl</code
	    ></a
	  ></dt
	><dd
	><p
	  >Specifies a URL for a remote site which will be loaded in an iframe within a RunDeck page. Clicking the &quot;Edit&quot; link for the Node will load content from the site within the current RunDeck page, allow you to perform your edit at the remote site, and has optional JavaScript hooks to report the state of the editing process back to the RunDeck page for a more streamlined user interface.</p
	  ></dd
	></dl
      ></div
    ><div id="using-properties"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.3.2</span
	  > Using properties</a
	></h3
      ><p
      >Properties of the Node can be embedded in the URL and expanded prior to use. The syntax is:</p
      ><pre
      ><code
	>${node.property}
</code
	></pre
      ><p
      >Available properties are:</p
      ><p
      ><code
	>name</code
	>, <code
	>hostname</code
	>, <code
	>os-name</code
	>, <code
	>os-version</code
	>, <code
	>os-family</code
	>, <code
	>os-arch</code
	>, <code
	>username</code
	>, <code
	>description</code
	>, <code
	>tags</code
	>, <code
	>type</code
	>, <code
	>project</code
	></p
      ><p
      >You can embed these properties within the url like this:</p
      ><pre
      ><code
	>http://mycmdb:8080/node/edit?name=${node.name}
</code
	></pre
      ></div
    ><div id="using-remoteurl"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.3.3</span
	  > Using remoteUrl</a
	></h3
      ><p
      >Using the <code
	>remoteUrl</code
	> lets you embed another site into an iframe within the RunDeck page, and optionally allows communication back to the RunDeck page about the state of the editing process.</p
      ><p
      >If you want to embed the remote site without having to make any changes to the remote page content, you can do so simply by specifying the <code
	>remoteUrl</code
	> to use. When the user clicks &quot;Edit&quot; the site will load within an iframe, and the user can perform whatever actions on the site are necessary. After they are done they will have to manually click the &quot;Close&quot; button on the RunDeck page to close the iframe.</p
      ><p
      >If you want the user interface in RunDeck to be more streamlined, you will have to be able to modify the web pages produced by the remote site to add simple Javascript calls to communicate back to the RunDeck page. The JavaScript hooks are designed to not add much burden to the developer of the remote site or system, so they are optional.</p
      ><div id="streamlining-the-interface"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >9.3.3.1</span
	    > Streamlining the interface</a
	  ></h4
	><p
	>If the remote site implements some Javascript messaging conforming to a simple optional protocol, then the user interface between RunDeck and the remote site can be made more seamless.</p
	><p
	>RunDeck lets the remote site inform it when the following steps occur:</p
	><ul
	><li
	  >The user begins editing a Node</li
	  ><li
	  >The user saves the Node changes successfully and is finished</li
	  ><li
	  >The user cancels the Node changes, or otherwise has finished without saving</li
	  ><li
	  >An error occurs and an error message should be shown.</li
	  ></ul
	><p
	>Due to web browser security restrictions, direct communication between different webpages can only be done through use of the <a href="http://www.whatwg.org/specs/web-apps/current-work/#crossDocumentMessages"
	  >postMessage</a
	  > method.</p
	><p
	>The remote page can send these messages simply with this javascript:</p
	><pre
	><code
	  >&lt;script type=&quot;text/javascript&quot;&gt;
    if(window.self!=window.parent){
        window.parent.postMessage(&quot;...message...&quot;,&quot;http://rundeckserver:port&quot;);
    }
&lt;/script&gt;
</code
	  ></pre
	><p
	><code
	  >window.parent</code
	  > will be the enclosing browser window when the site is loaded within an iframe. This script simply checks whether the page is loaded in an iframe before sending the message.</p
	><p
	>The first argument to <code
	  >postMessage</code
	  > is one of the message codes shown below. The second argument is the expected &quot;origin&quot;, meaning the URL scheme, server and port of the server receiving the message. You can specify &quot;*&quot; to include any site that may be loading the content, but you may want to restrict it to your RunDeck installation's scheme, hostname and port.</p
	><p
	>RunDeck can receive the following messages sent by the remote site:</p
	><dl
	><dt
	  ><code
	    >rundeck:node:edit:started</code
	    ></dt
	  ><dd
	  ><p
	    >Sent as soon as the remote edit URL is loaded and indicates that the remote Site understands the messaging protocol and has loaded the correct edit page. You would probably send this on the &quot;edit&quot; or &quot;form&quot; page for the targetted node.</p
	    ></dd
	  ><dt
	  ><code
	    >rundeck:node:edit:error</code
	    > or <code
	    >rundeck:node:edit:error:An error message</code
	    ></dt
	  ><dd
	  ><p
	    >Sent if some error occurs. The remote editing form will close and the error message (if any) will be shown. You would probably send this on the &quot;edit&quot; or &quot;view&quot; page if there is an error locating the targetted Node or loading anything required for the edit process.</p
	    ></dd
	  ></dl
	><p
	>The next two messages are only valid after the &quot;started&quot; message has already been received:</p
	><dl
	><dt
	  ><code
	    >rundeck:node:edit:finished:true</code
	    ></dt
	  ><dd
	  ><p
	    >Sent after the remote form has been saved without errors. This indicates that the editing process is done and has completed with saved changes. You would probably send this on the &quot;view&quot; or &quot;show&quot; page for the targetted node if the save operation was successful.</p
	    ></dd
	  ><dt
	  ><code
	    >rundeck:node:edit:finished:false</code
	    ></dt
	  ><dd
	  ><p
	    >Sent after the remote form has been either cancelled or discarded without changes. This indicates that the editing process is done but no changes were made. You would probably send this on the &quot;view&quot; or &quot;show&quot; for the targetted node (if your site simply shows the node view again) or &quot;list&quot; page (if your site goes back to a list of resources) if the user hits &quot;cancel&quot;.</p
	    ></dd
	  ></dl
	><p
	>Any message not shown here that is received by RunDeck after it has received the &quot;started&quot; message will be considered unexpected and the editing process will close the iframe.</p
	><p
	>The user will also have the option to close and cancel the remote editing process at any time.</p
	><p
	>Note that sending the &quot;error&quot; or &quot;finished&quot; message will close the editing session and all subsequent messages will be ignored.</p
	><p
	>TODO: The JavaScript code to communicate back to RunDeck could be bundled into a simple widget script file for easier inclusion on remote sites.</p
	></div
      ></div
    ><div id="examples"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >9.3.4</span
	  > Examples</a
	></h3
      ><p
      >Here are some examples of using the <code
	>editUrl</code
	> and <code
	>remoteUrl</code
	> in a resources.xml/resources.yaml file:</p
      ><p
      >Specify a simple URL for editing, which will simply produce a link:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; editUrl=&quot;http://mycmdb:8080/node/edit&quot; ... /&gt;
</code
	></pre
      ><p
      >Specify a URL for editing, with embedded &quot;name&quot; property as a parameter:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; editUrl=&quot;http://mycmdb:8080/node/edit?name=${node.name}&quot; ... /&gt;
</code
	></pre
      ><p
      >Specify a remote URL with embedded &quot;name&quot; and &quot;project&quot; properties as parameters:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; remoteUrl=&quot;http://mycmdb:8080/node/edit?name=${node.name}&amp;amp;project=${node.project}&quot; ... /&gt;
</code
	></pre
      ><p
      >Specify a remote URL with embedded &quot;name&quot; property as part of the path:</p
      ><pre
      ><code
	>&lt;node name=&quot;venkman&quot; remoteUrl=&quot;http://mycmdb:8080/node/edit/${node.name}&quot;  ... /&gt;
</code
	></pre
      ><p
      >In YAML, some examples:</p
      ><p
      >Specify a remote URL with embedded &quot;name&quot; and &quot;project&quot; properties as parameters:</p
      ><pre
      ><code
	>venkman:
  nodename: venkman
  remoteUrl: http://mycmdb:8080/node/edit?name=${node.name}&amp;amp;project=${node.project}
</code
	></pre
      ><p
      >Specify a remote URL with embedded &quot;name&quot; property as part of the path:</p
      ><pre
      ><code
	>venkman:
  nodename: venkman
  remoteUrl: &quot;http://mycmdb:8080/node/edit/${node.name}
</code
	></pre
      ><div id="simple-site-integration"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >9.3.4.1</span
	    > Simple site integration</a
	  ></h4
	><p
	>The <a href="https://github.com/gschueler/ndbtest"
	  >ndbtest</a
	  > project on github provides an example of how the remote Resource Editor can integrate with RunDeck using JavaScript.</p
	><p
	>This project is a simple <a href="http://grails.org"
	  >Grails</a
	  > application which provides a database of Node data. The standard web-based user flow is:</p
	><ul
	><li
	  >List all nodes.</li
	  ><li
	  >Edit a Node with the edit page. From here the User can:<ul
	    ><li
	      >Cancel the Node changes<ul
		><li
		  >Goes to the Node show page</li
		  ></ul
		></li
	      ><li
	      >Save the Node changes<ul
		><li
		  >Result is successful<ul
		    ><li
		      >Goes to the Node show page</li
		      ></ul
		    ></li
		  ><li
		  >Result fails, so display an Error message (either on the edit page or the list page)</li
		  ></ul
		></li
	      ></ul
	    ></li
	  ></ul
	><p
	>We want the Node's &quot;edit&quot; link in RunDeck to go directly to an edit page, so the <code
	  >remoteUrl</code
	  > for each Node entry then should be a URL to link to this page, for example:</p
	><pre
	><code
	  >remoteUrl=&quot;http://localhost:8080/node/edit?name=${node.name}&amp;amp;project=${node.project}&quot;
</code
	  ></pre
	><p
	>The code below shows that the <code
	  >name</code
	  > &amp; <code
	  >project</code
	  > are used to select the correct node from the database, even though the built-in identifier is an ID number:</p
	><ul
	><li
	  ><p
	    ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/controllers/com/dtolabs/ndb/NodeController.groovy#L51"
	      >NodeController.groovy:51</a
	      >.</p
	    ><ul
	    ><li
	      >Note that if there is no Node found with the specified values, then the response will be to set an error message and then show the list page.</li
	      ></ul
	    ></li
	  ></ul
	><p
	>So the JavaScript for integrating with RunDeck is then added to the following pages in this system:</p
	><ul
	><li
	  ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/edit.gsp"
	    >node/edit.gsp</a
	    ><ul
	    ><li
	      >If an error has occurred, it posts an error message starting on <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/edit.gsp#L27"
		>Line 27</a
		></li
	      ><li
	      >Otherwise, it posts the <code
		>started</code
		> message starting <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/edit.gsp#L34"
		>on line 34</a
		></li
	      ></ul
	    ></li
	  ><li
	  ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/show.gsp"
	    >node/show.gsp</a
	    ><ul
	    ><li
	      >If the node save was successful, send the <code
		>finished:true</code
		> message, starting at <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/show.gsp#L21"
		>line 21</a
		>.</li
	      ><li
	      >Otherwise send the <code
		>finished:false</code
		> message starting at <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/show.gsp#L28"
		>line 28</a
		>.</li
	      ></ul
	    ></li
	  ><li
	  ><a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/list.gsp"
	    >node/list.gsp</a
	    ><ul
	    ><li
	      >If an error has occurred, it posts an error message starting on <a href="https://github.com/gschueler/ndbtest/blob/master/grails-app/views/node/list.gsp#L20"
		>line 20</a
		>.</li
	      ></ul
	    ></li
	  ></ul
	><p
	>To complete the round-trip of editing a Node and then showing the results back in RunDeck, the ndbtest project would have to export XML formatted Resource data, and then your RunDeck project.properties file would have to point to the appropriate URL. (This is left as an exercise to the reader.)</p
	></div
      ></div
    ></div
  ></div
><div id="rundeck-api"
><h1
  ><a href="#TOC"
    ><span class="header-section-number"
      >10</span
      > RunDeck API</a
    ></h1
  ><p
  >RunDeck provides a Web API for use with your application. This describes the RunDeck API version <code
    >1</code
    >.</p
  ><div id="urls"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.1</span
	> URLs</a
      ></h2
    ><p
    >The RunDeck server has a &quot;Base URL&quot;, where you access the server. Your RunDeck Server URL may look like: <code
      >http://myserver:4440</code
      >.</p
    ><p
    >The root URL path for all calls to the API in this version is:</p
    ><pre
    ><code
      >$RUNDECK_SERVER_URL/api/1
</code
      ></pre
    ><p
    >In this document we will leave off the <code
      >$RUNDECK_SERVER_URL/api/1</code
      > and simply display URLs as <code
      >/...</code
      >.</p
    ></div
  ><div id="xml"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.2</span
	> XML</a
      ></h2
    ><p
    >The majority of API calls require XML for input and output. Some import/export features support YAML formatted documents, but XML is used for all API-level information. (JSON support is planned for a future API version.)</p
    ></div
  ><div id="authentication"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.3</span
	> Authentication</a
      ></h2
    ><p
    >Authentication is required prior to access to the API. This means that you must submit authentication parameters (username, password) to the &quot;Authentication URL&quot; and retain a Session Cookie.</p
    ><p
    >The Session Cookie must be sent with all calls to the API to maintain the authenticated connection.</p
    ><p
    >To submit authentication, submit a <code
      >POST</code
      > request to the URL:</p
    ><pre
    ><code
      >$RUNDECK_SERVER_URL/j_security_check
</code
      ></pre
    ><p
    >With these parameters:</p
    ><ul
    ><li
      ><code
	>j_username</code
	>: rundeck username</li
      ><li
      ><code
	>j_password</code
	>: password</li
      ></ul
    ><p
    >If the response includes a redirect chain which includes or results in <code
      >$RUNDECK_SERVER_URL/user/login</code
      > or <code
      >$RUNDECK_SERVER_URL/user/error</code
      >, then the authentication request failed.</p
    ><p
    >Otherwise, if the response is a redirect chain which results in <code
      >200 successful</code
      > response, then the authentication was successful.</p
    ><p
    >The response should set a cookie named <code
      >JSESSIONID</code
      >.</p
    ></div
  ><div id="api-version-number"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.4</span
	> API Version Number</a
      ></h2
    ><p
    >The API Version Number is required to be included in all API calls within the URL.</p
    ><p
    >If the version number is not included or if the requested version number is unsupported, then the API call will fail.</p
    ></div
  ><div id="response-format"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.5</span
	> Response Format</a
      ></h2
    ><p
    >The XML Response format will conform to this document structure:</p
    ><pre
    ><code
      >&lt;result success/error=&quot;true&quot;&gt;
    &lt;!-- error included if error=&quot;true&quot; --&gt;
    &lt;error&gt;
        &lt;message&gt;&lt;!-- error message text --&gt;&lt;/message&gt;
        &lt;!-- ... multiple message elements --&gt;
    &lt;/error&gt;

    &lt;!-- optional success element if declared for the endpoint --&gt;
    &lt;success&gt;
        &lt;message&gt;&lt;!-- success message --&gt;&lt;/message&gt;
    &lt;/success&gt;

    &lt;!-- 
        Specific API results..
    --&gt;
&lt;/result&gt;
</code
      ></pre
    ><p
    >If an error occurred, then the <code
      >error</code
      > attribute of the <code
      >&lt;result&gt;</code
      > element will be &quot;true&quot;. Otherwise a <code
      >success</code
      > attribute will have the value &quot;true&quot;.</p
    ><div id="item-lists"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.5.1</span
	  > Item Lists</a
	></h3
      ><p
      >Many API requests will return an item list as a result. These are typically in the form:</p
      ><pre
      ><code
	>&lt;[items] count=&quot;x&quot;&gt;
    &lt;[item] ...&gt;
    &lt;[item] ...&gt;
&lt;/[items]&gt;
</code
	></pre
      ><p
      >Where the list of specific items are wrapped in a pluralized element name which contains a <code
	>count</code
	> attribute.</p
      ><p
      >When an API path declares its results as an &quot;Item List&quot; this is the format that will be returned.</p
      ></div
    ></div
  ><div id="api-contents"
  ><h2
    ><a href="#TOC"
      ><span class="header-section-number"
	>10.6</span
	> API Contents</a
      ></h2
    ><div id="system-info"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.1</span
	  > System Info</a
	></h3
      ><p
      >Get RunDeck server information and stats.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/system/info
</code
	></pre
      ><p
      >Parameters: none</p
      ><p
      >Result: Success response, with included system info and stats in this format:</p
      ><pre
      ><code
	>&lt;system&gt;
    &lt;timestamp epoch=&quot;1305909785806&quot; unit=&quot;ms&quot;&gt;
        &lt;datetime&gt;2011-05-20T16:43:05Z&lt;/datetime&gt;
    &lt;/timestamp&gt;
    &lt;rundeck&gt;
        &lt;version&gt;1.2.1&lt;/version&gt;
        &lt;build&gt;1.2.1-0-beta&lt;/build&gt;
        &lt;node&gt;Venkman.local&lt;/node&gt;
        &lt;base&gt;/Users/greg/rundeck121&lt;/base&gt;
    &lt;/rundeck&gt;
    &lt;os&gt;
        &lt;arch&gt;x86_64&lt;/arch&gt;
        &lt;name&gt;Mac OS X&lt;/name&gt;
        &lt;version&gt;10.6.7&lt;/version&gt;
    &lt;/os&gt;
    &lt;jvm&gt;
        &lt;name&gt;Java HotSpot(TM) 64-Bit Server VM&lt;/name&gt;
        &lt;vendor&gt;Apple Inc.&lt;/vendor&gt;
        &lt;version&gt;19.1-b02-334&lt;/version&gt;
    &lt;/jvm&gt;
    &lt;stats&gt;
        &lt;uptime duration=&quot;300584&quot; unit=&quot;ms&quot;&gt;
            &lt;since epoch=&quot;1305909485222&quot; unit=&quot;ms&quot;&gt;
                &lt;datetime&gt;2011-05-20T16:38:05Z&lt;/datetime&gt;
            &lt;/since&gt;
        &lt;/uptime&gt;
        &lt;cpu&gt;
            &lt;loadAverage unit=&quot;percent&quot;&gt;0.40234375&lt;/loadAverage&gt;
            &lt;processors&gt;4&lt;/processors&gt;
        &lt;/cpu&gt;
        &lt;memory unit=&quot;byte&quot;&gt;
            &lt;max&gt;477233152&lt;/max&gt;
            &lt;free&gt;76626216&lt;/free&gt;
            &lt;total&gt;257163264&lt;/total&gt;
        &lt;/memory&gt;
        &lt;scheduler&gt;
            &lt;running&gt;0&lt;/running&gt;
        &lt;/scheduler&gt;
        &lt;threads&gt;
            &lt;active&gt;24&lt;/active&gt;
        &lt;/threads&gt;
    &lt;/stats&gt;
&lt;/system&gt;
</code
	></pre
      ><p
      >Description of included elements:</p
      ><p
      ><code
	>timestamp</code
	> describes the current system time known to the server. The <code
	>@epoch</code
	> attribute includes the milliseconds since the unix epoch.</p
      ><dl
      ><dt
	><code
	  >datetime</code
	  ></dt
	><dd
	>The W3C date and time</dd
	></dl
      ><p
      ><code
	>rundeck</code
	> includes information about the RunDeck application.</p
      ><dl
      ><dt
	><code
	  >rundeck/version</code
	  ></dt
	><dd
	><p
	  >RunDeck version</p
	  ></dd
	><dt
	><code
	  >rundeck/build</code
	  ></dt
	><dd
	><p
	  >RunDeck build stamp</p
	  ></dd
	><dt
	><code
	  >rundeck/node</code
	  ></dt
	><dd
	><p
	  >Server node name</p
	  ></dd
	><dt
	><code
	  >rundeck/base</code
	  ></dt
	><dd
	><p
	  >Server base directory</p
	  ></dd
	><dt
	><code
	  >os/arch</code
	  ></dt
	><dd
	><p
	  >Operating System architecture</p
	  ></dd
	><dt
	><code
	  >os/name</code
	  ></dt
	><dd
	><p
	  >Operating System Name</p
	  ></dd
	><dt
	><code
	  >os/version</code
	  ></dt
	><dd
	><p
	  >Operating System Version</p
	  ></dd
	><dt
	><code
	  >jvm/name</code
	  ></dt
	><dd
	><p
	  >JVM name</p
	  ></dd
	><dt
	><code
	  >jvm/vendor</code
	  ></dt
	><dd
	><p
	  >JVM vendor</p
	  ></dd
	><dt
	><code
	  >jvm/version</code
	  ></dt
	><dd
	><p
	  >JVM version</p
	  ></dd
	></dl
      ><p
      ><code
	>stats</code
	> section includes some system statistics:</p
      ><p
      ><code
	>uptime</code
	> describes the JVM uptime as duration in ms, and includes absolute startup time:</p
      ><dl
      ><dt
	><code
	  >uptime/since</code
	  ></dt
	><dd
	><p
	  >JVM startup time as time since the unix epoch</p
	  ></dd
	><dt
	><code
	  >uptime/since/datetime</code
	  ></dt
	><dd
	><p
	  >JVM startup time as W3C date time.</p
	  ></dd
	><dt
	><code
	  >cpu/loadAverage</code
	  ></dt
	><dd
	><p
	  >JVM load average percentage for the system for the previous minute (see <a href="http://download.oracle.com/javase/6/docs/api/java/lang/management/OperatingSystemMXBean.html#getSystemLoadAverage()"
	    >getSystemLoadAverage</a
	    >)</p
	  ></dd
	><dt
	><code
	  >cpu/processors</code
	  ></dt
	><dd
	><p
	  >Number of available system processors. note that loadAverage might be calculated based on the total number of available processors</p
	  ></dd
	></dl
      ><p
      >The <code
	>memory</code
	> section describes memory usage in bytes:</p
      ><dl
      ><dt
	><code
	  >max</code
	  ></dt
	><dd
	><p
	  >Maximum JVM memory that can be allocated</p
	  ></dd
	><dt
	><code
	  >free</code
	  ></dt
	><dd
	><p
	  >Free memory of the allocated memory</p
	  ></dd
	><dt
	><code
	  >total</code
	  ></dt
	><dd
	><p
	  >Total allocated memory for the JVM</p
	  ></dd
	><dt
	><code
	  >scheduler/running</code
	  ></dt
	><dd
	><p
	  >Number of running jobs in the scheduler</p
	  ></dd
	><dt
	><code
	  >threads/active</code
	  ></dt
	><dd
	><p
	  >Number of active Threads in the JVM</p
	  ></dd
	></dl
      ></div
    ><div id="listing-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.2</span
	  > Listing Jobs</a
	></h3
      ><p
      >List the jobs that exist for a project.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/jobs
</code
	></pre
      ><p
      >Required parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  >: the project name</li
	></ul
      ><p
      >The following parameters can also be used to narrow down the result set.</p
      ><ul
      ><li
	><code
	  >idlist</code
	  >: specify a comma-separated list of Job IDs to include</li
	><li
	><code
	  >groupPath</code
	  >: specify a group or partial group path to include all jobs within that group path.</li
	><li
	><code
	  >jobFilter</code
	  >: specify a filter for the job Name</li
	></ul
      ><p
      >Result: An Item List of <code
	>jobs</code
	>. Each <code
	>job</code
	> is of the form:</p
      ><pre
      ><code
	>&lt;job id=&quot;ID&quot;&gt;
    &lt;name&gt;Job Name&lt;/name&gt;
    &lt;group&gt;Job Name&lt;/group&gt;
    &lt;project&gt;Project Name&lt;/project&gt;
    &lt;description&gt;...&lt;/description&gt;
&lt;/job&gt;
</code
	></pre
      ></div
    ><div id="running-a-job-1"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.3</span
	  > Running a Job</a
	></h3
      ><p
      >Run a job specified by ID.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/job/[ID]/run
</code
	></pre
      ><p
      >Optional parameters:</p
      ><ul
      ><li
	><code
	  >argString</code
	  >: argument string to pass to the job, of the form: <code
	  >-opt value -opt2 value ...</code
	  >.</li
	><li
	>Node filter parameters as described under <a href="#using-node-filters"
	  >Using Node Filters</a
	  ></li
	></ul
      ><p
      >Result: An Item List of <code
	>executions</code
	> containing a single entry for the execution that was created. See <a href="#listing-running-executions"
	>Listing Running Executions</a
	>.</p
      ></div
    ><div id="exporting-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.4</span
	  > Exporting Jobs</a
	></h3
      ><p
      >Export the job definitions for in XML or YAML formats.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/jobs/export
</code
	></pre
      ><p
      >Required parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  ></li
	></ul
      ><p
      >Optional parameters:</p
      ><ul
      ><li
	><code
	  >format</code
	  > : can be &quot;xml&quot; or &quot;yaml&quot; to specify the output format. Default is &quot;xml&quot;</li
	></ul
      ><p
      >The following parameters can also be used to narrow down the result set.</p
      ><ul
      ><li
	><code
	  >idlist</code
	  >: specify a comma-separated list of Job IDs to export</li
	><li
	><code
	  >groupPath</code
	  >: specify a group or partial group path to include all jbos within that group path.</li
	><li
	><code
	  >jobFilter</code
	  >: specify a filter for the job Name</li
	></ul
      ><p
      >Result:</p
      ><p
      >If you specify <code
	>format=xml</code
	>, then the output will be in <a href="jobs-v20.html"
	>jobs-v20(5)</a
	> format.</p
      ><p
      >If you specify <code
	>format=yaml</code
	>, then the output will be in <a href="jobs-v20-yaml.html"
	>jobs-v20-yaml(5)</a
	> format.</p
      ><p
      >If an error occurs, then the output will be in XML format, using the common <code
	>result</code
	> element described in the <a href="#response-format"
	>Response Format</a
	> section.</p
      ></div
    ><div id="importing-jobs"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.5</span
	  > Importing Jobs</a
	></h3
      ><p
      >Import job definitions in XML or YAML formats.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/jobs/import
</code
	></pre
      ><p
      >Method: <code
	>POST</code
	></p
      ><p
      >Expected Content-Type: <code
	>application/x-www-form-urlencoded</code
	></p
      ><p
      >Required Content:</p
      ><ul
      ><li
	><code
	  >xmlBatch</code
	  >: A <code
	  >x-www-form-urlencoded</code
	  > request parameter containing the input file content.</li
	></ul
      ><p
      >Optional parameters:</p
      ><ul
      ><li
	><code
	  >format</code
	  > : can be &quot;xml&quot; or &quot;yaml&quot; to specify the output format. Default is &quot;xml&quot;</li
	><li
	><code
	  >dupeOption</code
	  >: A value to indicate the behavior when importing jobs which already exist. Value can be &quot;skip&quot;, &quot;create&quot;, or &quot;update&quot;. Default is &quot;create&quot;.</li
	></ul
      ><p
      >Result:</p
      ><p
      >A set of status results. Each imported job definition will be either &quot;succeeded&quot;, &quot;failed&quot; or &quot;skipped&quot;. These status sections contain a <code
	>count</code
	> attribute declaring how many jobs they contain. Within each one there will be 0 or more <code
	>job</code
	> elements.</p
      ><pre
      ><code
	>&lt;succeeded count=&quot;x&quot;&gt;
    &lt;!-- job elements --&gt;
&lt;/succeeded&gt;
&lt;failed count=&quot;x&quot;&gt;
    &lt;!-- job elements --&gt;
&lt;/failed&gt;
&lt;skipped count=&quot;x&quot;&gt;
    &lt;!-- job elements --&gt;
&lt;/skipped&gt;
</code
	></pre
      ><p
      >Each Job element will be of the form:</p
      ><pre
      ><code
	>&lt;job&gt;
    &lt;!-- ID may not exist if the job was not created yet --&gt;
    &lt;id&gt;ID&lt;/id&gt;
    &lt;name&gt;job name&lt;/name&gt;
    &lt;group&gt;job group&lt;/group&gt;
    &lt;project&gt;job project&lt;/project&gt;
    &lt;!--if within the failed section, then an error section will be included --&gt;
    &lt;error&gt;Error message&lt;/error&gt; 
&lt;/job&gt;
</code
	></pre
      ></div
    ><div id="getting-a-job-definition"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.6</span
	  > Getting a Job Definition</a
	></h3
      ><p
      >Export a single job definition in XML or YAML formats.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/job/[ID]
</code
	></pre
      ><p
      >Optional parameters:</p
      ><ul
      ><li
	><code
	  >format</code
	  > : can be &quot;xml&quot; or &quot;yaml&quot; to specify the output format. Default is &quot;xml&quot;</li
	></ul
      ><p
      >Result:</p
      ><p
      >If you specify <code
	>format=xml</code
	>, then the output will be in <a href="jobs-v20.html"
	>jobs-v20(5)</a
	> format.</p
      ><p
      >If you specify <code
	>format=yaml</code
	>, then the output will be in <a href="jobs-v20-yaml.html"
	>jobs-v20-yaml(5)</a
	> format.</p
      ><p
      >If an error occurs, then the output will be in XML format, using the common <code
	>result</code
	> element described in the <a href="#response-format"
	>Response Format</a
	> section.</p
      ></div
    ><div id="deleting-a-job-definition"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.7</span
	  > Deleting a Job Definition</a
	></h3
      ><p
      >Delete a single job definition.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/job/[ID]
</code
	></pre
      ><p
      >Method: <code
	>DELETE</code
	></p
      ><p
      >Result:</p
      ><p
      >The common <code
	>result</code
	> element described in the <a href="#response-format"
	>Response Format</a
	> section, indicating success or failure and any messages.</p
      ><p
      >If successful, then the <code
	>result</code
	> will contain a <code
	>success/message</code
	> element with the result message:</p
      ><pre
      ><code
	>&lt;success&gt;
&lt;message&gt;Job was successfully deleted: ... &lt;/message&gt;
&lt;/success&gt;
</code
	></pre
      ></div
    ><div id="getting-executions-for-a-job"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.8</span
	  > Getting Executions for a Job</a
	></h3
      ><p
      >Get the list of executions for a Job.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/job/[ID]/executions
</code
	></pre
      ><p
      >Optional Query Parameters:</p
      ><ul
      ><li
	><code
	  >status</code
	  >: the status of executions you want to be returned. Must be one of &quot;succeeded&quot;, &quot;failed&quot;, &quot;aborted&quot;, or &quot;running&quot;. If this parameter is blank or unset, include all executions.</li
	><li
	>Paging parameters:<ul
	  ><li
	    ><code
	      >max</code
	      >: indicate the maximum number of results to return. If unspecified, all results will be returned.</li
	    ><li
	    ><code
	      >offset</code
	      >: indicate the 0-indexed offset for the first result to return.</li
	    ></ul
	  ></li
	></ul
      ><p
      >Result: an Item List of <code
	>executions</code
	>. See <a href="#listing-running-executions"
	>Listing Running Executions</a
	>.</p
      ></div
    ><div id="listing-running-executions"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.9</span
	  > Listing Running Executions</a
	></h3
      ><p
      >List the currently running executions for a project</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/executions/running
</code
	></pre
      ><p
      >Required Parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  >: the project name</li
	></ul
      ><p
      >Result: An Item List of <code
	>executions</code
	>. Each <code
	>execution</code
	> of the form:</p
      ><pre
      ><code
	>&lt;execution id=&quot;[ID]&quot; href=&quot;[url]&quot; status=&quot;[status]&quot;&gt;
    &lt;user&gt;[user]&lt;/user&gt;
    &lt;date-started unixtime=&quot;[unixtime]&quot;&gt;[datetime]&lt;/date-started&gt;

    &lt;!-- optional job context if the execution is associated with a job --&gt;
    &lt;job id=&quot;jobID&quot;&gt;
        &lt;name&gt;..&lt;/name&gt;
        &lt;group&gt;..&lt;/group&gt;
        &lt;description&gt;..&lt;/description&gt;
    &lt;/job&gt;

    &lt;!-- description of the execution --&gt;
    &lt;description&gt;...&lt;/description&gt;

    &lt;!-- The following elements included only if the execution has ended --&gt;

    &lt;!-- the completion time of the execution --&gt;
    &lt;date-ended unixtime=&quot;[unixtime]&quot;&gt;[datetime]&lt;/date-ended&gt; 

    &lt;!-- if the execution was aborted, the username who aborted it: --&gt;
    &lt;abortedby&gt;[username]&lt;/abortedby&gt;

&lt;/execution&gt;
</code
	></pre
      ><p
      >The <code
	>[status]</code
	> value indicates the execution status. It is one of:</p
      ><ul
      ><li
	><code
	  >running</code
	  >: execution is running</li
	><li
	><code
	  >succeeded</code
	  >: execution completed successfully</li
	><li
	><code
	  >failed</code
	  >: execution completed with failure</li
	><li
	><code
	  >aborted</code
	  >: execution was aborted</li
	></ul
      ><p
      >The <code
	>[url]</code
	> value is a URL to the RunDeck server page to view the execution output.</p
      ><p
      ><code
	>[user]</code
	> is the username of the user who started the execution.</p
      ><p
      ><code
	>[unixtime]</code
	> is the millisecond unix timestamp, and <code
	>[datetime]</code
	> is a W3C dateTime string in the format &quot;yyyy-MM-ddTHH:mm:ssZ&quot;.</p
      ></div
    ><div id="getting-execution-info"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.10</span
	  > Getting Execution Info</a
	></h3
      ><p
      >Get the status for an execution by ID.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/execution/[ID]
</code
	></pre
      ><p
      >Result: an Item List of <code
	>executions</code
	> with a single item. See <a href="#listing-running-executions"
	>Listing Running Executions</a
	>.</p
      ></div
    ><div id="aborting-executions"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.11</span
	  > Aborting Executions</a
	></h3
      ><p
      >Abort a running execution by ID.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/execution/[ID]/abort
</code
	></pre
      ><p
      >Result: The result will contain a <code
	>success/message</code
	> element will contain a descriptive message. The status of the abort action will be included as an element:</p
      ><pre
      ><code
	>&lt;abort status=&quot;[abort-state]&quot;&gt;
    &lt;execution id=&quot;[id]&quot; status=&quot;[status]&quot;/&gt;
&lt;/abort&gt;
</code
	></pre
      ><p
      >The <code
	>[abort-state]</code
	> will be one of: &quot;pending&quot;, &quot;failed&quot;, or &quot;aborted&quot;.</p
      ></div
    ><div id="running-adhoc-commands"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.12</span
	  > Running Adhoc Commands</a
	></h3
      ><p
      >Run a command string.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/run/command
</code
	></pre
      ><p
      >Required Parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  >: the project name</li
	><li
	><code
	  >exec</code
	  >: the shell command string to run, e.g. &quot;echo hello&quot;.</li
	></ul
      ><p
      >Optional Parameters:</p
      ><ul
      ><li
	><code
	  >nodeThreadcount</code
	  >: threadcount to use</li
	><li
	><code
	  >nodeKeepgoing</code
	  >: if &quot;true&quot;, continue executing on other nodes even if some fail.</li
	></ul
      ><p
      >Node filter parameters as described under <a href="#using-node-filters"
	>Using Node Filters</a
	></p
      ></div
    ><div id="running-adhoc-scripts"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.13</span
	  > Running Adhoc Scripts</a
	></h3
      ><p
      >Run a script.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/run/script
</code
	></pre
      ><p
      >Method: <code
	>POST</code
	></p
      ><p
      >Expected Content-Type: <code
	>application/x-www-form-urlencoded</code
	></p
      ><p
      >Required Parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  >: the project name</li
	></ul
      ><p
      >Required Content:</p
      ><ul
      ><li
	><code
	  >scriptFile</code
	  >: A <code
	  >x-www-form-urlencoded</code
	  > request parameter containing the script file content.</li
	></ul
      ><p
      >Optional Parameters:</p
      ><ul
      ><li
	><code
	  >argString</code
	  >: Arguments to pass to the script when executed.</li
	><li
	><code
	  >nodeThreadcount</code
	  >: threadcount to use</li
	><li
	><code
	  >nodeKeepgoing</code
	  >: if &quot;true&quot;, continue executing on other nodes even if some fail.</li
	></ul
      ><p
      >Node filter parameters as described under <a href="#using-node-filters"
	>Using Node Filters</a
	></p
      ></div
    ><div id="listing-projects"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.14</span
	  > Listing Projects</a
	></h3
      ><p
      >List the existing projects on the server.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/projects
</code
	></pre
      ><p
      >Result: An Item List of <code
	>projects</code
	>, each <code
	>project</code
	> of the form specified in the <a href="#getting-project-info"
	>Getting Project Info</a
	> section.</p
      ></div
    ><div id="getting-project-info"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.15</span
	  > Getting Project Info</a
	></h3
      ><p
      >Get information about a project.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/project/NAME
</code
	></pre
      ><p
      >Result: An Item List of <code
	>projects</code
	> with one <code
	>project</code
	>. The <code
	>project</code
	> is of the form:</p
      ><pre
      ><code
	>&lt;project&gt;
    &lt;name&gt;Project Name&lt;/name&gt;
    &lt;description&gt;...&lt;/description&gt;
    &lt;!-- additional items --&gt;
&lt;/project&gt;
</code
	></pre
      ><p
      >If the project defines a Resource Model Provider URL, then the additional items are:</p
      ><pre
      ><code
	>&lt;resources&gt;
    &lt;providerURL&gt;URL&lt;/providerURL&gt;
&lt;/resources&gt;
</code
	></pre
      ></div
    ><div id="listing-history"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.16</span
	  > Listing History</a
	></h3
      ><p
      >List the event history for a project.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/history
</code
	></pre
      ><p
      >Required Parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  > : project name</li
	></ul
      ><p
      >Optional Parameters:</p
      ><ul
      ><li
	>History query parameters:<ul
	  ><li
	    ><code
	      >jobIdFilter</code
	      >: include events for a job ID.</li
	    ><li
	    ><code
	      >reportIdFilter</code
	      >: include events for an event Name.</li
	    ><li
	    ><code
	      >userFilter</code
	      >: include events created by a user</li
	    ><li
	    ><code
	      >statFilter</code
	      >: include events based on result status. this can be 'succeed','fail', or 'cancel'.</li
	    ></ul
	  ></li
	><li
	>Date query parameters:<ul
	  ><li
	    ><code
	      >recentFilter</code
	      >: Use a simple text format to filter events that occured within a period of time. The format is &quot;XY&quot; where X is an integer, and &quot;Y&quot; is one of:<ul
	      ><li
		><code
		  >h</code
		  >: hour</li
		><li
		><code
		  >d</code
		  >: day</li
		><li
		><code
		  >w</code
		  >: week</li
		><li
		><code
		  >m</code
		  >: month</li
		><li
		><code
		  >y</code
		  >: year So a value of &quot;2w&quot; would return events within the last two weeks.</li
		></ul
	      ></li
	    ><li
	    ><code
	      >begin</code
	      >: Specify exact date for earliest result.</li
	    ><li
	    ><code
	      >end</code
	      >: Specify exact date for latest result.</li
	    ></ul
	  ></li
	><li
	>Paging parameters:<ul
	  ><li
	    ><code
	      >max</code
	      >: indicate the maximum number of events to return. The default maximum to return is 20.</li
	    ><li
	    ><code
	      >offset</code
	      >: indicate the 0-indexed offset for the first event to return.</li
	    ></ul
	  ></li
	></ul
      ><p
      >The format for the <code
	>end</code
	>, and <code
	>begin</code
	> filters is either: a unix millisecond timestamp, or a W3C dateTime string in the format &quot;yyyy-MM-ddTHH:mm:ssZ&quot;.</p
      ><p
      >Result: an Item List of <code
	>events</code
	>. Each <code
	>event</code
	> has this form:</p
      ><pre
      ><code
	>&lt;event starttime=&quot;[unixtime]&quot; endtime=&quot;[unixtime]&quot;&gt;
  &lt;title&gt;[job title, or &quot;adhoc&quot;]&lt;/title&gt;
  &lt;status&gt;[status]&lt;/status&gt;
  &lt;summary&gt;[summary text]&lt;/summary&gt;
  &lt;node-summary succeeded=&quot;[X]&quot; failed=&quot;[Y]&quot; total=&quot;[Z]&quot;/&gt;
  &lt;user&gt;[user]&lt;/user&gt;
  &lt;project&gt;[project]&lt;/project&gt;
  &lt;date-started&gt;[start date]&lt;/date-started&gt;
  &lt;date-ended&gt;[end date]&lt;/date-ended&gt;
  &lt;!-- if the execution was aborted, the username who aborted it: --&gt;
  &lt;abortedby&gt;[username]&lt;/abortedby&gt;
  &lt;!-- if associated with an Execution, include the execution id: --&gt;
  &lt;execution id=&quot;[execid]&quot;/&gt;
  &lt;!-- if associated with a Job, include the Job ID: --&gt;
  &lt;job id=&quot;[jobid]&quot;/&gt;
&lt;/event&gt;
</code
	></pre
      ><p
      >The <code
	>events</code
	> element will also have <code
	>max</code
	>, <code
	>offset</code
	>, and <code
	>total</code
	> attributes, to indicate the state of paged results. E.G:</p
      ><pre
      ><code
	>&lt;events count=&quot;8&quot; total=&quot;268&quot; max=&quot;20&quot; offset=&quot;260&quot;&gt;
...
&lt;/events&gt;
</code
	></pre
      ><p
      ><code
	>total</code
	> is the total number of events matching the query parameters. <code
	>count</code
	> is the number of events included in the results. <code
	>max</code
	> is the paging size as specified in the request, or with the default value of 20. <code
	>offset</code
	> is the offset specified, or default value of 0.</p
      ></div
    ><div id="creating-history-event-reports"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.17</span
	  > Creating History Event Reports</a
	></h3
      ><p
      >Create a history event report for any external process.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/report/create
</code
	></pre
      ><p
      >Required Parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  > : project name</li
	><li
	><code
	  >status</code
	  > : report status, one of &quot;succeeded&quot;, &quot;failed&quot; or &quot;aborted&quot;</li
	><li
	><code
	  >title</code
	  > : Title of the report. This should be a short string identifying the process that was run. E.g. RunDeck jobs use the Job Group and Job Name, and adhoc commands use the string &quot;adhoc&quot;.</li
	><li
	><code
	  >summary</code
	  > : A descriptive summary of the result.</li
	><li
	><code
	  >nodesuccesscount</code
	  >: number of successful nodes: how many nodes the process succeeded on.</li
	><li
	><code
	  >nodefailedcount</code
	  >: number of failed nodes: how many nodes the process failed on.</li
	></ul
      ><p
      >Optional Parameters:</p
      ><ul
      ><li
	><code
	  >start</code
	  >: Specify exact date for beginning of the process (defaults to the same as end).</li
	><li
	><code
	  >end</code
	  >: Specify exact date for end of the process (defaults to time the report is received).</li
	><li
	><code
	  >script</code
	  >: Full adhoc command or script that was run, if applicable.</li
	><li
	><code
	  >jobID</code
	  >: Any associated RunDeck Job ID</li
	><li
	><code
	  >execID</code
	  >: Any associated RunDeck Execution ID.</li
	></ul
      ><p
      >The format for the <code
	>end</code
	>, and <code
	>start</code
	> values is either: a unix millisecond timestamp, or a W3C dateTime string in the format &quot;yyyy-MM-ddTHH:mm:ssZ&quot;.</p
      ></div
    ><div id="listing-resources"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.18</span
	  > Listing Resources</a
	></h3
      ><p
      >List or query the resources for a project.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/resources
</code
	></pre
      ><p
      >Required Parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  > : project name</li
	></ul
      ><p
      >Optional Parameters:</p
      ><ul
      ><li
	><p
	  ><code
	    >format</code
	    > : Result format. One of &quot;xml&quot; or &quot;yaml&quot;. Default is &quot;xml&quot;.</p
	  ></li
	><li
	><p
	  >Node Filter parameters: You can select resources to include and exclude in the result set, see <a href="#using-node-filters"
	    >Using Node Filters</a
	    > below.</p
	  ></li
	></ul
      ><p
      ><strong
	>Note:</strong
	> If no query parameters are included, the result set will include all Node resources for the project.</p
      ><p
      >Result: Depending on the <code
	>format</code
	> parameter, a value of &quot;xml&quot; will return <a href="resources-v10.html"
	>resources-v10(5)</a
	> and &quot;yaml&quot; will return <a href="resources-v10-yaml.html"
	>resources-v10-yaml(5)</a
	> formatted results.</p
      ><div id="using-node-filters"
      ><h4
	><a href="#TOC"
	  ><span class="header-section-number"
	    >10.6.18.1</span
	    > Using Node Filters</a
	  ></h4
	><p
	>To include certain resources, specify the inclusion filters:</p
	><ul
	><li
	  ><code
	    >hostname</code
	    >, <code
	    >tags</code
	    >, <code
	    >os-[name,family,arch,version]</code
	    >, <code
	    >name</code
	    ></li
	  ></ul
	><p
	>To exclude certain resources, specify the exclusion filters as above but with <code
	  >exclude-</code
	  > prepended:</p
	><ul
	><li
	  ><code
	    >exclude-hostname</code
	    >, <code
	    >exclude-tags</code
	    >, etc..</li
	  ></ul
	><p
	>To specify which type of filter (inclusion or exclusion) takes precedence, specify:</p
	><ul
	><li
	  ><code
	    >exclude-precedence</code
	    > : Whether exclusion filters take precedence. &quot;true&quot;/&quot;false&quot; (default is &quot;true&quot;).</li
	  ></ul
	><p
	>If using only inclusion filters, the result set will be only those resources which <em
	  >do</em
	  > match the filters.</p
	><p
	>If using only exclusion filters, the result set will be only those resources which <em
	  >do not</em
	  > match the filters.</p
	><p
	>When using both types of filters, the result will depend on the <code
	  >exclude-precedence</code
	  > value (default true).</p
	><ul
	><li
	  >When <code
	    >exclude-precedence</code
	    > is true:<ol style="list-style-type: decimal;"
	    ><li
	      >First select the resources which <em
		>do not</em
		> match the <strong
		>exclusion</strong
		> filters.</li
	      ><li
	      >Then select from those the resources which <em
		>do</em
		> match the <strong
		>inclusion</strong
		> filters.</li
	      ></ol
	    ></li
	  ><li
	  >When <code
	    >exclude-precedence</code
	    > is false:<ol style="list-style-type: decimal;"
	    ><li
	      >First select all resources.</li
	      ><li
	      >Then remove the resources which <em
		>do not</em
		> match the <strong
		>exclusion</strong
		> filters.</li
	      ><li
	      >Then add the resources which <em
		>do</em
		> match the <strong
		>inclusion</strong
		> filters.</li
	      ></ol
	    ></li
	  ></ul
	><p
	>The difference between these results is apparent when you have resources which are matched by both the exclusion and the inclusion filters. The precedence determines whether those resources are included or not.</p
	><p
	>Using set logic, if &quot;A&quot; is the set of all resources, &quot;X&quot; is the set of all resources matching the exclusion filters, and &quot;I&quot; is the set of all resources matching the inclusion filters, then:</p
	><ul
	><li
	  >when <code
	    >exclude-precedence=true</code
	    > then the result is:<ul
	    ><li
	      ><span class="math"
		>(<em
		  >A</em
		  >-<em
		  >X</em
		  >) ∩ <em
		  >I</em
		  ></span
		></li
	      ><li
	      >which is also <span class="math"
		><em
		  >I</em
		  >-<em
		  >X</em
		  ></span
		></li
	      ></ul
	    ></li
	  ><li
	  >when <code
	    >exclude-precedence=false</code
	    > then the result is:<ul
	    ><li
	      ><span class="math"
		>(<em
		  >A</em
		  >-<em
		  >X</em
		  >) ∪ <em
		  >I</em
		  ></span
		></li
	      ></ul
	    ></li
	  ></ul
	></div
      ></div
    ><div id="getting-resource-info"
    ><h3
      ><a href="#TOC"
	><span class="header-section-number"
	  >10.6.19</span
	  > Getting Resource Info</a
	></h3
      ><p
      >Get a specific resource within a project.</p
      ><p
      >URL:</p
      ><pre
      ><code
	>/resource/[name]
</code
	></pre
      ><p
      >Required Parameters:</p
      ><ul
      ><li
	><code
	  >project</code
	  > : project name</li
	></ul
      ><p
      >Optional Parameters:</p
      ><ul
      ><li
	><code
	  >format</code
	  > : Result format. One of &quot;xml&quot; or &quot;yaml&quot;. Default is &quot;xml&quot;.</li
	></ul
      ><p
      >Result: Depending on the <code
	>format</code
	> parameter, a value of &quot;xml&quot; will return <a href="resources-v10.html"
	>resources-v10(5)</a
	> and &quot;yaml&quot; will return <a href="resources-v10-yaml.html"
	>resources-v10-yaml(5)</a
	> formatted results.</p
      ><p
      >The result will contain a single item for the specified resource.</p
      ></div
    ></div
  ></div
><div class="footnotes"
><hr
   /><ol
  ><li id="fn1"
    ><p
      >The &quot;--noqueue&quot; flag is useful for testing and debugging execution but undermines visibility since execution is not managed through the central execution queue. <a href="#fnref1" class="footnoteBackLink" title="Jump back to footnote 1">↩</a></p
      ></li
    ><li id="fn2"
    ><p
      >To pass environment variables through remote command dispatches, it is required to properly configure the SSH server on the remote end. See the AcceptEnv directive in the &quot;sshd_config(5)&quot; manual page for instructions. Use a wild card pattern to permit RD_ prefixed variables to provide open access to RunDeck generated environment variables. <a href="#fnref2" class="footnoteBackLink" title="Jump back to footnote 2">↩</a></p
      ></li
    ></ol
  ></div
>
</div>
</body>
</html>
