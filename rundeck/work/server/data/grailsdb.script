CREATE SCHEMA PUBLIC AUTHORIZATION DBA
CREATE MEMORY TABLE BASE_REPORT(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,TAGS VARCHAR(255),CTX_NAME VARCHAR(255),STATUS VARCHAR(7) NOT NULL,DATE_STARTED TIMESTAMP NOT NULL,ACTION_TYPE VARCHAR(7) NOT NULL,REPORT_ID VARCHAR(255),CTX_TYPE VARCHAR(255),DATE_COMPLETED TIMESTAMP NOT NULL,MESSAGE VARCHAR(255) NOT NULL,AUTHOR VARCHAR(255) NOT NULL,CTX_PROJECT VARCHAR(255) NOT NULL,TITLE VARCHAR(255) NOT NULL,NODE VARCHAR(255),MAPREF_URI VARCHAR(255),CLASS VARCHAR(255) NOT NULL,ADHOC_SCRIPT VARCHAR(255),CTX_CONTROLLER VARCHAR(255),ADHOC_EXECUTION BOOLEAN,CTX_COMMAND VARCHAR(255),JC_EXEC_ID VARCHAR(255),JC_JOB_ID VARCHAR(255),ABORTED_BY_USER VARCHAR(255))
CREATE MEMORY TABLE COMMAND_EXEC(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,DO_NODEDISPATCH BOOLEAN NOT NULL,NODE_INCLUDE_OS_NAME VARCHAR(255),NODE_INCLUDE_OS_ARCH VARCHAR(255),LOGLEVEL VARCHAR(255) NOT NULL,RETURN_PROPERTY VARCHAR(255),NODE_EXCLUDE VARCHAR(255),UNLESS_STRING VARCHAR(255),NODE_EXCLUDE_OS_FAMILY VARCHAR(255),NODE_EXCLUDE_OS_VERSION VARCHAR(255),ADHOC_LOCAL_STRING VARCHAR(255),NODE_INCLUDE_NAME VARCHAR(255),EQUALS_STRING VARCHAR(255),ADHOC_EXECUTION BOOLEAN NOT NULL,NODE_EXCLUDE_TAGS VARCHAR(255),ARG_STRING VARCHAR(255),NODE_EXCLUDE_TYPE VARCHAR(255),NODE_INCLUDE_OS_FAMILY VARCHAR(255),ADHOC_REMOTE_STRING VARCHAR(255),NODE_INCLUDE_TAGS VARCHAR(255),ADHOC_FILEPATH VARCHAR(255),NODE_EXCLUDE_PRECEDENCE BOOLEAN,NODE_KEEPGOING BOOLEAN NOT NULL,NODE_EXCLUDE_NAME VARCHAR(255),WORKFLOW_ID BIGINT NOT NULL,PROJECT VARCHAR(255),NODE_EXCLUDE_OS_ARCH VARCHAR(255),NODE_INCLUDE_TYPE VARCHAR(255),NODE_INCLUDE_OS_VERSION VARCHAR(255),NODE_INCLUDE VARCHAR(255),IF_STRING VARCHAR(255),NODE_THREADCOUNT INTEGER NOT NULL,USER VARCHAR(255),NODE_EXCLUDE_OS_NAME VARCHAR(255),CLASS VARCHAR(255) NOT NULL,JOB_NAME VARCHAR(255),JOB_GROUP VARCHAR(255),COMMANDS_IDX INTEGER)
CREATE MEMORY TABLE EXECUTION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,DO_NODEDISPATCH BOOLEAN,NODE_INCLUDE_OS_NAME VARCHAR(255),NODE_INCLUDE_OS_ARCH VARCHAR(255),LOGLEVEL VARCHAR(255),SCHEDULED_EXECUTION_ID BIGINT,ABORTEDBY VARCHAR(255),DATE_STARTED TIMESTAMP,NODE_EXCLUDE VARCHAR(255),NODE_EXCLUDE_OS_FAMILY VARCHAR(255),NODE_EXCLUDE_OS_VERSION VARCHAR(255),ADHOC_LOCAL_STRING VARCHAR(255),NODE_INCLUDE_NAME VARCHAR(255),ADHOC_EXECUTION BOOLEAN,NODE_EXCLUDE_TAGS VARCHAR(255),ARG_STRING VARCHAR(255),NODE_EXCLUDE_TYPE VARCHAR(255),NODE_INCLUDE_OS_FAMILY VARCHAR(255),STATUS VARCHAR(255),ADHOC_REMOTE_STRING VARCHAR(255),NODE_INCLUDE_TAGS VARCHAR(255),ADHOC_FILEPATH VARCHAR(255),NODE_EXCLUDE_PRECEDENCE BOOLEAN,NODE_KEEPGOING BOOLEAN,CANCELLED BOOLEAN NOT NULL,NODE_EXCLUDE_NAME VARCHAR(255),FAILED_NODE_LIST VARCHAR(255),WORKFLOW_ID BIGINT,DATE_COMPLETED TIMESTAMP,PROJECT VARCHAR(255) NOT NULL,NODE_EXCLUDE_OS_ARCH VARCHAR(255),OUTPUTFILEPATH VARCHAR(255),NODE_INCLUDE_TYPE VARCHAR(255),NODE_INCLUDE_OS_VERSION VARCHAR(255),NODE_INCLUDE VARCHAR(255),NODE_THREADCOUNT INTEGER,USER VARCHAR(255) NOT NULL,NODE_EXCLUDE_OS_NAME VARCHAR(255))
CREATE MEMORY TABLE NODE_FILTER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,NODE_INCLUDE_OS_NAME VARCHAR(255),NODE_INCLUDE_OS_ARCH VARCHAR(255),NODE_EXCLUDE_TYPE VARCHAR(255),NODE_INCLUDE_OS_FAMILY VARCHAR(255),NODE_INCLUDE_TAGS VARCHAR(255),NODE_EXCLUDE_PRECEDENCE BOOLEAN,NODE_EXCLUDE VARCHAR(255),NODE_EXCLUDE_NAME VARCHAR(255),NODE_EXCLUDE_OS_FAMILY VARCHAR(255),NODE_EXCLUDE_OS_VERSION VARCHAR(255),PROJECT VARCHAR(255),NODE_INCLUDE_NAME VARCHAR(255),NODE_EXCLUDE_OS_ARCH VARCHAR(255),NODE_INCLUDE_TYPE VARCHAR(255),NODE_INCLUDE_OS_VERSION VARCHAR(255),NODE_INCLUDE VARCHAR(255),NAME VARCHAR(255) NOT NULL,NODE_EXCLUDE_TAGS VARCHAR(255),USER_ID BIGINT NOT NULL,NODE_EXCLUDE_OS_NAME VARCHAR(255))
CREATE MEMORY TABLE NOTIFICATION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,CONTENT VARCHAR(255),SCHEDULED_EXECUTION_ID BIGINT NOT NULL,EVENT_TRIGGER VARCHAR(255) NOT NULL,TYPE VARCHAR(255) NOT NULL)
CREATE MEMORY TABLE OPTION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,VALUES_URL VARBINARY(255),SCHEDULED_EXECUTION_ID BIGINT,REGEX VARCHAR(255),DELIMITER VARCHAR(255),DESCRIPTION VARCHAR(255),NAME VARCHAR(255) NOT NULL,ENFORCED BOOLEAN NOT NULL,DEFAULT_VALUE VARCHAR(255),REQUIRED BOOLEAN,MULTIVALUED BOOLEAN)
CREATE MEMORY TABLE OPTION_VALUES(OPTION_ID BIGINT,VALUES_STRING VARCHAR(255),CONSTRAINT FKCF0B942CFB2E8DBA FOREIGN KEY(OPTION_ID) REFERENCES OPTION(ID))
CREATE MEMORY TABLE REPORT_FILTER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,DOENDAFTER_FILTER BOOLEAN NOT NULL,TYPE_FILTER VARCHAR(255) NOT NULL,RECENT_FILTER VARCHAR(255) NOT NULL,TAGS_FILTER VARCHAR(255) NOT NULL,DOSTARTBEFORE_FILTER BOOLEAN NOT NULL,STARTAFTER_FILTER TIMESTAMP NOT NULL,NAME VARCHAR(255) NOT NULL,JOB_FILTER VARCHAR(255),REPORT_ID_FILTER VARCHAR(255) NOT NULL,OBJ_FILTER VARCHAR(255) NOT NULL,PROJ_FILTER VARCHAR(255) NOT NULL,USER_FILTER VARCHAR(255) NOT NULL,MESSAGE_FILTER VARCHAR(255) NOT NULL,MAPREF_URI_FILTER VARCHAR(255) NOT NULL,DOENDBEFORE_FILTER BOOLEAN NOT NULL,ENDAFTER_FILTER TIMESTAMP NOT NULL,TITLE_FILTER VARCHAR(255) NOT NULL,NODE_FILTER VARCHAR(255),STAT_FILTER VARCHAR(255) NOT NULL,JOB_ID_FILTER VARCHAR(255),CMD_FILTER VARCHAR(255) NOT NULL,ENDBEFORE_FILTER TIMESTAMP NOT NULL,DOSTARTAFTER_FILTER BOOLEAN NOT NULL,STARTBEFORE_FILTER TIMESTAMP NOT NULL,USER_ID BIGINT NOT NULL,CONSTRAINT SYS_CT_60 UNIQUE(NAME))
CREATE MEMORY TABLE SCHEDULED_EXECUTION(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,NODE_INCLUDE_OS_ARCH VARCHAR(255),LOGLEVEL VARCHAR(255),JOB_NAME VARCHAR(255) NOT NULL,NODE_EXCLUDE_OS_FAMILY VARCHAR(255),NODE_INCLUDE_NAME VARCHAR(255),DESCRIPTION VARCHAR(255) NOT NULL,YEAR VARCHAR(255),NODE_EXCLUDE_TAGS VARCHAR(255),NEXT_EXECUTION TIMESTAMP,ARG_STRING VARCHAR(255),ADHOC_FILEPATH VARCHAR(255),NODE_KEEPGOING BOOLEAN,LAST_UPDATED TIMESTAMP NOT NULL,WORKFLOW_ID BIGINT,PROJECT VARCHAR(255) NOT NULL,SCHEDULED BOOLEAN NOT NULL,NODE_INCLUDE VARCHAR(255),NODE_INCLUDE_TYPE VARCHAR(255),DAY_OF_MONTH VARCHAR(255) NOT NULL,MONTH VARCHAR(255) NOT NULL,USER_ROLE_LIST VARCHAR(255),TOTAL_TIME BIGINT,DO_NODEDISPATCH BOOLEAN,NODE_INCLUDE_OS_NAME VARCHAR(255),NODE_EXCLUDE VARCHAR(255),MINUTE VARCHAR(255) NOT NULL,NODE_EXCLUDE_OS_VERSION VARCHAR(255),ADHOC_LOCAL_STRING VARCHAR(255),ADHOC_EXECUTION BOOLEAN,EXEC_COUNT BIGINT,DAY_OF_WEEK VARCHAR(255) NOT NULL,NODE_EXCLUDE_TYPE VARCHAR(255),NODE_INCLUDE_OS_FAMILY VARCHAR(255),ADHOC_REMOTE_STRING VARCHAR(255),NODE_EXCLUDE_PRECEDENCE BOOLEAN,NODE_INCLUDE_TAGS VARCHAR(255),GROUP_PATH VARCHAR(255),NODE_EXCLUDE_NAME VARCHAR(255),HOUR VARCHAR(255) NOT NULL,NODE_EXCLUDE_OS_ARCH VARCHAR(255),SECONDS VARCHAR(255),NODE_INCLUDE_OS_VERSION VARCHAR(255),DATE_CREATED TIMESTAMP NOT NULL,NODE_THREADCOUNT INTEGER,USER VARCHAR(255),NODE_EXCLUDE_OS_NAME VARCHAR(255))
CREATE MEMORY TABLE SCHEDULED_EXECUTION_FILTER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,DESC_FILTER VARCHAR(255),LOGLEVEL_FILTER VARCHAR(255),NAME VARCHAR(255) NOT NULL,GROUP_PATH VARCHAR(255),JOB_FILTER VARCHAR(255),IDLIST VARCHAR(255),USER_ID BIGINT NOT NULL,PROJ_FILTER VARCHAR(255))
CREATE MEMORY TABLE USER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,LAST_NAME VARCHAR(255),LAST_UPDATED TIMESTAMP NOT NULL,PASSWORD VARCHAR(255),FILTER_PREF VARCHAR(255),EMAIL VARCHAR(255),DATE_CREATED TIMESTAMP NOT NULL,LOGIN VARCHAR(255) NOT NULL,DASHBOARD_PREF VARCHAR(255),FIRST_NAME VARCHAR(255))
CREATE MEMORY TABLE USER_AUTH(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,WORKFLOW_CREATE BOOLEAN NOT NULL,EVENTS_UPDATE BOOLEAN NOT NULL,WORKFLOW_KILL BOOLEAN NOT NULL,EVENTS_DELETE BOOLEAN NOT NULL,RESOURCES_UPDATE BOOLEAN NOT NULL,RESOURCES_DELETE BOOLEAN NOT NULL,WORKFLOW_UPDATE BOOLEAN NOT NULL,WORKFLOW_DELETE BOOLEAN NOT NULL,EVENTS_READ BOOLEAN NOT NULL,RESOURCES_CREATE BOOLEAN NOT NULL,WORKFLOW_RUN BOOLEAN NOT NULL,USER_ID BIGINT NOT NULL,EVENTS_CREATE BOOLEAN NOT NULL,RESOURCES_READ BOOLEAN NOT NULL,WORKFLOW_READ BOOLEAN NOT NULL,CONSTRAINT FK1434519CF7634DFA FOREIGN KEY(USER_ID) REFERENCES USER(ID))
CREATE MEMORY TABLE WORKFLOW(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,VERSION BIGINT NOT NULL,KEEPGOING BOOLEAN NOT NULL,STRATEGY VARCHAR(10) NOT NULL,THREADCOUNT INTEGER NOT NULL)
ALTER TABLE COMMAND_EXEC ADD CONSTRAINT FK749369056C0F497A FOREIGN KEY(WORKFLOW_ID) REFERENCES WORKFLOW(ID)
ALTER TABLE EXECUTION ADD CONSTRAINT FKBEF90B18243CF2FF FOREIGN KEY(SCHEDULED_EXECUTION_ID) REFERENCES SCHEDULED_EXECUTION(ID)
ALTER TABLE EXECUTION ADD CONSTRAINT FKBEF90B186C0F497A FOREIGN KEY(WORKFLOW_ID) REFERENCES WORKFLOW(ID)
ALTER TABLE NODE_FILTER ADD CONSTRAINT FK2227B455F7634DFA FOREIGN KEY(USER_ID) REFERENCES USER(ID)
ALTER TABLE NOTIFICATION ADD CONSTRAINT FK237A88EB243CF2FF FOREIGN KEY(SCHEDULED_EXECUTION_ID) REFERENCES SCHEDULED_EXECUTION(ID)
ALTER TABLE OPTION ADD CONSTRAINT FKC3CA8875243CF2FF FOREIGN KEY(SCHEDULED_EXECUTION_ID) REFERENCES SCHEDULED_EXECUTION(ID)
ALTER TABLE REPORT_FILTER ADD CONSTRAINT FKBD4FF0E3F7634DFA FOREIGN KEY(USER_ID) REFERENCES USER(ID)
ALTER TABLE SCHEDULED_EXECUTION ADD CONSTRAINT FKB78292066C0F497A FOREIGN KEY(WORKFLOW_ID) REFERENCES WORKFLOW(ID)
ALTER TABLE SCHEDULED_EXECUTION_FILTER ADD CONSTRAINT FK629503D1F7634DFA FOREIGN KEY(USER_ID) REFERENCES USER(ID)
ALTER TABLE BASE_REPORT ALTER COLUMN ID RESTART WITH 2
ALTER TABLE COMMAND_EXEC ALTER COLUMN ID RESTART WITH 2
ALTER TABLE EXECUTION ALTER COLUMN ID RESTART WITH 2
ALTER TABLE NODE_FILTER ALTER COLUMN ID RESTART WITH 1
ALTER TABLE NOTIFICATION ALTER COLUMN ID RESTART WITH 1
ALTER TABLE OPTION ALTER COLUMN ID RESTART WITH 1
ALTER TABLE REPORT_FILTER ALTER COLUMN ID RESTART WITH 1
ALTER TABLE SCHEDULED_EXECUTION ALTER COLUMN ID RESTART WITH 1
ALTER TABLE SCHEDULED_EXECUTION_FILTER ALTER COLUMN ID RESTART WITH 1
ALTER TABLE USER ALTER COLUMN ID RESTART WITH 2
ALTER TABLE USER_AUTH ALTER COLUMN ID RESTART WITH 1
ALTER TABLE WORKFLOW ALTER COLUMN ID RESTART WITH 2
CREATE USER SA PASSWORD ""
GRANT DBA TO SA
SET WRITE_DELAY 10
SET SCHEMA PUBLIC
INSERT INTO BASE_REPORT VALUES(1,0,NULL,NULL,'succeed','2011-06-28 11:25:42.733000000','succeed','adhoc',NULL,'2011-06-28 11:25:44.518000000','Job completed successfully','admin','test','ls','1/0/1',NULL,'ExecReport',NULL,NULL,NULL,NULL,'1',NULL,NULL)
INSERT INTO COMMAND_EXEC VALUES(1,0,FALSE,NULL,NULL,'WARN',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,TRUE,NULL,NULL,NULL,NULL,'ls',NULL,NULL,TRUE,FALSE,NULL,1,'test',NULL,NULL,NULL,NULL,NULL,1,NULL,NULL,'CommandExec',NULL,NULL,0)
INSERT INTO EXECUTION VALUES(1,2,TRUE,NULL,NULL,'INFO',NULL,NULL,'2011-06-28 11:25:42.733000000',NULL,NULL,NULL,NULL,'localhost',FALSE,NULL,NULL,NULL,NULL,'true',NULL,NULL,NULL,TRUE,TRUE,FALSE,NULL,NULL,1,'2011-06-28 11:25:44.479000000','test',NULL,'/tmp/rdeck/var/logs/rundeck/test/run/logs/1.txt',NULL,NULL,NULL,1,'admin',NULL)
INSERT INTO USER VALUES(1,1,NULL,'2011-06-28 11:25:34.945000000',NULL,'project=test',NULL,'2011-06-28 11:25:16.903000000','admin',NULL,NULL)
INSERT INTO WORKFLOW VALUES(1,0,FALSE,'node-first',1)
